<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Derivation, Calculation, and Use of National Animal Model Information</title>
    <link rel="stylesheet" href="style.css">

<script>
(function() {
    'use strict';

    function initTheme() {
        const filename = location.pathname.split('/').pop().replace('.html', '') || 'default';
        
        let seed = 0;
        
        // Mix all character codes into the seed with prime multipliers
        for (let i = 0; i < filename.length; i++) {
            seed += filename.charCodeAt(i) * (31 + (i % 7));
        }

        // Extract year if any (4-digit number in filename)
        const yearMatch = filename.match(/\d{4}/);
        if (yearMatch) {
            seed += parseInt(yearMatch[0]) * 13;
        }

        // Further mix with golden ratio to scatter more
        seed = Math.floor((seed * 0.6180339887) % 1 * 10000);

        const themeNumber = (seed % 30) + 1; // Result: 1 to 30

        document.body.setAttribute('data-theme', 'auto-' + themeNumber);
        if (yearMatch) {
            document.body.setAttribute('data-year', yearMatch[0]);
        }
    }

    function initBackToTop() {
        const btn = document.createElement('div');
        btn.className = 'back-to-top';
        btn.setAttribute('aria-label', 'Back to top');
        btn.onclick = () => window.scrollTo({top: 0, behavior: 'smooth'});
        document.body.appendChild(btn);
        
        window.onscroll = () => {
            btn.classList.toggle('visible', window.pageYOffset > 300);
        };
    }

    document.readyState === 'loading'
        ? document.addEventListener('DOMContentLoaded', () => {initTheme(); initBackToTop();})
        : (initTheme(), initBackToTop());
})();
</script>

</head>
<body>
    <div class="container">
        <!-- TOP LEFT NAVIGATION -->
        <div class="top-left-nav">
            <a href="../index.html">Back to Index</a>
        </div>
        
        <div class="header">
            <h1>Derivation, Calculation, and Use of National Animal Model Information</h1>
            <p>Foundational Framework for Modern Genetic Evaluation Systems</p>
            
            <div class="header-info">
                <p class="text-small"><strong>Authors:</strong> P. M. VanRaden and G. R. Wiggans</p>
                <p class="text-small text-top"><strong>Journal:</strong> Journal of Dairy Science, Vol. 74, pp. 2737-2746, 1991</p>
                <p class="text-small text-top"><strong>Institution:</strong> Animal Improvement Programs Laboratory, Agricultural Research Service, USDA</p>
                <p class="text-top-large">
                    <a href="https://www.journalofdairyscience.org/article/S0022-0302(91)78453-1/fulltext"
                       target="_blank" 
                       class="paper-link">
                         View Original Paper
                    </a>
                </p>
            </div>
        </div>
        
        <div class="content">
            <div class="section" id="section-overview">
                <div class="section-title">Introduction & Problem Statement</div>
                
                <div class="innovation-box">
                    <div class="innovation-title">üéØ Revolutionary Framework</div>
                    <p>First comprehensive framework for explaining and implementing animal model genetic evaluations for national dairy cattle breeding programs. Introduced standardized terminology and mathematical foundations that became the industry standard for genetic evaluation systems worldwide.</p>
                </div>
                
                <div class="problem-box">
                    <strong>Core Challenge:</strong> Animal model evaluations used complex mixed model equations that combined information from all known relationships, but lacked clear explanations of how individual components contributed to genetic predictions. Users needed intuitive understanding of PTA derivation, reliability calculation, and information sources without requiring matrix algebra expertise.
                </div>
                
                <div class="citation-box">
                    <p><strong>Citation:</strong> VanRaden, P. M., & Wiggans, G. R. (1991). Derivation, calculation, and use of national animal model information. Journal of Dairy Science, 74(8), 2737-2746.</p>
                    
                    <p><strong>Historical Context:</strong></p>
                    <ul class="list-top">
                        <li>Published when animal models were becoming standard for national genetic evaluations</li>
                        <li>Replaced previous Modified Contemporary Comparison (MCC) systems</li>
                        <li>Established terminology still used in modern genomic evaluations</li>
                        <li>Foundation for reliability calculations in current breeding programs</li>
                    </ul>
                </div>
            </div>

            <div class="section" id="section-model">
                <div class="section-title">Animal Model Foundation</div>
                
                <div class="formula-box">
                    <div class="formula-title">Core Mixed Model Structure</div>
                    <div class="formula-main">y = Mm + Za + ZA<sub>g</sub>g + Pp + Cc + e</div>
                    <div class="formula-note">Where y = standardized yields, a = additive genetic effects, g = unknown-parent groups, p = permanent environment, c = herd-sire interaction</div>
                </div>
                
                <div class="model-comparison">
                    <div class="model-box model-1">
                        <div class="model-title">Model Components</div>
                        <div class="step-details">
                            <strong>Effects Structure:</strong>
                            <ul>
                                <li><strong>m:</strong> Management group effects (fixed)</li>
                                <li><strong>a:</strong> Random additive genetic merit</li>
                                <li><strong>g:</strong> Unknown-parent group effects</li>
                                <li><strong>p:</strong> Permanent environmental effects</li>
                                <li><strong>c:</strong> Herd-sire interaction effects</li>
                                <li><strong>e:</strong> Residual error</li>
                            </ul>
                            
                            <strong>Variance Structure:</strong>
                            <ul>
                                <li>Var(a) = AœÉ¬≤<sub>a</sub> (relationship matrix)</li>
                                <li>Var(p) = IœÉ¬≤<sub>p</sub> (permanent environment)</li>
                                <li>Var(c) = IœÉ¬≤<sub>c</sub> (herd-sire interaction)</li>
                                <li>Var(e) = RœÉ¬≤<sub>e</sub> (weighted residuals)</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="model-box model-2">
                        <div class="model-title">Mixed Model Equations</div>
                        <div class="step-details">
                            <strong>System Structure:</strong>
                            <div class="formula">[Z'R‚Åª¬πZ + A‚Åª¬πk<sub>a</sub>]√ª = A'<sub>g</sub>A‚Åª¬πk<sub>a</sub>ƒù + Z'R‚Åª¬π(y - MmÃÇ - PpÃÇ - Cƒâ)</div>
                            
                            <strong>Variance Ratios:</strong>
                            <ul>
                                <li>k<sub>a</sub> = œÉ¬≤<sub>e</sub>/œÉ¬≤<sub>a</sub> = 1.8</li>
                                <li>k<sub>p</sub> = œÉ¬≤<sub>e</sub>/œÉ¬≤<sub>p</sub> = 2.8</li>
                                <li>k<sub>c</sub> = œÉ¬≤<sub>e</sub>/œÉ¬≤<sub>c</sub> = 3.2</li>
                            </ul>
                            
                            <strong>Solution Strategy:</strong>
                            <ul>
                                <li>Singular system solved iteratively</li>
                                <li>Genetic base imposed post-solution</li>
                                <li>PTA = √ª/2 (transmitting ability)</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section" id="section-pta">
                <div class="section-title">Predicted Transmitting Ability (PTA) Decomposition</div>
                
                <div class="flow-container">
                    <div class="flow-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <div class="step-title">PTA Framework</div>
                            <div class="step-details">
                                Core decomposition into three information sources
                                <div class="step-specs">
                                    <strong>PTA Formula:</strong> PTA<sub>anim</sub> = w‚ÇÅPA + w‚ÇÇ(YD/2) + w‚ÇÉPC<br>
                                    <strong>Weight Constraint:</strong> w‚ÇÅ + w‚ÇÇ + w‚ÇÉ = 1<br>
                                    <strong>Information Sources:</strong> Parents, own performance, progeny<br>
                                    <strong>Derivation:</strong> From mixed model equations by transferring off-diagonals
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <div class="step-title">Parent Average (PA)</div>
                            <div class="step-details">
                                Expected genetic merit from pedigree information
                                <div class="step-specs">
                                    <strong>Definition:</strong> PA = (PTA<sub>sire</sub> + PTA<sub>dam</sub>)/2<br>
                                    <strong>Weight Numerator:</strong> 2k<sub>a</sub>q<sub>par</sub><br>
                                    <strong>q<sub>par</sub> Values:</strong> 1 (both known), 2/3 (one known), 1/2 (neither)<br>
                                    <strong>Unknown Parents:</strong> Genetic group solutions substituted
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <div class="step-title">Yield Deviation (YD)</div>
                            <div class="step-details">
                                Management-adjusted performance measure
                                <div class="step-specs">
                                    <strong>Definition:</strong> YD = weighted average of (y<sub>i</sub> - mÃÇ<sub>i</sub> - pÃÇ<sub>i</sub> - ƒâ<sub>i</sub>)<br>
                                    <strong>Weight Numerator:</strong> Œ£w<sub>len</sub> (lactation length weights)<br>
                                    <strong>Adjustments:</strong> Management group, permanent environment, herd-sire<br>
                                    <strong>Bulls:</strong> No YD but use DYD from daughters
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <div class="step-title">Progeny Contribution (PC)</div>
                            <div class="step-details">
                                Weighted progeny performance adjusted for mates
                                <div class="step-specs">
                                    <strong>Definition:</strong> PC = Œ£q<sub>prog</sub>(2PTA<sub>prog</sub> - PTA<sub>mate</sub>)/Œ£q<sub>prog</sub><br>
                                    <strong>Weight Numerator:</strong> 0.5k<sub>a</sub>Œ£q<sub>prog</sub><br>
                                    <strong>q<sub>prog</sub> Values:</strong> 1 (mate known), 2/3 (mate unknown)<br>
                                    <strong>Mate Adjustment:</strong> Isolates focal animal's genetic contribution
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="section-title">Alternative PTA Formulation</div>
                
                <div class="formula-box">
                    <div class="formula-title">PTA with Daughter Yield Deviation (DYD)</div>
                    <div class="formula-main">PTA<sub>anim</sub> = x‚ÇÅPA + x‚ÇÇ(YD/2) + x‚ÇÉDYD</div>
                    <div class="formula-note">Where DYD = Œ£q<sub>prog</sub>w‚ÇÇ<sub>prog</sub>(YD<sub>prog</sub> - PTA<sub>mate</sub>)/Œ£q<sub>prog</sub>w‚ÇÇ<sub>prog</sub></div>
                </div>
                
                <div class="model-comparison">
                    <div class="model-box model-1">
                        <div class="model-title">Weight Calculations</div>
                        <div class="step-details">
                            <strong>PTA Weights (w):</strong>
                            <div class="formula">Denominator = Œ£w<sub>len</sub> + 2k<sub>a</sub>q<sub>par</sub> + 0.5k<sub>a</sub>Œ£q<sub>prog</sub></div>
                            
                            <strong>DYD Weights (x):</strong>
                            <div class="formula">x‚ÇÉ numerator = 0.5k<sub>a</sub>Œ£q<sub>prog</sub>w‚ÇÇ<sub>prog</sub></div>
                            
                            <strong>Key Relationships:</strong>
                            <ul>
                                <li>x‚ÇÉ < w‚ÇÉ (DYD receives less weight than PC)</li>
                                <li>DYD is unregressed progeny performance</li>
                                <li>PC includes regression toward parent average</li>
                                <li>w‚ÇÇ<sub>prog</sub> calculated without granddaughter info for consistency</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="model-box model-2">
                        <div class="model-title">Management Group Deviation (MD)</div>
                        <div class="step-details">
                            <strong>Relationship to YD:</strong>
                            <div class="formula">MD = YD + PPA - 2PTA<sub>anim</sub></div>
                            
                            <strong>Where PPA is:</strong>
                            <div class="formula">PPA = √ª<sub>i</sub> + pÃÇ<sub>i</sub> + ƒâ<sub>i</sub> (Predicted Producing Ability)</div>
                            
                            <strong>Interpretation:</strong>
                            <ul>
                                <li>MD adjusts only for management group effects</li>
                                <li>YD additionally adjusts for permanent environment and herd-sire</li>
                                <li>MD more similar to previous MCC system deviations</li>
                                <li>Both YD and MD equal 2√óPTA for isolated animals</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section" id="section-reliability">
                <div class="section-title">Reliability & Daughter Equivalents</div>
                
                <div class="analysis-grid">
                    <div class="analysis-card why-card">
                        <div class="analysis-title">Reliability Definition</div>
                        <div class="step-details">
                            <strong>Statistical Definition:</strong> REL = squared correlation between predicted and true transmitting abilities.
                            
                            <strong>Equivalent Definition:</strong> REL = Var(PTA)/Var(TA)
                            
                            <strong>Key Properties:</strong>
                            <ul>
                                <li>Ranges from 0 to 1 (0% to 100%)</li>
                                <li>Independent of selection effects</li>
                                <li>Computed from unselected population parameters</li>
                                <li>Measures accuracy, not bias</li>
                                <li>Enables breeding program optimization</li>
                            </ul>
                            
                            <strong>Practical Formula:</strong>
                            <div class="formula">REL = DE/(DE + k<sub>a</sub>)</div>
                        </div>
                    </div>
                    
                    <div class="analysis-card how-card">
                        <div class="analysis-title">Daughter Equivalents (DE)</div>
                        <div class="step-details">
                            <strong>Concept:</strong> Amount of information contributed by a "standard daughter" to parent evaluation.
                            
                            <strong>Standard Daughter Definition:</strong>
                            <ul>
                                <li>One lactation record</li>
                                <li>Infinite number of management group mates</li>
                                <li>Other parent with perfect reliability (100%)</li>
                                <li>Provides intuitive information unit</li>
                            </ul>
                            
                            <strong>Total DE Calculation:</strong>
                            <div class="formula">DE<sub>anim</sub> = DE<sub>PA</sub> + DE<sub>yield</sub> + Œ£DE<sub>prog-mate</sub></div>
                            
                            <strong>Inverse Relationship:</strong>
                            <div class="formula">DE = k<sub>a</sub> √ó REL/(1 - REL)</div>
                        </div>
                    </div>
                    
                    <div class="analysis-card what-card">
                        <div class="analysis-title">Information Sources</div>
                        <div class="step-details">
                            <strong>DE from Parents (DE<sub>PA</sub>):</strong>
                            <div class="formula">DE<sub>PA</sub> = k<sub>a</sub>(REL*<sub>PA</sub>)/(1 - REL*<sub>PA</sub>)</div>
                            
                            <strong>DE from Own Records (DE<sub>yield</sub>):</strong>
                            <div class="formula">DE<sub>yield</sub> = k<sub>a</sub>(REL<sub>yield</sub>)/(1 - REL<sub>yield</sub>)</div>
                            
                            <strong>DE from Each Progeny (DE<sub>prog-mate</sub>):</strong>
                            <div class="formula">DE<sub>prog-mate</sub> = k<sub>a</sub>(REL*<sub>anim</sub>)/(1 - REL*<sub>anim</sub>)</div>
                            
                            <strong>Critical Adjustments:</strong>
                            <ul>
                                <li>REL* excludes focal animal's contribution (prevents double-counting)</li>
                                <li>Mate REL adjustment isolates focal animal information</li>
                                <li>Herd-sire interaction reduces daughter information</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="section-title">Reliability Component Details</div>
                
                <div class="results-grid">
                    <div class="results-box">
                        <div class="results-title">Parent Information (DE<sub>PA</sub>)</div>
                        <div class="step-details">
                            <strong>Calculation Steps:</strong>
                            <ol>
                                <li>Calculate animal's contribution to each parent</li>
                                <li>Subtract from parent's total DE to get REL*</li>
                                <li>Combine parent REL: REL*<sub>PA</sub> = (REL*<sub>sire</sub> + REL*<sub>dam</sub>)/4</li>
                                <li>Convert to DE<sub>PA</sub> using standard formula</li>
                            </ol>
                            
                            <strong>Example Values:</strong>
                            <ul>
                                <li>Sire 70% REL, Dam 30% REL: 4.7 DE</li>
                                <li>Sire 99% REL, Dam 50% REL: 8.3 DE</li>
                                <li>Sire 99% REL, Dam 99% REL: 14.0 DE</li>
                            </ul>
                            
                            <strong>Unknown Parents:</strong>
                            <ul>
                                <li>Genetic group solutions replace unknown PTA</li>
                                <li>Reduced q<sub>par</sub> values account for uncertainty</li>
                                <li>Lower DE compared to known high-REL parents</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="results-box">
                        <div class="results-title">Own Performance (DE<sub>yield</sub>)</div>
                        <div class="step-details">
                            <strong>Basic Formula (Infinite Mates):</strong>
                            <div class="formula">REL<sub>yield</sub> = n<sub>rec</sub>h¬≤/[1 + (n<sub>rec</sub> - 1)r<sub>yield</sub>]</div>
                            
                            <strong>Practical Adjustments:</strong>
                            <ul>
                                <li>Lactation length weights (w<sub>len</sub>)</li>
                                <li>Number of management group mates</li>
                                <li>Average REL of management group sires</li>
                                <li>Herd-sire interaction effects</li>
                            </ul>
                            
                            <strong>Example Values:</strong>
                            <ul>
                                <li>1 lactation record: 4.7 DE</li>
                                <li>3 lactation records: 7.8 DE</li>
                                <li>5 lactation records: 9.0 DE</li>
                            </ul>
                            
                            <strong>Diminishing Returns:</strong>
                            <ul>
                                <li>Permanent environmental effects limit gains</li>
                                <li>Additional records provide smaller increments</li>
                                <li>Management group structure affects information content</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section" id="section-progeny">
                <div class="section-title">Progeny Information & Herd-Sire Interaction</div>
                
                <div class="comparison-grid">
                    <div class="comparison-box census-box">
                        <div class="comparison-title">Progeny Contribution Calculation</div>
                        <div class="step-details">
                            <strong>Individual Progeny DE:</strong>
                            <div class="formula">REL*<sub>anim</sub> = REL*<sub>prog</sub>/(4 - REL*<sub>prog</sub>REL*<sub>mate</sub>)</div>
                            
                            <strong>Where:</strong>
                            <ul>
                                <li>REL*<sub>prog</sub> = progeny REL excluding parent information</li>
                                <li>REL*<sub>mate</sub> = mate REL excluding this progeny's contribution</li>
                                <li>Factor of 4 represents genetic relationship</li>
                                <li>Mate adjustment isolates focal parent's information</li>
                            </ul>
                            
                            <strong>Alternative Formula:</strong>
                            <div class="formula">REL*<sub>anim</sub> = 1/[(4/REL*<sub>prog</sub>) - REL*<sub>mate</sub>]</div>
                            
                            <strong>Simplified for Standard Progeny:</strong>
                            <div class="formula">DE<sub>prog-mate</sub> = 1/[(4/REL<sub>prog</sub>) - REL<sub>mate</sub>]</div>
                        </div>
                    </div>
                    
                    <div class="comparison-box dna-box">
                        <div class="comparison-title">Herd-Sire Interaction Effects</div>
                        <div class="step-details">
                            <strong>Information Limitation:</strong> Daughters in same herd provide less information due to herd-sire interaction effects.
                            
                            <strong>Simplified Formula:</strong>
                            <div class="formula">DE<sub>prog-mate</sub> = 1/(0.16 + 0.84/d)</div>
                            
                            <strong>Where d equals:</strong>
                            <div class="formula">d = Œ£(œÉ¬≤<sub>a</sub> + 0.5œÉ¬≤<sub>p</sub> + œÉ¬≤<sub>e</sub>)/[œÉ¬≤<sub>a</sub> + (0.75 - 0.25REL*<sub>mate</sub>)œÉ¬≤<sub>a</sub> + œÉ¬≤<sub>e</sub>/Œ£w<sub>len</sub>]</div>
                            
                            <strong>Practical Implications:</strong>
                            <ul>
                                <li>Maximum ~6 DE per herd regardless of daughter number</li>
                                <li>Diminishing returns with many daughters per herd</li>
                                <li>Spreading daughters across herds maximizes information</li>
                                <li>Sons not limited by herd-sire interaction</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="section-title">Daughter Information Examples</div>
                
                <div class="table-container">
                    <table class="example-table">
                        <thead>
                            <tr>
                                <th>Daughters in Herd</th>
                                <th>Total DE Contributed</th>
                                <th>DE per Daughter</th>
                                <th>Efficiency</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="published-group">
                                <td>1</td>
                                <td>1.0</td>
                                <td>1.00</td>
                                <td>100%</td>
                            </tr>
                            <tr class="alternative-group">
                                <td>2</td>
                                <td>1.7</td>
                                <td>0.86</td>
                                <td>86%</td>
                            </tr>
                            <tr class="new-group">
                                <td>5</td>
                                <td>3.0</td>
                                <td>0.61</td>
                                <td>61%</td>
                            </tr>
                            <tr class="low-pev-group">
                                <td>10</td>
                                <td>4.1</td>
                                <td>0.41</td>
                                <td>41%</td>
                            </tr>
                            <tr class="high-pev-group">
                                <td>50</td>
                                <td>5.2</td>
                                <td>0.21</td>
                                <td>21%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="coverage-stats">
                    <div class="stat-box">
                        <div class="stat-number">6</div>
                        <div class="stat-label">Maximum DE per Herd</div>
                    </div>
                    
                    <div class="stat-box">
                        <div class="stat-number">0.16</div>
                        <div class="stat-label">Minimum Inverse DE</div>
                    </div>
                    
                    <div class="stat-box">
                        <div class="stat-number">84%</div>
                        <div class="stat-label">Herd-Sire Interaction Factor</div>
                    </div>
                    
                    <div class="stat-box">
                        <div class="stat-number">100%</div>
                        <div class="stat-label">Efficiency for 1 Daughter</div>
                    </div>
                </div>
            </div>

            <div class="section" id="section-computation">
                <div class="section-title">Computational Implementation</div>
                
                <div class="flow-container">
                    <div class="flow-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <div class="step-title">Processing Sequence</div>
                            <div class="step-details">
                                Strategic order to avoid iteration and ensure information availability
                                <div class="step-specs">
                                    <strong>Step 1:</strong> Collect DE<sub>yield</sub> for all cows (herd order)<br>
                                    <strong>Step 2:</strong> Calculate daughter‚Üísire contributions (herd-sire interaction)<br>
                                    <strong>Step 3:</strong> Process animals youngest‚Üíoldest (other progeny pathways)<br>
                                    <strong>Step 4:</strong> Calculate REL starting with oldest animals
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <div class="step-title">Information Accounting</div>
                            <div class="step-details">
                                Systematic approach to prevent double-counting
                                <div class="step-specs">
                                    <strong>Parent Contributions:</strong> Subtract animal's DE before calculating parent REL*<br>
                                    <strong>Mate Adjustments:</strong> Exclude shared progeny information from mate REL<br>
                                    <strong>Age Processing:</strong> Ensures all progeny counted before parent calculations<br>
                                    <strong>Iteration Avoidance:</strong> Single-pass algorithm using previous evaluation REL
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <div class="step-title">Matrix Considerations</div>
                            <div class="step-details">
                                Handling large-scale computational challenges
                                <div class="step-specs">
                                    <strong>Memory Management:</strong> Information matrix (X'X) too large for RAM<br>
                                    <strong>Iteration on Data:</strong> Solve equations without storing full coefficient matrix<br>
                                    <strong>Convergence:</strong> Monitor solution stability across iterations<br>
                                    <strong>Genetic Base:</strong> Impose constraints post-solution to avoid slow convergence
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <div class="step-title">Scale & Performance</div>
                            <div class="step-details">
                                National implementation scope and computational requirements
                                <div class="step-specs">
                                    <strong>Animals Processed:</strong> ~14 million cows, ~100,000 bulls<br>
                                    <strong>Evaluation Frequency:</strong> Semiannual updates (July 1989 onward)<br>
                                    <strong>Industry Acceptance:</strong> Well-received terminology and explanations<br>
                                    <strong>User Feedback:</strong> Some preference for MD over YD reporting
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section" id="section-examples">
                <div class="section-title">Worked Example: Complete Evaluation</div>
                
                <div class="analysis-grid">
                    <div class="analysis-card theory-card">
                        <div class="analysis-title">Example Cow Setup</div>
                        <div class="step-details">
                            <strong>Given Information:</strong>
                            <ul>
                                <li><strong>Own Performance:</strong> YD = +1000 kg (based on 3 records)</li>
                                <li><strong>Parents:</strong> PA = -500 kg</li>
                                <li><strong>Daughter 1:</strong> YD = -300 kg, sire PTA = -200 kg</li>
                                <li><strong>Daughter 2:</strong> YD = +400 kg, unknown sire (group = +100 kg)</li>
                            </ul>
                            
                            <strong>Reliability Assumptions:</strong>
                            <ul>
                                <li>Dam has 50% REL after removing cow's contribution</li>
                                <li>Sire and daughter 1's sire both have 99% REL</li>
                                <li>w‚ÇÇ values: 0.2174 (daughter 1), 0.2941 (daughter 2)</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="analysis-card detection-card">
                        <div class="analysis-title">Step-by-Step Calculations</div>
                        <div class="step-details">
                            <strong>1. DYD Calculation:</strong>
                            <div class="formula">DYD = [0.2174(-300 + 2√ó0) + 0.2941(2/3)(400 - 1√ó0)] / [0.2174 + 0.2941(2/3)]</div>
                            <div class="formula">DYD = [-65.22 + 78.43] / [0.4135] = 90 kg</div>
                            
                            <strong>2. PTA from x weights:</strong>
                            <div class="formula">PTA = 0.516(-500) + 0.431(1000/2) + 0.053(90) = -38 kg</div>
                            
                            <strong>3. Progeny Contribution (PC):</strong>
                            <ul>
                                <li>Daughter 1 PTA = -126 kg, Daughter 2 PTA = 81 kg</li>
                                <li>PC = {[2(-126) + 200] + (2/3)[2(81) - 0]} / [1 + (2/3)] = -6 kg</li>
                            </ul>
                            
                            <strong>4. PTA from w weights:</strong>
                            <div class="formula">PTA = 0.445(-500) + 0.370(1000/2) + 0.185(-6) = -38 kg ‚úì</div>
                        </div>
                    </div>
                    
                    <div class="analysis-card evolution-card">
                        <div class="analysis-title">Reliability Calculation</div>
                        <div class="step-details">
                            <strong>Daughter Equivalents:</strong>
                            <ul>
                                <li>DE<sub>PA</sub> = 8.3 (from parent REL)</li>
                                <li>DE<sub>yield</sub> = 7.8 (from 3 lactations)</li>
                                <li>DE<sub>prog-mate</sub> = 1.93 (from 2 daughters)</li>
                                <li><strong>Total DE = 18.03</strong></li>
                            </ul>
                            
                            <strong>Final Reliability:</strong>
                            <div class="formula">REL = 18.03/(18.03 + 14) = 0.56 (56%)</div>
                            
                            <strong>Information Distribution:</strong>
                            <ul>
                                <li>Parents: 40% of total information (8.3/18.03)</li>
                                <li>Own records: 43% of total information (7.8/18.03)</li>
                                <li>Progeny: 11% of total information (1.93/18.03)</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="section-title">Weight and Information Summary</div>
                
                <div class="table-container">
                    <table class="formulation-table">
                        <thead>
                            <tr>
                                <th>Information Source</th>
                                <th>w weights</th>
                                <th>x weights</th>
                                <th>DE Fraction</th>
                                <th>Contribution</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="published-group">
                                <td><strong>Parents (PA)</strong></td>
                                <td>0.445</td>
                                <td>0.516</td>
                                <td>0.400</td>
                                <td>-222.5 kg</td>
                            </tr>
                            <tr class="alternative-group">
                                <td><strong>Own Performance (YD/2)</strong></td>
                                <td>0.370</td>
                                <td>0.431</td>
                                <td>0.433</td>
                                <td>+185.0 kg</td>
                            </tr>
                            <tr class="new-group">
                                <td><strong>Progeny (PC or DYD)</strong></td>
                                <td>0.185 (PC)</td>
                                <td>0.053 (DYD)</td>
                                <td>0.107</td>
                                <td>-1.1 or +4.8 kg</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="section" id="section-impact">
                <div class="section-title">Industry Impact & Legacy</div>
                
                <div class="innovation-box">
                    <div class="innovation-title">üèÜ Transformative Industry Impact</div>
                    <p>This framework became the standard for explaining genetic evaluations worldwide. The terminology and concepts introduced‚ÄîPTA, REL, daughter equivalents, yield deviations‚Äîremain central to modern breeding programs and have been adapted for genomic evaluations across all livestock species.</p>
                </div>
                
                <div class="theme-container">
                    <div class="theme-box methodological">
                        <div class="theme-title">Key Innovations</div>
                        <div class="step-details">
                            <ul>
                                <li><strong>Intuitive Decomposition:</strong> Complex matrix algebra translated to understandable components</li>
                                <li><strong>Daughter Equivalents:</strong> Universal information measure enabling cross-sex comparisons</li>
                                <li><strong>Reliability Standardization:</strong> Consistent accuracy reporting independent of selection</li>
                                <li><strong>Information Accounting:</strong> Systematic prevention of double-counting genetic information</li>
                                <li><strong>Computational Efficiency:</strong> Practical algorithms for national-scale implementations</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="theme-box genetic">
                        <div class="theme-title">Industry Applications</div>
                        <div class="step-details">
                            <ul>
                                <li><strong>National Programs:</strong> USDA-DHIA implementation for millions of animals</li>
                                <li><strong>International Adoption:</strong> Framework adapted globally by breeding organizations</li>
                                <li><strong>Commercial Breeding:</strong> Companies adopted terminology for genetic product marketing</li>
                                <li><strong>Research Foundation:</strong> Enabled evaluation accuracy studies and program optimization</li>
                                <li><strong>User Education:</strong> Provided breeders intuitive understanding of genetic evaluations</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="section-title">Modern Relevance & Extensions</div>
                
                <div class="analysis-grid">
                    <div class="analysis-card theory-card">
                        <div class="analysis-title">Genomic Era Applications</div>
                        <div class="step-details">
                            <strong>Conceptual Extensions:</strong>
                            <ul>
                                <li>Reliability concepts adapted for genomic predictions</li>
                                <li>Daughter equivalent principles applied to genomic accuracy</li>
                                <li>PTA decomposition maintained in single-step evaluations</li>
                                <li>Information accounting critical for genomic-conventional blending</li>
                            </ul>
                            
                            <strong>Technical Challenges:</strong>
                            <ul>
                                <li>Genomic preselection effects on reliability calculation</li>
                                <li>Cross-population genomic evaluation accuracy assessment</li>
                                <li>Functional genomics information integration</li>
                                <li>Multi-trait genomic evaluation reliability</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="analysis-card detection-card">
                        <div class="analysis-title">Computational Evolution</div>
                        <div class="step-details">
                            <strong>Scale Increases:</strong>
                            <ul>
                                <li>Millions of genotyped animals in national evaluations</li>
                                <li>Real-time evaluation updates with incremental algorithms</li>
                                <li>Cloud-based systems requiring distributed reliability calculations</li>
                                <li>International evaluations harmonizing accuracy measures</li>
                            </ul>
                            
                            <strong>Methodological Advances:</strong>
                            <ul>
                                <li>Machine learning integration with traditional frameworks</li>
                                <li>Multi-environment evaluations with environment-specific reliabilities</li>
                                <li>Uncertainty quantification using DE-based approaches</li>
                                <li>Novel trait evaluation reliability for health and efficiency traits</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="analysis-card evolution-card">
                        <div class="analysis-title">Cross-Species Applications</div>
                        <div class="step-details">
                            <strong>Livestock Extensions:</strong>
                            <ul>
                                <li>Beef cattle, swine, poultry genomic evaluations</li>
                                <li>Aquaculture breeding programs using reliability concepts</li>
                                <li>Small ruminant and companion animal applications</li>
                                <li>Conservation genetics with adapted frameworks</li>
                            </ul>
                            
                            <strong>Plant Breeding Adaptations:</strong>
                            <ul>
                                <li>Crop genomic selection using daughter equivalent principles</li>
                                <li>Forest tree breeding with extended generation intervals</li>
                                <li>Horticultural applications with clonal propagation</li>
                                <li>Breeding program optimization using reliability-cost models</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section" id="section-equations">
                <div class="section-title">Complete Mathematical Framework</div>
                
                <div class="matrix-container">
                    <div class="matrix-definition">
                        <strong>Complete Mixed Model Equations:</strong>
                    </div>
                    <div class="matrix-equation">
                        <div class="matrix-flexible">
                            <div class="matrix-row">
                                <div class="matrix-cell">M'R‚Åª¬πM</div>
                                <div class="matrix-cell">Z'R‚Åª¬πM</div>
                                <div class="matrix-cell">0</div>
                                <div class="matrix-cell">P'R‚Åª¬πM</div>
                                <div class="matrix-cell">C'R‚Åª¬πM</div>
                            </div>
                            <div class="matrix-row">
                                <div class="matrix-cell">symmetric</div>
                                <div class="matrix-cell">Z'R‚Åª¬πZ + A‚Åª¬πk<sub>a</sub></div>
                                <div class="matrix-cell">-A'<sub>g</sub>A‚Åª¬πk<sub>a</sub></div>
                                <div class="matrix-cell">P'R‚Åª¬πZ</div>
                                <div class="matrix-cell">C'R‚Åª¬πZ</div>
                            </div>
                            <div class="matrix-row">
                                <div class="matrix-cell"></div>
                                <div class="matrix-cell">symmetric</div>
                                <div class="matrix-cell">A'<sub>g</sub>A‚Åª¬πA<sub>g</sub>k<sub>a</sub></div>
                                <div class="matrix-cell">0</div>
                                <div class="matrix-cell">0</div>
                            </div>
                            <div class="matrix-row">
                                <div class="matrix-cell"></div>
                                <div class="matrix-cell"></div>
                                <div class="matrix-cell">symmetric</div>
                                <div class="matrix-cell">P'R‚Åª¬πP + Ik<sub>p</sub></div>
                                <div class="matrix-cell">C'R‚Åª¬πP</div>
                            </div>
                            <div class="matrix-row">
                                <div class="matrix-cell"></div>
                                <div class="matrix-cell"></div>
                                <div class="matrix-cell"></div>
                                <div class="matrix-cell">symmetric</div>
                                <div class="matrix-cell">C'R‚Åª¬πC + Ik<sub>c</sub></div>
                            </div>
                        </div>
                        <span class="equals">=</span>
                        <div class="vector-flexible">
                            <div class="vector-row">
                                <div class="vector-cell">M'R‚Åª¬πy</div>
                            </div>
                            <div class="vector-row">
                                <div class="vector-cell">Z'R‚Åª¬πy</div>
                            </div>
                            <div class="vector-row">
                                <div class="vector-cell">0</div>
                            </div>
                            <div class="vector-row">
                                <div class="vector-cell">P'R‚Åª¬πy</div>
                            </div>
                            <div class="vector-row">
                                <div class="vector-cell">C'R‚Åª¬πy</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="equation-grid">
                    <div class="formula-box">
                        <div class="formula-title">Variance Parameters (USDA Values)</div>
                        <div class="formula-main">k<sub>a</sub> = 1.8, k<sub>p</sub> = 2.8, k<sub>c</sub> = 3.2</div>
                        <div class="formula-note">Ratios of error variance to effect variances</div>
                    </div>
                    
                    <div class="formula-box">
                        <div class="formula-title">Reliability Formula</div>
                        <div class="formula-main">REL = DE/(DE + k<sub>a</sub>) where k<sub>a</sub> = 14</div>
                        <div class="formula-note">Standard formula used across all USDA evaluations</div>
                    </div>
                </div>
                
                <div class="model-comparison">
                    <div class="model-box">
                        <div class="model-title">PTA Weight Derivation</div>
                        <div class="step-details">
                            <strong>From Mixed Model Equations:</strong>
                            <div class="formula">[diag(Z'R‚Åª¬πZ + A‚Åª¬πk<sub>a</sub>)]PTA<sub>anim</sub> = k<sub>a</sub>q<sub>par</sub>(PTA<sub>sire</sub> + PTA<sub>dam</sub>)/2 + [diag(Z'R‚Åª¬πZ)]YD/2 + 0.5k<sub>a</sub>Œ£q<sub>prog</sub>(2PTA<sub>prog</sub> - PTA<sub>mate</sub>)</div>
                            
                            <strong>Weight Denominators:</strong>
                            <div class="formula">Denominator = Œ£w<sub>len</sub> + 2k<sub>a</sub>q<sub>par</sub> + 0.5k<sub>a</sub>Œ£q<sub>prog</sub></div>
                            
                            <strong>Individual Weights:</strong>
                            <ul>
                                <li>w‚ÇÅ = 2k<sub>a</sub>q<sub>par</sub> / Denominator</li>
                                <li>w‚ÇÇ = Œ£w<sub>len</sub> / Denominator</li>
                                <li>w‚ÇÉ = 0.5k<sub>a</sub>Œ£q<sub>prog</sub> / Denominator</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="model-box">
                        <div class="model-title">DE Conversion Formulas</div>
                        <div class="step-details">
                            <strong>REL to DE:</strong>
                            <div class="formula">DE = k<sub>a</sub> √ó REL/(1 - REL)</div>
                            
                            <strong>DE to REL:</strong>
                            <div class="formula">REL = DE/(DE + k<sub>a</sub>)</div>
                            
                            <strong>Information Components:</strong>
                            <div class="formula">DE<sub>total</sub> = DE<sub>PA</sub> + DE<sub>yield</sub> + Œ£DE<sub>prog-mate</sub></div>
                            
                            <strong>Herd-Sire Correction:</strong>
                            <div class="formula">DE<sub>daughters/herd</sub> = 1/(0.16 + 0.84/d<sub>effective</sub>)</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section" id="section-conclusion">
                <div class="section-title">Conclusions & Scientific Significance</div>
                
                <div class="legacy-box">
                    <strong>Foundational Contribution:</strong> VanRaden and Wiggans (1991) provided the mathematical and conceptual bridge between complex mixed model genetic evaluation theory and practical breeding applications. Their systematic decomposition of animal model solutions into intuitive components‚Äîparent information, own performance, and progeny contributions‚Äîenabled widespread industry adoption of sophisticated statistical methods. The daughter equivalent concept revolutionized how evaluation accuracy is measured and communicated, while the reliability framework established standards still used globally.
                </div>
                
                <div class="innovation-box">
                    <div class="innovation-title">üåü Enduring Scientific Legacy</div>
                    <p><strong>33+ years of influence:</strong> This work established the mathematical and terminological foundation for genetic evaluation systems worldwide. The concepts introduced continue to underpin modern genomic selection, international genetic evaluations, and breeding program optimization. The framework's adaptability has enabled its successful extension to genomic evaluations, multi-trait models, and cross-species applications, demonstrating the fundamental importance of clear mathematical communication in applied genetics.</p>
                </div>
                
                <div class="best-practices">
                    <strong>Key Principles Established:</strong>
                    <ul>
                        <li><strong>Mathematical Clarity:</strong> Complex statistical methods require intuitive explanations for industry adoption</li>
                        <li><strong>Information Transparency:</strong> Users benefit from understanding evaluation component contributions</li>
                        <li><strong>Standardized Accuracy:</strong> Consistent reliability measures enable objective breeding program comparison</li>
                        <li><strong>Computational Efficiency:</strong> Practical algorithms must balance statistical rigor with implementation constraints</li>
                        <li><strong>Industry Communication:</strong> Successful technology transfer requires bridging academic theory and practical application</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
                