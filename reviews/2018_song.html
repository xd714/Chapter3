<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>De-regression Methods in Genomic Prediction</title>
    <link rel="stylesheet" href="style.css">

<script>
(function() {
    'use strict';
    
    function initAutoTheme() {
        try {
            const filename = window.location.pathname.split('/').pop().replace('.html', '') || 'default';
            const pageTitle = document.title || '';
            
            function generateHash(str) {
                let hash = 5381;
                for (let i = 0; i < str.length; i++) {
                    hash = ((hash << 5) + hash) + str.charCodeAt(i);
                    hash = hash & hash;
                }
                return Math.abs(hash);
            }
            
            const hashValue = generateHash(filename + pageTitle);
            const themeNumber = (hashValue % 20) + 1;
            
            document.body.setAttribute('data-theme', 'auto-' + themeNumber);
            document.body.setAttribute('data-file', filename);
            
            const year = filename.match(/\d{4}/)?.[0] || pageTitle.match(/\d{4}/)?.[0] || '';
            if (year) {
                document.body.setAttribute('data-year', year);
            }
            
            console.log('üé® Theme:', 'auto-' + themeNumber, '| File:', filename);
            
        } catch (error) {
            console.warn('Theme initialization failed:', error);
            document.body.setAttribute('data-theme', 'auto-1');
        }
    }
    
    function initBackToTop() {
        try {
            let backToTopButton = document.getElementById('backToTop') || 
                                 document.querySelector('.back-to-top');
            
            if (!backToTopButton) {
                backToTopButton = document.createElement('div');
                backToTopButton.className = 'back-to-top';
                backToTopButton.id = 'backToTop';
                backToTopButton.setAttribute('aria-label', 'Back to top');
                backToTopButton.setAttribute('role', 'button');
                backToTopButton.setAttribute('tabindex', '0');
                document.body.appendChild(backToTopButton);
            }
            
            function toggleVisibility() {
                if (window.pageYOffset > 300) {
                    backToTopButton.classList.add('visible');
                } else {
                    backToTopButton.classList.remove('visible');
                }
            }
            
            function scrollToTop() {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            }
            
            window.addEventListener('scroll', toggleVisibility, { passive: true });
            backToTopButton.addEventListener('click', scrollToTop);
            
            backToTopButton.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    scrollToTop();
                }
            });
            
            toggleVisibility();
            
        } catch (error) {
            console.warn('Back to top initialization failed:', error);
        }
    }
    
    function init() {
        initAutoTheme();
        initBackToTop();
    }
    
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
    } else {
        init();
    }
})();
</script>
</head>
<body>
    <div class="container">
        <!-- TOP LEFT NAVIGATION -->
        <div class="top-left-nav">
            <a href="../index.html">Back to Index</a>
        </div>
        
        <div class="header">
            <h1>Accuracy and Bias of Genomic Prediction with Different De-regression Methods</h1>
            <p>Comprehensive Analysis of DRP Methods in Genomic Selection</p>
            
            <div class="header-info">
                <p class="text-small"><strong>Authors:</strong> H. Song, L. Li, Q. Zhang, S. Zhang, X. Ding</p>
                <p class="text-small text-top"><strong>Institution:</strong> National Engineering Laboratory for Animal Breeding, China Agricultural University, Beijing</p>
                <p class="text-small text-top"><strong>Published:</strong> Animal (2018), 12:6, pp 1111‚Äì1117</p>
                <p class="text-top-large">
                    <a href="https://www.cambridge.org/core/journals/animal/article/accuracy-and-bias-of-genomic-prediction-with-different-deregression-methods/F8E8E8E8E8E8E8E8E8E8E8E8E8E8E8E8" 
                       target="_blank" 
                       class="paper-link">
                        Search for Original Paper
                    </a>
                </p>
            </div>
        </div>
        
        <div class="content">
            <div class="section" id="section-2">
                <div class="section-title">Paper Information & Context</div>
                
                <div class="citation-box">
                    <p><strong>Citation:</strong> Song, H., Li, L., Zhang, Q., Zhang, S., & Ding, X. (2018). Accuracy and bias of genomic prediction with different de-regression methods. Animal, 12(6), 1111-1117.</p>
                    
                    <p><strong>Key Context:</strong> This study addresses a critical methodological question in genomic selection: how different methods of calculating de-regressed proofs (DRP) affect prediction accuracy and bias in genomic breeding value estimation.</p>
                </div>
                
                <div class="section-title">Detailed Methodology Flow</div>
                
                <div class="flow-container">
                    <div class="flow-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <div class="step-title">Data Sources and Preparation</div>
                            <div class="step-details">
                                Two distinct datasets for comprehensive comparison
                                <div class="step-specs">
                                    <strong>Simulated Data:</strong> 16th QTL-MAS Workshop dataset<br>
                                    ‚Ä¢ 4,100 individuals with 10,000 SNPs on 5 chromosomes<br>
                                    ‚Ä¢ 3 traits with heritabilities 0.3, 0.25, 0.23<br>
                                    ‚Ä¢ True breeding values available for validation<br><br>
                                    <strong>Real Data:</strong> Chinese Holstein cattle<br>
                                    ‚Ä¢ 4 milk production traits (MY, FP, PP, SCS)<br>
                                    ‚Ä¢ BovineSNP50 chip (52,869 SNPs after QC)<br>
                                    ‚Ä¢ Reference: born before 2008, Validation: 2008+
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <div class="step-title">Traditional Breeding Value Estimation</div>
                            <div class="step-details">
                                Pedigree-based animal model as foundation
                                <div class="step-specs">
                                    <strong>Model:</strong> y = Xb + Za + e<br>
                                    ‚Ä¢ y = phenotype vector<br>
                                    ‚Ä¢ b = fixed effects (year, season)<br>
                                    ‚Ä¢ a = additive genetic effects ~ N(0, AœÉ¬≤‚Çê)<br>
                                    ‚Ä¢ A = pedigree relationship matrix<br>
                                    ‚Ä¢ e = residual error ~ N(0, IœÉ¬≤‚Çë)
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <div class="step-title">De-regression Method Comparison</div>
                            <div class="step-details">
                                Two competing approaches for calculating DRP
                                <div class="step-specs">
                                    <strong>DRP_J (Jairath Method):</strong><br>
                                    ‚Ä¢ Requires EBV, pedigree, and EDC information<br>
                                    ‚Ä¢ EDC = k √ó r¬≤/(1-r¬≤), where k = (4-2h¬≤)/h¬≤<br>
                                    ‚Ä¢ More computationally intensive<br><br>
                                    <strong>DRP_G (Garrick Method):</strong><br>
                                    ‚Ä¢ Simplified approach, no EDC required<br>
                                    ‚Ä¢ Only needs parental EBV information<br>
                                    ‚Ä¢ More practical for large populations
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <div class="step-title">Genomic BLUP Implementation</div>
                            <div class="step-details">
                                Predict genomic breeding values using different response variables
                                <div class="step-specs">
                                    <strong>Model:</strong> y = 1Œº + Zg + e<br>
                                    ‚Ä¢ g ~ N(0, GœÉ¬≤‚Çì) where G is genomic relationship matrix<br>
                                    ‚Ä¢ G = MM'/Œ£2p·µ¢(1-p·µ¢) following VanRaden (2008)<br>
                                    ‚Ä¢ Response variables: EBV, DRP_J, or DRP_G<br>
                                    ‚Ä¢ Weighted residual variance: D = diag(1/w·µ¢)<br>
                                    ‚Ä¢ Two weighting schemes compared
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">5</div>
                        <div class="step-content">
                            <div class="step-title">Variance Component Investigation</div>
                            <div class="step-details">
                                Impact of genetic variance unexplained by markers
                                <div class="step-specs">
                                    <strong>Parameter c:</strong> Proportion of genetic variance unexplained by markers<br>
                                    ‚Ä¢ Tested values: 0.01 to 0.9<br>
                                    ‚Ä¢ Weight formulation: w·µ¢ = (1-h¬≤)/[(c+(1-r¬≤)/r¬≤) √ó h¬≤]<br>
                                    ‚Ä¢ Compared with reliability-only weighting: w·µ¢ = r¬≤·µ¢/(1-r¬≤·µ¢)<br>
                                    ‚Ä¢ DMU software used for calculations
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">6</div>
                        <div class="step-content">
                            <div class="step-title">Missing Information Analysis</div>
                            <div class="step-details">
                                Effect of incomplete pedigree on DRP calculation
                                <div class="step-specs">
                                    <strong>Missing Dam Information:</strong> 5%, 10%, 15%, 20%, 25%<br>
                                    ‚Ä¢ Realistic scenario in livestock breeding<br>
                                    ‚Ä¢ Impact on DRP reliability and GEBV accuracy<br>
                                    ‚Ä¢ Separate analysis for each missing level<br>
                                    ‚Ä¢ 2,020 animals assigned missing patterns
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="section-title">Model Comparison Framework</div>
                
                <div class="model-comparison">
                    <div class="model-box model-1">
                        <div class="model-title">Jairath Method (DRP_J)</div>
                        <div class="step-details">
                            <strong>Advantages:</strong><br>
                            ‚Ä¢ Higher correlation with EBV (0.851-0.995)<br>
                            ‚Ä¢ Superior accuracy in real Holstein data<br>
                            ‚Ä¢ Better unbiasedness for milk traits<br><br>
                            
                            <strong>Disadvantages:</strong><br>
                            ‚Ä¢ Requires EDC calculation<br>
                            ‚Ä¢ More complex computation<br>
                            ‚Ä¢ Larger bias in simulated data<br><br>
                            
                            <strong>Performance:</strong><br>
                            ‚Ä¢ Reliability close to EBV (0.64 vs 0.65)<br>
                            ‚Ä¢ Larger variance after de-regression<br>
                            ‚Ä¢ Variable performance across traits
                        </div>
                    </div>
                    
                    <div class="model-box model-2">
                        <div class="model-title">Garrick Method (DRP_G)</div>
                        <div class="step-details">
                            <strong>Advantages:</strong><br>
                            ‚Ä¢ Simplified calculation (no EDC needed)<br>
                            ‚Ä¢ Better for trait 3 in simulated data<br>
                            ‚Ä¢ More practical for large populations<br><br>
                            
                            <strong>Disadvantages:</strong><br>
                            ‚Ä¢ Lower reliability (0.10-0.20 lower than DRP_J)<br>
                            ‚Ä¢ Largest variance among methods<br>
                            ‚Ä¢ Inferior performance on real data<br><br>
                            
                            <strong>Performance:</strong><br>
                            ‚Ä¢ Highest accuracy for trait 3 (simulated)<br>
                            ‚Ä¢ Regression coefficient close to 1.0<br>
                            ‚Ä¢ More variable results across scenarios
                        </div>
                    </div>
                </div>
                
                <div class="flow-step">
                    <div class="step-number">7</div>
                    <div class="step-content">
                        <div class="step-title">Evaluation Metrics</div>
                        <div class="step-details">
                            Comprehensive assessment of prediction quality
                            <div class="step-specs">
                                <strong>Accuracy:</strong><br>
                                ‚Ä¢ Simulated data: r(TBV, GEBV)<br>
                                ‚Ä¢ Real data: r(GEBV, DRP)/‚àöreliability<br><br>
                                <strong>Bias:</strong><br>
                                ‚Ä¢ Deviation of regression coefficient from 1.0<br>
                                ‚Ä¢ b(TBV, GEBV) for simulated data<br>
                                ‚Ä¢ b(DRP, GEBV) for real data<br><br>
                                <strong>Statistical Testing:</strong><br>
                                ‚Ä¢ Hotelling-Williams Test for accuracy differences
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="section" id="section-1">
                <div class="section-title">Why, How, What Analysis</div>
                
                <div class="analysis-grid">
                    <div class="analysis-card why-card">
                        <div class="analysis-title">WHY - Problem Statement</div>
                        <div class="step-details">
                            <strong>Critical Issue:</strong> Choice of de-regression method significantly impacts genomic prediction performance.
                            
                            <ul>
                                <li>EBV contains <span class="highlight">double counting</span> of pedigree information</li>
                                <li>DRP methods aim to remove parental contributions</li>
                                <li>Computational complexity varies between methods</li>
                                <li>Missing pedigree information affects DRP calculation</li>
                                <li>Unclear which method provides optimal balance of accuracy and practicality</li>
                            </ul>
                            
                            <strong>Research Gap:</strong> Limited systematic comparison of DRP methods across different data types and missing information scenarios.
                        </div>
                    </div>
                    
                    <div class="analysis-card how-card">
                        <div class="analysis-title">HOW - Methodology Innovation</div>
                        <div class="step-details">
                            <strong>Comprehensive Approach:</strong> Multi-dataset, multi-scenario comparison framework.
                            
                            <ul>
                                <li><strong>Dual Validation:</strong> Both simulated (known truth) and real data</li>
                                <li><strong>Weighting Analysis:</strong> Impact of genetic variance parameter c</li>
                                <li><strong>Missing Data Simulation:</strong> Realistic pedigree incompleteness</li>
                                <li><strong>Multiple Traits:</strong> Different heritabilities and genetic architectures</li>
                                <li><strong>Statistical Rigor:</strong> Formal tests for accuracy differences</li>
                            </ul>
                            
                            <strong>Key Innovation:</strong> Systematic investigation of reliability-based vs. variance-component weighting schemes.
                        </div>
                    </div>
                    
                    <div class="analysis-card what-card">
                        <div class="analysis-title">WHAT - Key Findings</div>
                        <div class="step-details">
                            <strong>Method Performance:</strong> Context-dependent superiority of different approaches.
                            
                            <ul>
                                <li><span class="highlight">DRP_J superior</span> for real Holstein data (0.11 higher accuracy)</li>
                                <li><span class="highlight">Mixed results</span> in simulated data across traits</li>
                                <li><span class="highlight">Reliability weighting</span> outperforms variance-component approach</li>
                                <li><span class="highlight">Missing dam info</span> has minimal impact on accuracy</li>
                                <li>EBV shows consistent upward bias (b > 1.0)</li>
                            </ul>
                            
                            <strong>Practical Implications:</strong> Method choice depends on data structure, computational resources, and trait characteristics.
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <div class="section-title">Key Results & Statistical Findings</div>
                
                <div class="results-grid">
                    <div class="results-box">
                        <div class="results-title">Variance and Reliability Patterns</div>
                        <div class="step-details">
                            <strong>Consistent Hierarchy:</strong><br>
                            ‚Ä¢ EBV: smallest variance, highest reliability<br>
                            ‚Ä¢ DRP_J: intermediate variance, close to EBV reliability<br>
                            ‚Ä¢ DRP_G: largest variance, lowest reliability<br><br>
                            
                            <strong>Chinese Holstein Results:</strong><br>
                            ‚Ä¢ EBV reliability: ~0.65<br>
                            ‚Ä¢ DRP_J reliability: ~0.64<br>
                            ‚Ä¢ DRP_G reliability: 0.10-0.20 lower<br><br>
                            
                            <strong>Correlation with EBV:</strong><br>
                            ‚Ä¢ DRP_J: higher correlation (closer to EBV)<br>
                            ‚Ä¢ DRP_G: lower correlation, more divergent
                        </div>
                    </div>
                    
                    <div class="results-box">
                        <div class="results-title">Prediction Accuracy Comparison</div>
                        <div class="step-details">
                            <strong>Simulated Data (trait-dependent):</strong><br>
                            ‚Ä¢ Trait 1: DRP_J slightly better<br>
                            ‚Ä¢ Trait 2: Comparable performance<br>
                            ‚Ä¢ Trait 3: DRP_G superior (0.822 vs 0.789)<br><br>
                            
                            <strong>Chinese Holstein (consistent):</strong><br>
                            ‚Ä¢ DRP_J consistently outperforms DRP_G<br>
                            ‚Ä¢ Average improvement: 0.11<br>
                            ‚Ä¢ Largest gain on FP: 0.131<br><br>
                            
                            <strong>Statistical Significance:</strong><br>
                            ‚Ä¢ Hotelling-Williams test confirms differences<br>
                            ‚Ä¢ Context-dependent method performance
                        </div>
                    </div>
                    
                    <div class="results-box">
                        <div class="results-title">Bias Analysis</div>
                        <div class="step-details">
                            <strong>EBV Bias Pattern:</strong><br>
                            ‚Ä¢ Consistent upward bias (b > 1.0)<br>
                            ‚Ä¢ Range: 1.178 to 1.382<br>
                            ‚Ä¢ Average deviation from 1.0: 0.227<br><br>
                            
                            <strong>DRP Method Comparison:</strong><br>
                            ‚Ä¢ DRP_G: 0.210 average deviation<br>
                            ‚Ä¢ DRP_J: 0.494 average deviation (larger bias)<br>
                            ‚Ä¢ Real data: DRP_J shows better bias control<br><br>
                            
                            <strong>Trait-Specific Effects:</strong><br>
                            ‚Ä¢ Bias magnitude varies by trait<br>
                            ‚Ä¢ Heritability influences bias patterns
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <div class="section-title">Weighting Scheme Analysis</div>
                
                <div class="comparison-grid">
                    <div class="comparison-box">
                        <div class="comparison-title">Variance Component Weighting (wrch)</div>
                        <div class="step-details">
                            <strong>Formula:</strong> w·µ¢ = (1-h¬≤)/[(c+(1-r¬≤)/r¬≤) √ó h¬≤]<br><br>
                            
                            <strong>Parameter c Impact:</strong><br>
                            ‚Ä¢ c = 0.01: Highest accuracy, lowest bias<br>
                            ‚Ä¢ c increasing to 0.9: Declining performance<br>
                            ‚Ä¢ Estimated c: 0.207-0.333 (suboptimal)<br><br>
                            
                            <strong>Performance Issues:</strong><br>
                            ‚Ä¢ Unstable bias estimates<br>
                            ‚Ä¢ Sometimes larger bias than reliability weighting<br>
                            ‚Ä¢ Complex parameter estimation required
                        </div>
                    </div>
                    
                    <div class="comparison-box">
                        <div class="comparison-title">Reliability Weighting (wr)</div>
                        <div class="step-details">
                            <strong>Formula:</strong> w·µ¢ = r¬≤·µ¢/(1-r¬≤·µ¢)<br><br>
                            
                            <strong>Advantages:</strong><br>
                            ‚Ä¢ Simpler calculation<br>
                            ‚Ä¢ More stable bias estimates<br>
                            ‚Ä¢ Performance equal to wrch at c ‚âà 0<br><br>
                            
                            <strong>Practical Benefits:</strong><br>
                            ‚Ä¢ No additional parameter estimation<br>
                            ‚Ä¢ Comparable accuracy to optimal wrch<br>
                            ‚Ä¢ Recommended for routine application
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <div class="section-title">Missing Information Impact</div>
                
                <div class="problem-box">
                    <div class="step-details">
                        <strong>Research Question:</strong> How does missing dam information affect DRP calculation and genomic prediction accuracy?<br><br>
                        
                        <strong>Simulation Design:</strong><br>
                        ‚Ä¢ Missing levels: 5%, 10%, 15%, 20%, 25%<br>
                        ‚Ä¢ Realistic scenario (10-20% missing in practice)<br>
                        ‚Ä¢ Impact on both DRP methods evaluated<br><br>
                        
                        <strong>Key Finding:</strong> Minimal impact on genomic prediction accuracy<br>
                        ‚Ä¢ No significant accuracy decline with increasing missing information<br>
                        ‚Ä¢ EBV-DRP correlations remain stable<br>
                        ‚Ä¢ Missing dam information not critical for DRP calculation
                    </div>
                </div>
            </div>
            
            <div class="section">
                <div class="section-title">Practical Implications & Recommendations</div>
                
                <div class="best-practices">
                    <div class="step-details">
                        <strong>Method Selection Guidelines:</strong><br><br>
                        
                        <strong>For Real Breeding Programs:</strong><br>
                        ‚Ä¢ DRP_J recommended for dairy cattle<br>
                        ‚Ä¢ Superior accuracy and bias control<br>
                        ‚Ä¢ Worth the computational complexity<br><br>
                        
                        <strong>For Large-Scale Applications:</strong><br>
                        ‚Ä¢ DRP_G acceptable for computational efficiency<br>
                        ‚Ä¢ Particularly when EDC calculation is burdensome<br>
                        ‚Ä¢ Consider trait-specific performance<br><br>
                        
                        <strong>Weighting Strategy:</strong><br>
                        ‚Ä¢ Use reliability-based weighting (wr)<br>
                        ‚Ä¢ Avoid complex variance component methods<br>
                        ‚Ä¢ Simpler and more stable results<br><br>
                        
                        <strong>Missing Information:</strong><br>
                        ‚Ä¢ Missing dam information tolerable<br>
                        ‚Ä¢ Focus resources on genotyping rather than complete pedigrees
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>