/* ============================================
   UNIFIED ACADEMIC PAPERS STYLESHEET
   WITH FULLY AUTOMATIC COLOR THEMES
   IMPROVED VERSION
   ============================================ */

/* Base Color Palette for Auto-Generation */
:root {
    /* 20 distinct colors for automatic cycling */
    --color-1: #e74c3c;   /* Red */
    --color-2: #3498db;   /* Blue */
    --color-3: #27ae60;   /* Green */
    --color-4: #f39c12;   /* Orange */
    --color-5: #9b59b6;   /* Purple */
    --color-6: #1abc9c;   /* Teal */
    --color-7: #e67e22;   /* Dark Orange */
    --color-8: #2ecc71;   /* Light Green */
    --color-9: #8e44ad;   /* Dark Purple */
    --color-10: #34495e;  /* Dark Blue-Gray */
    --color-11: #f1c40f;  /* Yellow */
    --color-12: #e91e63;  /* Pink */
    --color-13: #00bcd4;  /* Cyan */
    --color-14: #ff5722;  /* Deep Orange */
    --color-15: #607d8b;  /* Blue Gray */
    --color-16: #795548;  /* Brown */
    --color-17: #ff9800;  /* Amber */
    --color-18: #4caf50;  /* Light Green */
    --color-19: #673ab7;  /* Deep Purple */
    --color-20: #009688;  /* Teal Green */
    
    /* Darker variants for hover effects */
    --color-1-dark: #c0392b;
    --color-2-dark: #2980b9;
    --color-3-dark: #229954;
    --color-4-dark: #d68910;
    --color-5-dark: #8e44ad;
    --color-6-dark: #17a2b8;
    --color-7-dark: #d35400;
    --color-8-dark: #28b463;
    --color-9-dark: #7d3c98;
    --color-10-dark: #2c3e50;
    --color-11-dark: #f4d03f;
    --color-12-dark: #ad1457;
    --color-13-dark: #0097a7;
    --color-14-dark: #e64a19;
    --color-15-dark: #546e7a;
    --color-16-dark: #5d4037;
    --color-17-dark: #ef6c00;
    --color-18-dark: #388e3c;
    --color-19-dark: #512da8;
    --color-20-dark: #00796b;
    
    /* Lighter variants for subtle backgrounds */
    --color-1-light: #fadbd8;
    --color-2-light: #d6eaf8;
    --color-3-light: #d5f4e6;
    --color-4-light: #fdeaa7;
    --color-5-light: #e8d5f2;
    --color-6-light: #d0f0ed;
    --color-7-light: #fadcc9;
    --color-8-light: #d1f2df;
    --color-9-light: #e4d1f0;
    --color-10-light: #d5dbdb;
    --color-11-light: #fcf3cf;
    --color-12-light: #fad7e4;
    --color-13-light: #b2ebf2;
    --color-14-light: #ffccbc;
    --color-15-light: #cfd8dc;
    --color-16-light: #d7ccc8;
    --color-17-light: #ffe0b2;
    --color-18-light: #c8e6c9;
    --color-19-light: #d1c4e9;
    --color-20-light: #b2dfdb;
    
    /* Default theme (fallback) - will be overridden by JavaScript */
    --primary-color: var(--color-2);
    --primary-hover: var(--color-2-dark);
    --primary-light: var(--color-2-light);
    --secondary-color: #2c3e50;
    --accent-color: var(--color-1);
    --success-color: var(--color-3);
    --warning-color: var(--color-4);
    --info-color: #17a2b8;
    --purple-color: var(--color-5);
    --dark-purple: var(--color-9);
    
    /* Background colors */
    --bg-main: #f5f5f5;
    --bg-white: white;
    --bg-light: #f8f9fa;
    --bg-code: #ecf0f1;
    --bg-highlight: #fff3cd;
    --bg-specs: #e8f4f8;
    
    /* Text colors */
    --text-primary: #2c3e50;
    --text-secondary: #555;
    --text-muted: #666;
    --text-light: #7f8c8d;
    
    /* Border colors */
    --border-light: #ddd;
    --border-primary: var(--primary-color);
}

/* ============================================
   AUTOMATIC THEME GENERATION
   CSS Custom Properties will be set by JavaScript
   ============================================ */

/* Auto-theme classes that will be applied by JavaScript */
[data-theme="auto-1"] {
    --primary-color: var(--color-1);
    --primary-hover: var(--color-1-dark);
    --primary-light: var(--color-1-light);
    --accent-color: var(--color-2);
}

[data-theme="auto-2"] {
    --primary-color: var(--color-2);
    --primary-hover: var(--color-2-dark);
    --primary-light: var(--color-2-light);
    --accent-color: var(--color-3);
}

[data-theme="auto-3"] {
    --primary-color: var(--color-3);
    --primary-hover: var(--color-3-dark);
    --primary-light: var(--color-3-light);
    --accent-color: var(--color-4);
}

[data-theme="auto-4"] {
    --primary-color: var(--color-4);
    --primary-hover: var(--color-4-dark);
    --primary-light: var(--color-4-light);
    --accent-color: var(--color-5);
}

[data-theme="auto-5"] {
    --primary-color: var(--color-5);
    --primary-hover: var(--color-5-dark);
    --primary-light: var(--color-5-light);
    --accent-color: var(--color-6);
}

[data-theme="auto-6"] {
    --primary-color: var(--color-6);
    --primary-hover: var(--color-6-dark);
    --primary-light: var(--color-6-light);
    --accent-color: var(--color-7);
}

[data-theme="auto-7"] {
    --primary-color: var(--color-7);
    --primary-hover: var(--color-7-dark);
    --primary-light: var(--color-7-light);
    --accent-color: var(--color-8);
}

[data-theme="auto-8"] {
    --primary-color: var(--color-8);
    --primary-hover: var(--color-8-dark);
    --primary-light: var(--color-8-light);
    --accent-color: var(--color-9);
}

[data-theme="auto-9"] {
    --primary-color: var(--color-9);
    --primary-hover: var(--color-9-dark);
    --primary-light: var(--color-9-light);
    --accent-color: var(--color-10);
}

[data-theme="auto-10"] {
    --primary-color: var(--color-10);
    --primary-hover: var(--color-10-dark);
    --primary-light: var(--color-10-light);
    --accent-color: var(--color-11);
}

[data-theme="auto-11"] {
    --primary-color: var(--color-11);
    --primary-hover: var(--color-11-dark);
    --primary-light: var(--color-11-light);
    --accent-color: var(--color-12);
}

[data-theme="auto-12"] {
    --primary-color: var(--color-12);
    --primary-hover: var(--color-12-dark);
    --primary-light: var(--color-12-light);
    --accent-color: var(--color-13);
}

[data-theme="auto-13"] {
    --primary-color: var(--color-13);
    --primary-hover: var(--color-13-dark);
    --primary-light: var(--color-13-light);
    --accent-color: var(--color-14);
}

[data-theme="auto-14"] {
    --primary-color: var(--color-14);
    --primary-hover: var(--color-14-dark);
    --primary-light: var(--color-14-light);
    --accent-color: var(--color-15);
}

[data-theme="auto-15"] {
    --primary-color: var(--color-15);
    --primary-hover: var(--color-15-dark);
    --primary-light: var(--color-15-light);
    --accent-color: var(--color-16);
}

[data-theme="auto-16"] {
    --primary-color: var(--color-16);
    --primary-hover: var(--color-16-dark);
    --primary-light: var(--color-16-light);
    --accent-color: var(--color-17);
}

[data-theme="auto-17"] {
    --primary-color: var(--color-17);
    --primary-hover: var(--color-17-dark);
    --primary-light: var(--color-17-light);
    --accent-color: var(--color-18);
}

[data-theme="auto-18"] {
    --primary-color: var(--color-18);
    --primary-hover: var(--color-18-dark);
    --primary-light: var(--color-18-light);
    --accent-color: var(--color-19);
}

[data-theme="auto-19"] {
    --primary-color: var(--color-19);
    --primary-hover: var(--color-19-dark);
    --primary-light: var(--color-19-light);
    --accent-color: var(--color-20);
}

[data-theme="auto-20"] {
    --primary-color: var(--color-20);
    --primary-hover: var(--color-20-dark);
    --primary-light: var(--color-20-light);
    --accent-color: var(--color-1);
}

/* ============================================
   BASE STYLES
   ============================================ */

* {
    box-sizing: border-box;
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0;
    padding: 20px;
    background: var(--bg-main);
    line-height: 1.6;
    color: var(--text-primary);
}

/* ============================================
   LAYOUT COMPONENTS
   ============================================ */

.container {
    max-width: 1200px;
    margin: 0 auto;
    background: var(--bg-white);
    border-radius: 12px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.12);
    overflow: hidden;
    position: relative;
}

/* ============================================
   NAVIGATION - REFINED
   ============================================ */

.top-left-nav {
    position: absolute;
    top: 20px;
    left: 20px;
    z-index: 1000;
}

.top-left-nav a {
    color: rgba(255,255,255,0.95);
    text-decoration: none;
    font-size: 14px;
    font-weight: 600;
    padding: 10px 18px;
    background: rgba(0,0,0,0.25);
    backdrop-filter: blur(10px);
    border-radius: 25px;
    display: inline-flex;
    align-items: center;
    gap: 8px;
    transition: all 0.3s ease;
    border: 1px solid rgba(255,255,255,0.2);
}

.top-left-nav a:hover {
    background: rgba(0,0,0,0.4);
    color: white;
    transform: translateY(-1px);
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
}

.top-left-nav a::before {
    content: 'â†';
    font-size: 16px;
    font-weight: bold;
}

/* ============================================
   BACK TO TOP BUTTON - FIXED DOUBLE ARROW ISSUE
   ============================================ */

.back-to-top {
    position: fixed;
    bottom: 30px;
    right: 30px;
    background: var(--primary-color);
    color: white;
    width: 56px;
    height: 56px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: 0 6px 20px rgba(0,0,0,0.15);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transform: translateY(20px) scale(0.8);
    border: none;
    backdrop-filter: blur(10px);
    /* Remove the ::before content to prevent double arrows */
}

.back-to-top.visible {
    opacity: 1;
    visibility: visible;
    transform: translateY(0) scale(1);
}

.back-to-top:hover {
    background: var(--primary-hover);
    transform: translateY(-3px) scale(1.05);
    box-shadow: 0 8px 25px rgba(0,0,0,0.25);
}

.back-to-top:active {
    transform: translateY(-1px) scale(0.95);
}

/* Single arrow using ::after instead of ::before to avoid conflicts */
.back-to-top::after {
    content: 'â†‘';
    font-size: 22px;
    font-weight: bold;
    line-height: 1;
}

/* Remove any potential ::before content */
.back-to-top::before {
    display: none;
}

/* Add pulse animation for better visibility */
.back-to-top.visible {
    animation: pulseIn 0.6s ease-out;
}

@keyframes pulseIn {
    0% {
        transform: translateY(20px) scale(0.3);
        opacity: 0;
    }
    50% {
        transform: translateY(-5px) scale(1.1);
    }
    100% {
        transform: translateY(0) scale(1);
        opacity: 1;
    }
}

/* ============================================
   HEADER STYLES - REFINED
   ============================================ */

.header {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-hover) 100%);
    color: white;
    padding: 40px 30px;
    text-align: center;
    position: relative;
    overflow: hidden;
}

.header::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(45deg, transparent 0%, rgba(255,255,255,0.1) 50%, transparent 100%);
    pointer-events: none;
}

.header h1 {
    margin: 0 0 15px 0;
    font-size: 2.2em;
    font-weight: 700;
    text-shadow: 0 2px 4px rgba(0,0,0,0.2);
    position: relative;
    z-index: 1;
}

.header p {
    margin: 0;
    opacity: 0.95;
    font-size: 1.1em;
    font-weight: 400;
    position: relative;
    z-index: 1;
}

/* Header info box - REFINED */
.header-info {
    margin-top: 20px;
    padding: 20px;
    background: rgba(255,255,255,0.15);
    backdrop-filter: blur(10px);
    border-radius: 10px;
    border: 1px solid rgba(255,255,255,0.2);
    position: relative;
    z-index: 1;
}

.header-info p {
    margin: 0 0 8px 0;
    font-size: 0.95em;
}

.header-info .text-small {
    font-size: 0.9em;
    opacity: 0.9;
}

.header-info .text-top {
    margin-top: 8px;
}

.header-info .text-top-large {
    margin-top: 15px;
}

/* Paper link - REFINED */
.paper-link {
    color: rgba(255,255,255,0.95) !important;
    text-decoration: none;
    font-weight: 600;
    border: 2px solid rgba(255,255,255,0.3);
    padding: 8px 16px;
    border-radius: 6px;
    display: inline-flex;
    align-items: center;
    gap: 8px;
    transition: all 0.3s ease;
    backdrop-filter: blur(5px);
}

.paper-link:hover {
    background: rgba(255,255,255,0.2);
    border-color: rgba(255,255,255,0.6);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}

.paper-link::before {
    content: 'ðŸ”—';
    font-size: 14px;
}

/* Additional text utility classes */
.text-small { margin: 0; font-size: 0.9em; }
.text-top { margin: 5px 0 0 0; }
.text-top-large { margin: 10px 0 0 0; }
.list-top { margin-top: 10px; }
.list-small { margin: 5px 0; font-size: 0.9em; }

/* ============================================
   CITATION AND INFORMATION BOXES - REFINED
   ============================================ */

.citation,
.citation-box {
    background: var(--primary-light);
    padding: 20px 25px;
    border-radius: 10px;
    border-left: 5px solid var(--primary-color);
    margin-bottom: 25px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    font-size: 0.95em;
    line-height: 1.6;
}

.citation-box p:first-child {
    font-weight: 600;
    color: var(--primary-hover);
    margin-bottom: 15px;
}

.innovation-box {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-hover) 100%);
    color: white;
    padding: 25px;
    border-radius: 12px;
    margin: 25px 0;
    box-shadow: 0 6px 20px rgba(0,0,0,0.15);
    position: relative;
    overflow: hidden;
}

.innovation-box::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(45deg, transparent 0%, rgba(255,255,255,0.1) 50%, transparent 100%);
    pointer-events: none;
}

.innovation-title {
    font-weight: 700;
    font-size: 1.25em;
    margin-bottom: 12px;
    position: relative;
    z-index: 1;
}

.innovation-box p {
    position: relative;
    z-index: 1;
    margin: 0;
    line-height: 1.6;
}

.legacy-box {
    background: var(--primary-light);
    padding: 25px;
    border-radius: 10px;
    border-left: 5px solid var(--success-color);
    margin-bottom: 25px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
}

/* ============================================
   CONTENT STRUCTURE
   ============================================ */

.content {
    padding: 40px 30px;
}

.section {
    margin-bottom: 45px;
}

.section-title {
    font-size: 1.5em;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 25px;
    border-bottom: 3px solid var(--primary-color);
    padding-bottom: 8px;
    position: relative;
}

.section-title::after {
    content: '';
    position: absolute;
    bottom: -3px;
    left: 0;
    width: 60px;
    height: 3px;
    background: var(--accent-color);
}

/* ============================================
   FLOW DIAGRAMS - REFINED
   ============================================ */

.flow-container {
    display: flex;
    flex-direction: column;
    gap: 20px;
    margin: 25px 0;
}

.flow-step {
    display: flex;
    align-items: flex-start;
    gap: 25px;
    margin-bottom: 25px;
}

.step-number {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-hover) 100%);
    color: white;
    width: 45px;
    height: 45px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 1.1em;
    flex-shrink: 0;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.step-content {
    flex: 1;
    background: var(--bg-light);
    padding: 25px;
    border-radius: 10px;
    border-left: 4px solid var(--primary-color);
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    transition: all 0.3s ease;
}

.step-content:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(0,0,0,0.12);
}

.step-title {
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 12px;
    font-size: 1.15em;
}

.step-details {
    color: var(--text-secondary);
    line-height: 1.6;
}

.step-specs {
    background: var(--primary-light);
    padding: 15px;
    margin-top: 15px;
    border-radius: 8px;
    font-size: 0.95em;
    border-left: 3px solid var(--primary-color);
}

/* ============================================
   GRIDS AND LAYOUTS
   ============================================ */

.model-comparison,
.method-comparison,
.comparison-grid,
.results-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 25px;
    margin: 25px 0;
}

.analysis-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 25px;
    margin-top: 30px;
}

.theme-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 30px;
    margin: 30px 0;
}

.concept-grid,
.method-grid,
.software-grid,
.qc-grid,
.species-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 20px;
    margin: 25px 0;
}

.equation-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 25px;
    margin: 25px 0;
}

.coverage-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 25px;
    margin: 25px 0;
}

.mouse-lines {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin: 25px 0;
}

/* ============================================
   CARD COMPONENTS - REFINED
   ============================================ */

.model-box,
.method-box,
.comparison-box,
.results-box,
.analysis-box,
.theme-box,
.concept-card,
.method-card,
.software-card,
.qc-card,
.species-card,
.analysis-card {
    background: var(--bg-white);
    padding: 25px;
    border-radius: 10px;
    border: 2px solid var(--border-light);
    box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    transition: all 0.3s ease;
}

.model-box:hover,
.method-box:hover,
.comparison-box:hover,
.results-box:hover,
.analysis-box:hover,
.theme-box:hover,
.concept-card:hover,
.method-card:hover,
.software-card:hover,
.qc-card:hover,
.species-card:hover,
.analysis-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 20px rgba(0,0,0,0.15);
}

.model-title,
.method-title,
.comparison-title,
.analysis-title,
.theme-title,
.concept-title,
.method-name,
.software-name,
.qc-title,
.species-title {
    font-weight: 700;
    margin-bottom: 15px;
    font-size: 1.15em;
    color: var(--text-primary);
}

/* Color variants for different types - REFINED */
.model-1,
.method-1 { 
    border-color: var(--accent-color);
    border-left: 5px solid var(--accent-color);
}
.model-1 .model-title,
.method-1 .method-title { color: var(--accent-color); }

.model-2,
.method-2 { 
    border-color: var(--success-color);
    border-left: 5px solid var(--success-color);
}
.model-2 .model-title,
.method-2 .method-title { color: var(--success-color); }

.model-3,
.method-3 { 
    border-color: var(--warning-color);
    border-left: 5px solid var(--warning-color);
}
.model-3 .model-title,
.method-3 .method-title { color: var(--warning-color); }

.hard-sweep { 
    border-color: var(--accent-color);
    border-left: 5px solid var(--accent-color);
}
.hard-sweep .model-title { color: var(--accent-color); }

.soft-sweep { 
    border-color: var(--success-color);
    border-left: 5px solid var(--success-color);
}
.soft-sweep .model-title { color: var(--success-color); }

.census-box { 
    border-color: var(--accent-color);
    border-left: 5px solid var(--accent-color);
}
.census-box .comparison-title { color: var(--accent-color); }

.dna-box { 
    border-color: var(--success-color);
    border-left: 5px solid var(--success-color);
}
.dna-box .comparison-title { color: var(--success-color); }

.gwas-box { 
    border-color: var(--primary-color);
    border-left: 5px solid var(--primary-color);
}
.gwas-box .analysis-title { color: var(--primary-color); }

.prs-box { 
    border-color: var(--success-color);
    border-left: 5px solid var(--success-color);
}
.prs-box .analysis-title { color: var(--success-color); }

/* Analysis card variants - REFINED */
.analysis-card {
    border-top: 5px solid var(--primary-color);
    position: relative;
}

.analysis-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 5px;
    background: linear-gradient(90deg, var(--primary-color) 0%, var(--primary-hover) 100%);
}

.why-card { border-top-color: var(--accent-color); }
.why-card::before { background: linear-gradient(90deg, var(--accent-color) 0%, var(--color-1-dark) 100%); }

.how-card { border-top-color: var(--primary-color); }
.how-card::before { background: linear-gradient(90deg, var(--primary-color) 0%, var(--primary-hover) 100%); }

.what-card { border-top-color: var(--success-color); }
.what-card::before { background: linear-gradient(90deg, var(--success-color) 0%, var(--color-3-dark) 100%); }

.theory-card { border-top-color: var(--accent-color); }
.theory-card::before { background: linear-gradient(90deg, var(--accent-color) 0%, var(--color-1-dark) 100%); }

.detection-card { border-top-color: var(--primary-color); }
.detection-card::before { background: linear-gradient(90deg, var(--primary-color) 0%, var(--primary-hover) 100%); }

.evolution-card { border-top-color: var(--success-color); }
.evolution-card::before { background: linear-gradient(90deg, var(--success-color) 0%, var(--color-3-dark) 100%); }

/* Theme box variants - REFINED */
.theme-box {
    border-left: 5px solid var(--primary-color);
    background: var(--primary-light);
}

.theme-box.historical { 
    border-left-color: var(--purple-color);
    background: var(--color-5-light);
}
.theme-box.methodological { 
    border-left-color: var(--accent-color);
    background: var(--color-1-light);
}
.theme-box.phenotypic { 
    border-left-color: var(--warning-color);
    background: var(--color-4-light);
}
.theme-box.genetic { 
    border-left-color: var(--success-color);
    background: var(--color-3-light);
}
.theme-box.comparative { 
    border-left-color: var(--secondary-color);
    background: var(--color-10-light);
}

.historical .theme-title { color: var(--purple-color); }
.methodological .theme-title { color: var(--accent-color); }
.phenotypic .theme-title { color: var(--warning-color); }
.genetic .theme-title { color: var(--success-color); }
.comparative .theme-title { color: var(--secondary-color); }

/* Mouse line variants - REFINED */
.line-card {
    background: var(--bg-white);
    border: 3px solid var(--border-light);
    border-radius: 10px;
    padding: 20px;
    text-align: center;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
}

.line-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: var(--border-light);
    transition: all 0.3s ease;
}

.line-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0,0,0,0.1);
}

.line-card h4 {
    margin: 0 0 10px 0;
    color: var(--text-primary);
    font-weight: 700;
}

.fertility { border-color: #e91e63; }
.fertility::before { background: #e91e63; }

.body-mass { border-color: var(--warning-color); }
.body-mass::before { background: var(--warning-color); }

.endurance { border-color: var(--success-color); }
.endurance::before { background: var(--success-color); }

.control { border-color: #9e9e9e; }
.control::before { background: #9e9e9e; }

/* ============================================
   SPECIAL BOXES AND HIGHLIGHTS - REFINED
   ============================================ */

.results-box {
    background: var(--color-3-light);
    border: 2px solid var(--success-color);
    border-radius: 10px;
    padding: 25px;
    margin: 25px 0;
    box-shadow: 0 3px 10px rgba(39, 174, 96, 0.1);
}

.results-title {
    color: var(--success-color);
    font-weight: 700;
    margin-bottom: 15px;
    font-size: 1.2em;
}

.experiment-details {
    background: var(--color-3-light);
    padding: 20px;
    border-radius: 10px;
    margin: 20px 0;
    border-left: 4px solid var(--success-color);
}

.problem-box {
    background: var(--color-1-light);
    border: 2px solid var(--accent-color);
    border-radius: 10px;
    padding: 20px;
    margin: 20px 0;
    box-shadow: 0 3px 10px rgba(231, 76, 60, 0.1);
}

.solution-box {
    background: var(--color-3-light);
    border: 2px solid var(--success-color);
    border-radius: 10px;
    padding: 20px;
    margin: 20px 0;
    box-shadow: 0 3px 10px rgba(39, 174, 96, 0.1);
}

.warning-box {
    background: var(--color-4-light);
    border: 2px solid var(--warning-color);
    padding: 20px;
    border-radius: 10px;
    margin: 20px 0;
    box-shadow: 0 3px 10px rgba(243, 156, 18, 0.1);
}

.best-practices {
    background: var(--color-3-light);
    border: 2px solid var(--success-color);
    padding: 20px;
    border-radius: 10px;
    margin: 20px 0;
    box-shadow: 0 3px 10px rgba(39, 174, 96, 0.1);
}

.gap-analysis {
    background: var(--color-4-light);
    padding: 25px;
    border-radius: 10px;
    border-left: 6px solid var(--warning-color);
    margin: 30px 0;
    box-shadow: 0 3px 10px rgba(243, 156, 18, 0.1);
}

.gap-title {
    font-weight: 700;
    color: var(--warning-color);
    margin-bottom: 15px;
    font-size: 1.2em;
}

.gap-content {
    color: var(--text-primary);
    line-height: 1.6;
}

.significance-box {
    background: var(--color-2-light);
    padding: 25px;
    border-radius: 10px;
    border-left: 6px solid var(--info-color);
    margin: 30px 0;
    box-shadow: 0 3px 10px rgba(23, 162, 184, 0.1);
}

.significance-title {
    font-weight: 700;
    color: var(--info-color);
    margin-bottom: 15px;
    font-size: 1.2em;
}

.significance-content {
    color: var(--text-primary);
    line-height: 1.6;
}

.highlight {
    background: linear-gradient(120deg, var(--primary-light) 0%, var(--primary-color) 100%);
    color: var(--primary-hover);
    padding: 3px 6px;
    border-radius: 4px;
    font-weight: 600;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

/* ============================================
   IMPROVED EQUATION AND FORMULA BOXES
   ============================================ */

.formula {
    background: var(--primary-light);
    padding: 18px 25px;
    margin: 15px 0;
    border-radius: 10px;
    font-family: 'Monaco', 'Menlo', 'Courier New', monospace;
    border-left: 4px solid var(--primary-color);
    font-size: 1.1em;
    color: var(--text-primary);
    box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    text-align: center;
    font-weight: 600;
    letter-spacing: 0.5px;
    min-height: auto;
    display: flex;
    align-items: center;
    justify-content: center;
    line-height: 1.4;
}

/* Specific formula sizing based on content length */
.formula.short {
    padding: 15px 20px;
    font-size: 1.0em;
}

.formula.medium {
    padding: 20px 30px;
    font-size: 1.1em;
}

.formula.long {
    padding: 25px 35px;
    font-size: 0.95em;
    line-height: 1.6;
    text-align: left;
}

/* Auto-adjust formula box based on content */
.formula:has(br),
.formula[data-multiline="true"] {
    text-align: left;
    line-height: 1.6;
    padding: 25px 30px;
}

.matrix-visual {
    background: linear-gradient(135deg, var(--bg-light) 0%, var(--primary-light) 100%);
    border: 2px solid var(--primary-color);
    border-radius: 10px;
    padding: 25px;
    margin: 20px 0;
    text-align: center;
    font-family: 'Monaco', 'Menlo', 'Courier New', monospace;
    font-weight: 600;
    color: var(--text-primary);
    box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    font-size: 1.05em;
    line-height: 1.5;
}

/* Enhanced context boxes with better sizing */
.analysis-content,
.step-details,
.model-box p,
.method-box p,
.analysis-card p {
    line-height: 1.65;
    margin-bottom: 12px;
}

.analysis-content:last-child,
.step-details:last-child,
.model-box p:last-child,
.method-box p:last-child,
.analysis-card p:last-child {
    margin-bottom: 0;
}

/* Improved spacing for content boxes */
.step-content,
.analysis-card,
.model-box,
.method-box {
    min-height: fit-content;
}

.step-content {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.analysis-card {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

/* Better content wrapping */
.analysis-content ul,
.step-details ul {
    margin: 12px 0;
    padding-left: 22px;
}

.analysis-content li,
.step-details li {
    margin-bottom: 8px;
    line-height: 1.6;
}

/* ============================================
   TABLES - REFINED
   ============================================ */

.example-table,
.table-container table,
table {
    width: 100%;
    border-collapse: collapse;
    margin: 25px 0;
    background: var(--bg-white);
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
    border-radius: 10px;
    overflow: hidden;
}

.example-table th,
.example-table td,
table th,
table td {
    padding: 15px;
    text-align: left;
    border-bottom: 1px solid var(--border-light);
}

.example-table th,
table th {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-hover) 100%);
    color: white;
    font-weight: 700;
    text-transform: uppercase;
    font-size: 0.9em;
    letter-spacing: 0.5px;
}

.example-table tr:hover,
table tr:hover {
    background: var(--primary-light);
    transition: background-color 0.2s ease;
}

.example-table tr:last-child td,
table tr:last-child td {
    border-bottom: none;
}

.table-container {
    overflow-x: auto;
    margin: 25px 0;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
}

/* ============================================
   STATISTICS AND METRICS - REFINED
   ============================================ */

.stat-box {
    background: linear-gradient(135deg, var(--bg-white) 0%, var(--primary-light) 100%);
    padding: 25px;
    border-radius: 12px;
    text-align: center;
    border-top: 5px solid var(--primary-color);
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
    transition: all 0.3s ease;
}

.stat-box:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.15);
}

.stat-number {
    font-size: 2.5em;
    font-weight: 900;
    color: var(--primary-color);
    text-shadow: 0 2px 4px rgba(0,0,0,0.1);
    margin-bottom: 8px;
}

.stat-label {
    color: var(--text-secondary);
    margin-top: 8px;
    font-weight: 500;
    font-size: 0.95em;
}

/* ============================================
   CITATIONS AND REFERENCES - REFINED
   ============================================ */

.ref-box {
    background: var(--primary-light);
    padding: 20px;
    margin: 20px 0;
    border-radius: 8px;
    border-left: 5px solid var(--primary-color);
    box-shadow: 0 2px 6px rgba(0,0,0,0.05);
}

.ref-citation {
    font-weight: 700;
    color: var(--primary-hover);
    margin-bottom: 10px;
    font-size: 1.05em;
}

.ref-contribution {
    color: var(--text-secondary);
    line-height: 1.6;
    margin-bottom: 10px;
}

.ref-relevance {
    font-style: italic;
    color: var(--text-light);
    font-size: 0.9em;
    padding-top: 8px;
    border-top: 1px solid rgba(0,0,0,0.1);
}

/* ============================================
   LISTS - REFINED
   ============================================ */

ul {
    margin: 15px 0;
    padding-left: 25px;
}

li {
    margin-bottom: 10px;
    line-height: 1.5;
    position: relative;
}

/* Custom bullet points using theme color */
ul li::marker {
    color: var(--primary-color);
    font-weight: bold;
}

/* ============================================
   RESPONSIVE DESIGN - ENHANCED
   ============================================ */

@media (max-width: 768px) {
    body {
        padding: 10px;
    }
    
    .container {
        border-radius: 8px;
    }
    
    .header {
        padding: 30px 20px;
    }
    
    .header h1 {
        font-size: 1.8em;
    }
    
    .content {
        padding: 25px 20px;
    }
    
    .flow-step {
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
    }
    
    .step-number {
        margin-bottom: 10px;
        width: 40px;
        height: 40px;
    }
    
    .model-comparison,
    .method-comparison,
    .comparison-grid,
    .analysis-grid,
    .theme-container {
        grid-template-columns: 1fr;
        gap: 20px;
    }
    
    .equation-grid {
        grid-template-columns: 1fr;
    }
    
    .back-to-top {
        bottom: 20px;
        right: 20px;
        width: 50px;
        height: 50px;
    }
    
    .top-left-nav {
        position: relative;
        top: auto;
        left: auto;
        margin-bottom: 15px;
    }
    
    .top-left-nav a {
        padding: 8px 15px;
        font-size: 13px;
    }
    
    .header-info {
        padding: 15px;
    }
    
    .stat-number {
        font-size: 2em;
    }
    
    .formula {
        font-size: 0.95em;
        padding: 15px 20px;
    }
}

@media (max-width: 480px) {
    .header h1 {
        font-size: 1.5em;
    }
    
    .content {
        padding: 20px 15px;
    }
    
    .step-content,
    .model-box,
    .analysis-card {
        padding: 20px;
    }
    
    .concept-grid,
    .method-grid,
    .software-grid,
    .qc-grid,
    .species-grid {
        grid-template-columns: 1fr;
    }
    
    .formula {
        font-size: 0.9em;
        padding: 12px 18px;
    }
}

/* ============================================
   PRINT STYLES - ENHANCED
   ============================================ */

@media print {
    .back-to-top,
    .top-left-nav {
        display: none;
    }
    
    .container {
        box-shadow: none;
        margin: 0;
        padding: 0;
    }
    
    .header {
        background: var(--text-primary) !important;
        -webkit-print-color-adjust: exact;
        color-adjust: exact;
    }
    
    .innovation-box {
        background: var(--bg-light) !important;
        color: var(--text-primary) !important;
        border: 2px solid var(--primary-color);
    }
    
    .step-content:hover,
    .model-box:hover,
    .analysis-card:hover {
        transform: none;
        box-shadow: none;
    }
}

/* ============================================
   ACCESSIBILITY ENHANCEMENTS - ENHANCED
   ============================================ */

/* High contrast mode support */
@media (prefers-contrast: high) {
    :root {
        --bg-light: #ffffff;
        --bg-code: #f0f0f0;
        --text-secondary: #000000;
        --border-light: #000000;
    }
    
    .step-content,
    .model-box,
    .analysis-card {
        border-width: 3px;
    }
    
    .highlight {
        background: #ffff00;
        color: #000000;
    }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
    * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
    
    .back-to-top {
        transition: none;
    }
    
    .back-to-top.visible {
        animation: none;
    }
}

/* Focus indicators for keyboard navigation */
.back-to-top:focus,
.top-left-nav a:focus,
.paper-link:focus {
    outline: 3px solid var(--primary-color);
    outline-offset: 3px;
}

/* Screen reader improvements */
.sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

/* ============================================
   ANIMATION LIBRARY
   Subtle animations for enhanced UX
   ============================================ */

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes fadeInLeft {
    from {
        opacity: 0;
        transform: translateX(-30px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

@keyframes slideInRight {
    from {
        opacity: 0;
        transform: translateX(50px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

/* Apply animations to elements when they come into view */
.section {
    animation: fadeInUp 0.6s ease-out;
}

.flow-step:nth-child(odd) .step-content {
    animation: fadeInLeft 0.6s ease-out;
}

.flow-step:nth-child(even) .step-content {
    animation: slideInRight 0.6s ease-out;
}

/* Stagger animations for grid items */
.model-comparison > *:nth-child(1) { animation-delay: 0.1s; }
.model-comparison > *:nth-child(2) { animation-delay: 0.2s; }
.model-comparison > *:nth-child(3) { animation-delay: 0.3s; }

.analysis-grid > *:nth-child(1) { animation-delay: 0.1s; }
.analysis-grid > *:nth-child(2) { animation-delay: 0.2s; }
.analysis-grid > *:nth-child(3) { animation-delay: 0.3s; }

/* ============================================
   UTILITY CLASSES
   ============================================ */

/* Text utilities */
.text-center { text-align: center; }
.text-left { text-align: left; }
.text-right { text-align: right; }
.text-bold { font-weight: 700; }
.text-italic { font-style: italic; }

/* Margin utilities */
.mt-0 { margin-top: 0; }
.mt-1 { margin-top: 0.5rem; }
.mt-2 { margin-top: 1rem; }
.mt-3 { margin-top: 1.5rem; }
.mb-0 { margin-bottom: 0; }
.mb-1 { margin-bottom: 0.5rem; }
.mb-2 { margin-bottom: 1rem; }
.mb-3 { margin-bottom: 1.5rem; }

/* Padding utilities */
.p-0 { padding: 0; }
.p-1 { padding: 0.5rem; }
.p-2 { padding: 1rem; }
.p-3 { padding: 1.5rem; }

/* Color utilities */
.text-primary { color: var(--primary-color); }
.text-success { color: var(--success-color); }
.text-warning { color: var(--warning-color); }
.text-muted { color: var(--text-muted); }

/* Background utilities */
.bg-primary { background-color: var(--primary-color); }
.bg-light { background-color: var(--bg-light); }
.bg-white { background-color: var(--bg-white); }

/* Display utilities */
.d-none { display: none; }
.d-block { display: block; }
.d-inline { display: inline; }
.d-inline-block { display: inline-block; }
.d-flex { display: flex; }
.d-grid { display: grid; }

/* Flex utilities */
.flex-column { flex-direction: column; }
.flex-row { flex-direction: row; }
.justify-center { justify-content: center; }
.justify-between { justify-content: space-between; }
.align-center { align-items: center; }
.flex-wrap { flex-wrap: wrap; }

/* Border utilities */
.border { border: 1px solid var(--border-light); }
.border-primary { border-color: var(--primary-color); }
.border-radius { border-radius: 8px; }
.border-radius-lg { border-radius: 12px; }

/* Shadow utilities */
.shadow-sm { box-shadow: 0 2px 4px rgba(0,0,0,0.06); }
.shadow { box-shadow: 0 4px 8px rgba(0,0,0,0.12); }
.shadow-lg { box-shadow: 0 8px 25px rgba(0,0,0,0.15); }

/* ============================================
   CUSTOM SCROLLBAR STYLING
   ============================================ */

/* Webkit browsers (Chrome, Safari, Edge) */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: var(--bg-light);
    border-radius: 4px;
}

::-webkit-scrollbar-thumb {
    background: var(--primary-color);
    border-radius: 4px;
    transition: background-color 0.3s ease;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--primary-hover);
}

::-webkit-scrollbar-corner {
    background: var(--bg-light);
}

/* Firefox */
html {
    scrollbar-width: thin;
    scrollbar-color: var(--primary-color) var(--bg-light);
}

/* ============================================
   SELECTION STYLING
   ============================================ */

::selection {
    background: var(--primary-color);
    color: white;
    text-shadow: none;
}

::-moz-selection {
    background: var(--primary-color);
    color: white;
    text-shadow: none;
}

/* ============================================
   JAVASCRIPT AUTO-THEME IMPLEMENTATION
   Add this script to each HTML file's <head>
   ============================================ */

/*
<!-- AUTOMATIC THEME SCRIPT - COPY TO EACH HTML FILE -->
<script>
(function() {
    'use strict';
    
    function initAutoTheme() {
        try {
            const filename = window.location.pathname.split('/').pop().replace('.html', '') || 'default';
            const pageTitle = document.title || '';
            
            function generateHash(str) {
                let hash = 5381;
                for (let i = 0; i < str.length; i++) {
                    hash = ((hash << 5) + hash) + str.charCodeAt(i);
                    hash = hash & hash;
                }
                return Math.abs(hash);
            }
            
            const hashValue = generateHash(filename + pageTitle);
            const themeNumber = (hashValue % 20) + 1;
            
            document.body.setAttribute('data-theme', 'auto-' + themeNumber);
            document.body.setAttribute('data-file', filename);
            
            const year = filename.match(/\d{4}/)?.[0] || pageTitle.match(/\d{4}/)?.[0] || '';
            if (year) {
                document.body.setAttribute('data-year', year);
            }
            
            console.log('ðŸŽ¨ Theme:', 'auto-' + themeNumber, '| File:', filename);
            
        } catch (error) {
            console.warn('Theme initialization failed:', error);
            document.body.setAttribute('data-theme', 'auto-1');
        }
    }
    
    function initBackToTop() {
        try {
            let backToTopButton = document.getElementById('backToTop') || 
                                 document.querySelector('.back-to-top');
            
            if (!backToTopButton) {
                backToTopButton = document.createElement('div');
                backToTopButton.className = 'back-to-top';
                backToTopButton.id = 'backToTop';
                backToTopButton.setAttribute('aria-label', 'Back to top');
                backToTopButton.setAttribute('role', 'button');
                backToTopButton.setAttribute('tabindex', '0');
                document.body.appendChild(backToTopButton);
            }
            
            function toggleVisibility() {
                if (window.pageYOffset > 300) {
                    backToTopButton.classList.add('visible');
                } else {
                    backToTopButton.classList.remove('visible');
                }
            }
            
            function scrollToTop() {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            }
            
            window.addEventListener('scroll', toggleVisibility, { passive: true });
            backToTopButton.addEventListener('click', scrollToTop);
            
            backToTopButton.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    scrollToTop();
                }
            });
            
            toggleVisibility();
            
        } catch (error) {
            console.warn('Back to top initialization failed:', error);
        }
    }
    
    function init() {
        initAutoTheme();
        initBackToTop();
    }
    
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
    } else {
        init();
    }
})();
</script>
*/

/* ============================================
   END OF COMPLETE AUTOMATIC STYLESHEET
   
   ðŸŽ¯ COMPLETE FEATURE LIST:
   âœ… 1. Fully automatic theme system (20 colors)
   âœ… 2. Theme-aware back to top button (FIXED: single arrow)
   âœ… 3. Enhanced responsive design
   âœ… 4. Complete utility class system
   âœ… 5. Interactive component library
   âœ… 6. Accessibility enhancements
   âœ… 7. Print media optimizations
   âœ… 8. High contrast mode support
   âœ… 9. Motion preference respect
   âœ… 10. Custom scrollbar styling
   âœ… 11. Text selection styling
   âœ… 12. Smooth animations
   âœ… 13. Error handling
   âœ… 14. Performance optimizations
   âœ… 15. Browser compatibility
   âœ… 16. IMPROVED: Dynamic formula/equation boxes
   âœ… 17. IMPROVED: Better context box sizing
   âœ… 18. FIXED: Back-to-top double arrow issue
   
   ðŸ“– USAGE:
   1. Copy JavaScript from comments above
   2. Add to each HTML file's <head>
   3. Themes apply automatically
   4. No manual configuration needed
   5. Formula boxes auto-adjust to content
   6. Single clean back-to-top arrow
   
   ðŸ”§ RECENT FIXES:
   - Fixed back-to-top button double arrow issue
   - Enhanced formula boxes with dynamic sizing
   - Improved context box spacing and readability
   - Better responsive formula handling
   - Enhanced typography throughout
   
   Total: 1,600+ lines of complete CSS with improvements
   ============================================ */