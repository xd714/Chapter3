<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Single-step GBLUP for GWAS - Complete Paper Decomposition</title>
    <link rel="stylesheet" href="style.css">
</head>
<body data-theme="auto-2">
    <div class="container">
        <!-- Header Section -->
        <div class="header">
            <h1>Genome-wide association mapping including phenotypes from relatives without genotypes</h1>
            <p>A comprehensive single-step GBLUP (ssGBLUP) methodology for enhanced GWAS power and precision through integration of ungenotyped relatives</p>
            
            <div class="header-info">
                <p><strong>Authors:</strong> H. Wang¹, I. Misztal¹, I. Aguilar², A. Legarra³, W. M. Muir⁴</p>
                <p><strong>Affiliations:</strong></p>
                <p>¹University of Georgia, Athens, GA | ²INIA Las Brujas, Uruguay | ³INRA SAGA, France | ⁴Purdue University, IN</p>
                <p><strong>Journal:</strong> Genetics Research, Cambridge (2012), Vol. 94, pp. 73–83</p>
                <p><strong>DOI:</strong> 10.1017/S0016672312000274</p>
                <p><strong>Received:</strong> 19 September 2011 | <strong>Accepted:</strong> 13 March 2012</p>
                <a href="#" class="paper-link">Access Original Publication</a>
            </div>
        </div>

        <!-- Main Content -->
        <div class="content">
            <!-- Abstract and Summary -->
            <div class="section">
                <h2 class="section-title">Executive Summary</h2>
                
                <div class="citation-box">
                    <p><strong>Research Objective:</strong> To develop and validate a statistical method (ssGBLUP) that increases both power and precision in genome-wide association studies without increasing genotyping costs by leveraging phenotypes from ungenotyped relatives.</p>
                    
                    <p><strong>Key Innovation:</strong> The method blends traditional pedigree relationships with genomic marker relationships in a single analytical step, eliminating the need for pseudo-data creation while enabling complex multi-trait analyses with confounding factors.</p>
                    
                    <p><strong>Validation Results:</strong> Using 15,800 subjects (1,500 genotyped, 30 QTLs, h² = 0.5), ssGBLUP achieved 0.89 prediction accuracy (0.01 higher than BayesB) with correlations of 0.82 and 0.74 for QTL detection using 8 adjacent SNPs, compared to 0.83 for BayesB with 16 SNPs.</p>
                </div>
            </div>

            <!-- Detailed Problem Analysis -->
            <div class="section">
                <h2 class="section-title">Comprehensive Problem Analysis</h2>
                
                <div class="theme-container">
                    <div class="theme-box historical">
                        <h3 class="theme-title">Historical Context</h3>
                        <p>Genome-wide association studies emerged as powerful tools following commercial availability of high-density SNP chips in humans, proving effective for identifying genes associated with common diseases and complex traits. Similar applications in animal breeding for disease and production traits followed, with genomic selection (GWMAS) becoming a closely related procedure using the same SNP technology.</p>
                        
                        <p><strong>Timeline of Development:</strong></p>
                        <ul class="list-small">
                            <li>Early 2000s: Introduction of GWAS in human genetics</li>
                            <li>2001: Meuwissen et al. introduced BayesA/BayesB for genomic selection</li>
                            <li>2009: Development of GBLUP methods</li>
                            <li>2010: Introduction of single-step approaches</li>
                        </ul>
                    </div>
                    
                    <div class="theme-box methodological">
                        <h3 class="theme-title">Methodological Limitations</h3>
                        <p>Traditional approaches suffer from fundamental limitations that restrict their effectiveness in complex breeding scenarios and family-based studies.</p>
                        
                        <p><strong>Classical GWAS (CGWAS) Limitations:</strong></p>
                        <ul class="list-small">
                            <li>Single-marker testing treats each SNP independently</li>
                            <li>Reduced model fit compared to joint SNP consideration</li>
                            <li>Cannot incorporate population structure adequately</li>
                            <li>Limited power in structured populations</li>
                        </ul>
                        
                        <p><strong>Bayesian Method Constraints:</strong></p>
                        <ul class="list-small">
                            <li>Cannot directly include ungenotyped individuals</li>
                            <li>Require pseudo-data creation with associated information loss</li>
                            <li>Computationally intensive due to MCMC sampling</li>
                            <li>Heterogeneity issues from varying information content</li>
                        </ul>
                    </div>
                </div>

                <div class="problem-box">
                    <h3>Specific Technical Challenges</h3>
                    <p>The integration of genomic and pedigree information presents several computational and statistical challenges:</p>
                    
                    <div class="analysis-content">
                        <p><strong>1. Information Integration Challenge:</strong> Traditional methods cannot effectively combine phenotypic information from genotyped and ungenotyped animals in a unified framework, leading to suboptimal use of available data.</p>
                        
                        <p><strong>2. Pseudo-data Problems:</strong> Multi-step procedures that create deregressed proofs (DP) or other pseudo-phenotypes introduce:</p>
                        <ul>
                            <li>Information loss during data transformation</li>
                            <li>Heterogeneity from different amounts of original information</li>
                            <li>Potential bias in final estimates</li>
                            <li>Complexity in implementation and validation</li>
                        </ul>
                        
                        <p><strong>3. Computational Complexity:</strong> Existing methods either sacrifice accuracy for speed (CGWAS) or require extensive computational resources (BayesB), creating practical limitations for large-scale applications.</p>
                        
                        <p><strong>4. Nuclear Family Assumption:</strong> Many methods assume nuclear family structures, which are exceptions rather than rules in livestock breeding programs with complex, interconnected pedigrees.</p>
                    </div>
                </div>

                <div class="solution-box">
                    <h3>Proposed Solution: Single-step GBLUP Framework</h3>
                    <p>The ssGBLUP method addresses these limitations through a unified analytical framework that:</p>
                    
                    <div class="analysis-content">
                        <p><strong>Core Innovation:</strong> Direct integration of phenotypes, genotypes, and pedigree information in a single analytical step, eliminating the need for pseudo-data creation while maintaining computational efficiency.</p>
                        
                        <p><strong>Key Advantages:</strong></p>
                        <ul>
                            <li><span class="highlight">Unified Framework:</span> Combines all available information without data transformation</li>
                            <li><span class="highlight">Enhanced Power:</span> Utilizes phenotypes from ungenotyped relatives to increase statistical power</li>
                            <li><span class="highlight">Improved Precision:</span> Reduces estimation variance through better information utilization</li>
                            <li><span class="highlight">Computational Efficiency:</span> Avoids iterative pseudo-data creation and multiple analysis steps</li>
                            <li><span class="highlight">Flexibility:</span> Accommodates complex models including multi-trait, maternal effects, and environmental interactions</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Detailed Mathematical Framework -->
            <div class="section">
                <h2 class="section-title">Complete Mathematical Derivation</h2>
                
                <div class="formula-box">
                    <h3 class="formula-title">Fundamental Single-trait Model</h3>
                    <div class="formula-main">y = 1μ + Z<sub>a</sub>a + e</div>
                    <div class="formula-note">
                        <strong>Where:</strong><br>
                        • y = vector of simulated observations (phenotypes)<br>
                        • 1 = vector of all ones<br>
                        • μ = overall mean of phenotypic records<br>
                        • Z<sub>a</sub> = incidence matrix relating individuals to phenotypes<br>
                        • a = vector of individual animal effects<br>
                        • e = vector of residuals
                    </div>
                </div>

                <div class="matrix-container">
                    <h3>Variance-Covariance Structure</h3>
                    <div class="matrix-equation">
                        <span>var</span>
                        <div class="matrix-flexible">
                            <div class="matrix-row">
                                <div class="matrix-cell">a</div>
                            </div>
                            <div class="matrix-row">
                                <div class="matrix-cell">e</div>
                            </div>
                        </div>
                        <span class="equals">=</span>
                        <div class="matrix-flexible">
                            <div class="matrix-row">
                                <div class="matrix-cell">Hσ²<sub>a</sub></div>
                                <div class="matrix-cell">0</div>
                            </div>
                            <div class="matrix-row">
                                <div class="matrix-cell">0</div>
                                <div class="matrix-cell">Iσ²<sub>e</sub></div>
                            </div>
                        </div>
                    </div>
                    <p class="formula-note">H represents the combined relationship matrix integrating both pedigree and genomic information</p>
                </div>

                <div class="formula-box">
                    <h3 class="formula-title">Combined Relationship Matrix Inverse</h3>
                    <div class="formula-main">H⁻¹ = A⁻¹ + [0 0; 0 (G⁻¹ - A₂₂⁻¹)]</div>
                    <div class="formula-note">
                        <strong>Components:</strong><br>
                        • A = numerator (pedigree) relationship matrix for all animals<br>
                        • A₂₂ = numerator relationship matrix for genotyped animals only<br>
                        • G = genomic relationship matrix<br>
                        • The structure allows seamless integration of genotyped and ungenotyped animals
                    </div>
                </div>

                <div class="formula-box">
                    <h3 class="formula-title">Genomic Relationship Matrix Construction</h3>
                    <div class="formula-main">G = ZDZ'λ</div>
                    <div class="formula-note">
                        <strong>Where:</strong><br>
                        • Z = matrix relating genotypes of each locus<br>
                        • D = diagonal matrix of weights for SNP variances (D = I for standard GBLUP)<br>
                        • λ = normalization constant = σ²<sub>u</sub>/σ²<sub>a</sub><br>
                        • λ = 1 / Σᴹᵢ₌₁2pᵢ(1-pᵢ) where M = number of SNPs, pᵢ = allele frequency
                    </div>
                </div>

                <div class="matrix-container">
                    <h3>SNP Effects Derivation</h3>
                    <p>Animal effects for genotyped individuals can be expressed as functions of SNP effects:</p>
                    <div class="formula-main">a<sub>g</sub> = Zu</div>
                    <p class="formula-note">where u is the vector of SNP marker effects</p>
                    
                    <p>The variance of animal effects becomes:</p>
                    <div class="formula-main">var(a<sub>g</sub>) = var(Zu) = ZDZ'σ²<sub>u</sub> = G*σ²<sub>a</sub></div>
                    <p class="formula-note">where G* is the weighted genomic relationship matrix</p>
                </div>

                <div class="matrix-container">
                    <h3>Joint Variance Structure</h3>
                    <p>The joint (co)variance of animal effects and SNP effects is:</p>
                    <div class="matrix-equation">
                        <span>var</span>
                        <div class="matrix-flexible">
                            <div class="matrix-row">
                                <div class="matrix-cell">a<sub>g</sub></div>
                            </div>
                            <div class="matrix-row">
                                <div class="matrix-cell">u</div>
                            </div>
                        </div>
                        <span class="equals">=</span>
                        <div class="matrix-flexible">
                            <div class="matrix-row">
                                <div class="matrix-cell">ZDZ'</div>
                                <div class="matrix-cell">ZD</div>
                            </div>
                            <div class="matrix-row">
                                <div class="matrix-cell">DZ'</div>
                                <div class="matrix-cell">D</div>
                            </div>
                        </div>
                        <span>σ²<sub>u</sub></span>
                    </div>
                </div>

                <div class="formula-box">
                    <h3 class="formula-title">Best Predictor of SNP Effects</h3>
                    <div class="formula-main">û = (σ²<sub>u</sub>/σ²<sub>a</sub>)DZ'G*⁻¹â<sub>g</sub></div>
                    <div class="formula-note">
                        This represents the Best Linear Unbiased Predictor (BLUP) of SNP effects given animal effects, following Henderson (1973) theory.
                    </div>
                </div>

                <div class="formula-box">
                    <h3 class="formula-title">Simplified SNP Effects Equation</h3>
                    <div class="formula-main">û = λDZ'G*⁻¹â<sub>g</sub> = DZ'[ZDZ']⁻¹â<sub>g</sub></div>
                    <div class="formula-note">
                        This simplified form eliminates the need for matrix inversion of the full genomic relationship matrix, providing computational advantages.
                    </div>
                </div>

                <div class="formula-box">
                    <h3 class="formula-title">SNP Variance Estimation</h3>
                    <div class="formula-main">σ̂²<sub>u,i</sub> = û²<sub>i</sub> / [2pᵢ(1-pᵢ)]</div>
                    <div class="formula-note">
                        Individual SNP variance estimates following Zhang et al. (2010), where pᵢ is the allele frequency of the i-th marker.
                    </div>
                </div>
            </div>

            <!-- Complete Algorithm Implementation -->
            <div class="section">
                <h2 class="section-title">Detailed Iterative Algorithm</h2>
                
                <div class="flow-container">
                    <div class="flow-step">
                        <div class="step-number">0</div>
                        <div class="step-content">
                            <div class="step-title">Algorithm Initialization</div>
                            <div class="step-details">
                                <p><strong>Set iteration counter:</strong> t = 0</p>
                                <p><strong>Initialize weight matrix:</strong> D<sup>(t)</sup> = I (identity matrix)</p>
                                <p><strong>Compute initial genomic relationship matrix:</strong></p>
                                <div class="formula">G*<sup>(t)</sup> = ZD<sup>(t)</sup>Z'λ</div>
                                <p><strong>Calculate normalization constant:</strong></p>
                                <div class="formula">λ = 1 / Σᴹᵢ₌₁2pᵢ(1-pᵢ)</div>
                                <div class="step-specs">
                                    <strong>Implementation Notes:</strong><br>
                                    • M = total number of SNP markers<br>
                                    • pᵢ = frequency of second allele for i-th marker<br>
                                    • Initial equal weighting assumes infinitesimal model
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flow-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <div class="step-title">Combined Relationship Matrix Construction</div>
                            <div class="step-details">
                                <p><strong>Construct H matrix inverse:</strong></p>
                                <div class="formula">H⁻¹ = A⁻¹ + [0 0; 0 (G*<sup>(t)</sup>⁻¹ - A₂₂⁻¹)]</div>
                                <p><strong>Matrix dimensions and structure:</strong></p>
                                <ul>
                                    <li>A⁻¹: (n × n) where n = total animals in pedigree</li>
                                    <li>G*⁻¹: (g × g) where g = genotyped animals</li>
                                    <li>A₂₂⁻¹: (g × g) for genotyped animals only</li>
                                </ul>
                                <div class="step-specs">
                                    <strong>Computational Considerations:</strong><br>
                                    • H⁻¹ is sparse and can be stored efficiently<br>
                                    • Only the genomic portion requires iterative updates<br>
                                    • Compatibility scaling ensures proper integration
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flow-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <div class="step-title">Animal Effects Estimation (ssGBLUP)</div>
                            <div class="step-details">
                                <p><strong>Solve mixed model equations:</strong></p>
                                <div class="formula">[X'X X'Z; Z'X Z'Z + H⁻¹α] [β̂; â] = [X'y; Z'y]</div>
                                <p><strong>Where:</strong></p>
                                <ul>
                                    <li>X = design matrix for fixed effects</li>
                                    <li>Z = incidence matrix for random effects</li>
                                    <li>α = σ²<sub>e</sub>/σ²<sub>a</sub> = variance ratio</li>
                                    <li>β̂ = estimated fixed effects</li>
                                    <li>â = estimated animal effects (breeding values)</li>
                                </ul>
                                <div class="step-specs">
                                    <strong>Solution Methods:</strong><br>
                                    • Direct inversion for small problems<br>
                                    • Iterative methods (PCG) for large datasets<br>
                                    • Exploits sparsity of coefficient matrix
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flow-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <div class="step-title">SNP Effects Computation</div>
                            <div class="step-details">
                                <p><strong>Convert animal effects to SNP effects:</strong></p>
                                <div class="formula">û<sup>(t)</sup> = λD<sup>(t)</sup>Z'G*<sup>(t)</sup>⁻¹â<sub>g</sub></div>
                                <p><strong>Alternative computational form:</strong></p>
                                <div class="formula">û<sup>(t)</sup> = D<sup>(t)</sup>Z'[ZD<sup>(t)</sup>Z']⁻¹â<sub>g</sub></div>
                                <p><strong>Individual SNP effect calculation:</strong></p>
                                <ul>
                                    <li>For each SNP i: û<sub>i</sub><sup>(t)</sup> = Σⱼ d<sub>ij</sub><sup>(t)</sup> z'<sub>ij</sub> coefficient</li>
                                    <li>Weights D<sup>(t)</sup> modify the contribution of each marker</li>
                                </ul>
                                <div class="step-specs">
                                    <strong>Computational Efficiency:</strong><br>
                                    • Avoids full G* matrix inversion<br>
                                    • Uses Cholesky decomposition when possible<br>
                                    • Leverages matrix structure for speed
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flow-step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <div class="step-title">Weight Matrix Update</div>
                            <div class="step-details">
                                <p><strong>Calculate individual SNP weights:</strong></p>
                                <div class="formula">d<sub>i</sub><sup>(t+1)*</sup> = û<sub>i</sub><sup>2(t)</sup> / [2pᵢ(1-pᵢ)]</div>
                                <p><strong>Normalize weight matrix:</strong></p>
                                <div class="formula">D<sup>(t+1)</sup> = [tr(D<sup>(0)</sup>) / tr(D<sup>(t+1)*</sup>)] × D<sup>(t+1)*</sup></div>
                                <p><strong>Weight update rationale:</strong></p>
                                <ul>
                                    <li>Larger SNP effects receive higher weights</li>
                                    <li>Normalization maintains genetic variance scale</li>
                                    <li>Adjustment for allele frequency differences</li>
                                </ul>
                                <div class="step-specs">
                                    <strong>Normalization Importance:</strong><br>
                                    • Prevents variance inflation across iterations<br>
                                    • Maintains comparability with initial model<br>
                                    • Ensures convergence stability
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flow-step">
                        <div class="step-number">5</div>
                        <div class="step-content">
                            <div class="step-title">Genomic Relationship Matrix Update</div>
                            <div class="step-details">
                                <p><strong>Recalculate weighted genomic relationships:</strong></p>
                                <div class="formula">G<sup>(t+1)*</sup> = ZD<sup>(t+1)</sup>Z'λ</div>
                                <p><strong>Update combined relationship matrix:</strong></p>
                                <div class="formula">H<sup>(t+1)</sup>⁻¹ = A⁻¹ + [0 0; 0 (G<sup>(t+1)*</sup>⁻¹ - A₂₂⁻¹)]</div>
                                <p><strong>Matrix properties after update:</strong></p>
                                <ul>
                                    <li>Maintains positive definiteness</li>
                                    <li>Preserves genetic variance scaling</li>
                                    <li>Incorporates updated SNP importance</li>
                                </ul>
                                <div class="step-specs">
                                    <strong>Computational Strategy:</strong><br>
                                    • Only update genomic portion of H⁻¹<br>
                                    • Pedigree relationships remain constant<br>
                                    • Efficient sparse matrix operations
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="flow-step">
                        <div class="step-number">6</div>
                        <div class="step-content">
                            <div class="step-title">Iteration Control and Convergence</div>
                            <div class="step-details">
                                <p><strong>Increment iteration counter:</strong> t = t + 1</p>
                                <p><strong>Convergence criteria options:</strong></p>
                                <ul>
                                    <li>Maximum number of iterations (e.g., 8-10)</li>
                                    <li>Relative change in SNP effects < threshold</li>
                                    <li>Change in log-likelihood < tolerance</li>
                                    <li>Stability of largest SNP effects</li>
                                </ul>
                                <p><strong>Algorithm scenarios:</strong></p>
                                <div class="analysis-content">
                                    <p><strong>Scenario S1 (Loop to Step 3):</strong></p>
                                    <ul>
                                        <li>Updates SNP effects using revised G* only</li>
                                        <li>Animal effects calculated once and remain fixed</li>
                                        <li>Faster computation, suitable for multi-trait models</li>
                                        <li>Maintains identical relationship matrix across traits</li>
                                    </ul>
                                    
                                    <p><strong>Scenario S2 (Loop to Step 2):</strong></p>
                                    <ul>
                                        <li>Recomputes both animal and SNP effects each iteration</li>
                                        <li>More computationally intensive but potentially more accurate</li>
                                        <li>Allows for corrections to SNPs with small effects</li>
                                        <li>May improve GEBV accuracy through iteration</li>
                                    </ul>
                                </div>
                                <div class="step-specs">
                                    <strong>Practical Implementation:</strong><br>
                                    • S1 typically sufficient for most applications<br>
                                    • S2 beneficial when differential weighting improves accuracy significantly<br>
                                    • Monitor for over-fitting in later iterations
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Comprehensive Simulation Study -->
            <div class="section">
                <h2 class="section-title">Detailed Simulation Study Design</h2>
                
                <div class="analysis-grid">
                    <div class="analysis-card what-card">
                        <h3 class="analysis-title">Population Structure & Breeding Design</h3>
                        <div class="analysis-content">
                            <p><strong>Simulation Software:</strong> QMSim (Sargolzaei & Schenkel, 2009)</p>
                            
                            <p><strong>Genetic Architecture:</strong></p>
                            <ul>
                                <li>Additive trait with mean = 5.0</li>
                                <li>Phenotypic variance = 1.0</li>
                                <li>Heritability = 0.5</li>
                                <li>All genetic variance from simulated QTLs</li>
                            </ul>
                            
                            <p><strong>Genome Structure:</strong></p>
                            <ul>
                                <li>Two chromosomes, each 100 cM length</li>
                                <li>15 QTLs uniformly distributed per chromosome</li>
                                <li>Average 1,552 and 1,448 SNPs per chromosome</li>
                                <li>No overlap between SNP markers and QTLs</li>
                                <li>All loci bi-allelic with MAF > 0.05</li>
                            </ul>
                        </div>
                    </div>

                    <div class="analysis-card how-card">
                        <h3 class="analysis-title">Breeding Program Simulation</h3>
                        <div class="analysis-content">
                            <p><strong>Population History:</strong></p>
                            <ul>
                                <li>Base population (generation 1001): 100 individuals</li>
                                <li>Historical generations (1001 to 1): gradual expansion</li>
                                <li>Population size increased from 100 to 2,800</li>
                                <li>Mutation rate: 0.000025 per locus per generation</li>
                            </ul>
                            
                            <p><strong>Recent Generations (0-4):</strong></p>
                            <ul>
                                <li>80 randomly chosen males per generation</li>
                                <li>520 randomly chosen females per generation</li>
                                <li>Random mating producing 2,600 offspring</li>
                                <li>All parents genotyped in generations 3 and 4</li>
                            </ul>
                            
                            <p><strong>Data Collection:</strong></p>
                            <ul>
                                <li>Phenotypes recorded for all animals generations 0-5</li>
                                <li>300 random individuals genotyped in generation 5</li>
                                <li>Total: 15,800 individuals with phenotypes</li>
                                <li>1,500 individuals with genotypes</li>
                            </ul>
                        </div>
                    </div>

                    <div class="analysis-card why-card">
                        <h3 class="analysis-title">QTL Effect Distribution</h3>
                        <div class="analysis-content">
                            <p><strong>Effect Size Distribution:</strong></p>
                            <ul>
                                <li>Gamma distribution with shape = 0.4</li>
                                <li>Scale parameter = 1.36</li>
                                <li>Creates realistic distribution of effect sizes</li>
                                <li>Few large effects, many small effects</li>
                            </ul>
                            
                            <p><strong>Chromosome-specific Details:</strong></p>
                            <ul>
                                <li>Chromosome 1: 16 QTLs (SD = 2), avg effect = 0.15</li>
                                <li>Chromosome 2: 14 QTLs (SD = 2), avg effect = 0.16</li>
                                <li>Total genetic variance partitioned across 30 QTLs</li>
                                <li>Effect sizes range from small to moderate</li>
                            </ul>
                            
                            <p><strong>Replication Strategy:</strong></p>
                            <ul>
                                <li>10 independent replicates</li>
                                <li>Same population structure, different random seeds</li>
                                <li>Enables assessment of method stability</li>
                                <li>Statistical comparison across methods</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="table-container">
                    <h3>Complete Simulation Parameters Summary</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Parameter Category</th>
                                <th>Specification</th>
                                <th>Chromosome 1</th>
                                <th>Chromosome 2</th>
                                <th>Total/Overall</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="published-group">
                                <td rowspan="3"><strong>Marker Information</strong></td>
                                <td>Number of SNPs</td>
                                <td>1,552 (±22)</td>
                                <td>1,448 (±22)</td>
                                <td>3,000</td>
                            </tr>
                            <tr class="published-group">
                                <td>Average MAF</td>
                                <td>0.28 (±0.004)</td>
                                <td>0.28 (±0.005)</td>
                                <td>0.28 (±0.005)</td>
                            </tr>
                            <tr class="published-group">
                                <td>Marker Density</td>
                                <td>15.52 SNPs/cM</td>
                                <td>14.48 SNPs/cM</td>
                                <td>15.0 SNPs/cM</td>
                            </tr>
                            <tr class="alternative-group">
                                <td rowspan="3"><strong>QTL Information</strong></td>
                                <td>Number of QTLs</td>
                                <td>16 (±2)</td>
                                <td>14 (±2)</td>
                                <td>30</td>
                            </tr>
                            <tr class="alternative-group">
                                <td>Average Effect Size</td>
                                <td>0.15 (±0.04)</td>
                                <td>0.16 (±0.04)</td>
                                <td>0.16 (±0.04)</td>
                            </tr>
                            <tr class="alternative-group">
                                <td>QTL Density</td>
                                <td>0.16 QTLs/cM</td>
                                <td>0.14 QTLs/cM</td>
                                <td>0.15 QTLs/cM</td>
                            </tr>
                            <tr class="new-group">
                                <td rowspan="4"><strong>Population Structure</strong></td>
                                <td>Total Individuals</td>
                                <td colspan="2">15,800 with phenotypes</td>
                                <td>Generations 0-5</td>
                            </tr>
                            <tr class="new-group">
                                <td>Genotyped Animals</td>
                                <td colspan="2">1,500 individuals</td>
                                <td>9.5% of population</td>
                            </tr>
                            <tr class="new-group">
                                <td>Breeding Structure</td>
                                <td colspan="2">80 males × 520 females</td>
                                <td>Recent generations</td>
                            </tr>
                            <tr class="new-group">
                                <td>Heritability</td>
                                <td colspan="2">0.5</td>
                                <td>Moderate heritability</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Method Comparison Framework -->
            <div class="section">
                <h2 class="section-title">Comprehensive Method Comparison</h2>
                
                <div class="method-comparison">
                    <div class="method-box method-1">
                        <h3 class="method-title">ssGBLUP Implementation</h3>
                        <div class="method-details">
                            <p><strong>Software Platform:</strong> Modified BLUPF90 (Misztal et al., 2002)</p>
                            <p><strong>Key Features:</strong></p>
                            <ul>
                                <li>Direct phenotype utilization (no pseudo-data)</li>
                                <li>Unified pedigree-genomic relationship matrix</li>
                                <li>Iterative weight optimization</li>
                                <li>Two scenario implementations (S1 & S2)</li>
                            </ul>
                            
                            <p><strong>Model Specification:</strong></p>
                            <div class="formula">y = 1μ + Z<sub>a</sub>a + e</div>
                            
                            <p><strong>Implementation Details:</strong></p>
                            <ul>
                                <li>Used simulated parameters (known variances)</li>
                                <li>Compatibility scaling with A₂₂ matrix</li>
                                <li>VanRaden et al. (2009) G matrix construction</li>
                                <li>Current population allele frequencies</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="method-box method-2">
                        <h3 class="method-title">BayesB Implementation</h3>
                        <div class="method-details">
                            <p><strong>Software Platform:</strong> GenSel package (Habier et al., 2010)</p>
                            <p><strong>Model Specification:</strong></p>
                            <div class="formula">ỹ = 1μ + Z<sub>u</sub>u + e</div>
                            
                            <p><strong>Key Parameters:</strong></p>
                            <ul>
                                <li>Dependent variable: Deregressed proofs (DP)</li>
                                <li>Proportion of zero-effect SNPs: π = 0.90</li>
                                <li>SNP effects: u<sub>j</sub> ~ N(0, σ²<sub>uj</sub>)</li>
                                <li>Variable selection through π parameter</li>
                            </ul>
                            
                            <p><strong>MCMC Settings:</strong></p>
                            <ul>
                                <li>Total iterations: 100,000</li>
                                <li>Burn-in period: 10,000 iterations</li>
                                <li>Gibbs sampling with Metropolis-Hastings</li>
                                <li>100 M-H steps per Gibbs cycle</li>
                                <li>Posterior means from final 90,000 iterations</li>
                            </ul>
                            
                            <p><strong>Prior Specifications:</strong></p>
                            <ul>
                                <li>SNP variances: Scaled inverse Chi-square (df=4)</li>
                                <li>Residual variance: Scaled inverse Chi-square (df=10)</li>
                                <li>Total genetic variance = 0.5 (simulated value)</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="method-box method-3">
                        <h3 class="method-title">Classical GWAS (CGWAS)</h3>
                        <div class="method-details">
                            <p><strong>Software Platform:</strong> WOMBAT 'Snappy' approach (Meyer & Tier, 2012)</p>
                            <p><strong>Analysis Strategy:</strong></p>
                            <ul>
                                <li>Single-marker tests treating each SNP as covariate</li>
                                <li>Pre-computation of common matrices</li>
                                <li>Significant reduction in computation time</li>
                                <li>Complete genome scan capability</li>
                            </ul>
                            
                            <p><strong>Statistical Model:</strong></p>
                            <div class="formula">DP = μ + SNP<sub>i</sub>β<sub>i</sub> + e</div>
                            
                            <p><strong>Implementation Advantages:</strong></p>
                            <ul>
                                <li>Matrix operations optimized for repeated analysis</li>
                                <li>Over 100× faster than previous CGWAS methods</li>
                                <li>Handles large SNP panels efficiently</li>
                                <li>Standard statistical testing framework</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="formula-box">
                    <h3 class="formula-title">Deregressed Proofs (DP) Construction</h3>
                    <div class="analysis-content">
                        <p><strong>Non-weighted DP:</strong> All weights assumed equal (wᵢ = 1)</p>
                        
                        <p><strong>Weighted DP formula:</strong></p>
                        <div class="formula">wᵢ = (1-h²)/[c + (1-r²ᵢ)/r²ᵢ]h²</div>
                        
                        <p><strong>Where:</strong></p>
                        <ul>
                            <li>c = fraction of genetic variance not captured by SNPs (assumed 0.1)</li>
                            <li>h² = heritability (0.5 in simulation)</li>
                            <li>r²ᵢ = reliability of DP for individual i</li>
                            <li>wᵢ = weight for individual i in analysis</li>
                        </ul>
                        
                        <p><strong>Residual distribution:</strong> e ~ N(0, D<sub>b</sub>σ²<sub>e</sub>) where D<sub>b</sub> contains weights</p>
                    </div>
                </div>
            </div>

            <!-- Detailed Results Analysis -->
            <div class="section">
                <h2 class="section-title">Comprehensive Results Analysis</h2>
                
                <div class="results-box">
                    <h3 class="results-title">Breeding Value Prediction Accuracy</h3>
                    <p>Accuracy defined as correlation between True Breeding Values (TBVs) from simulation and Estimated Breeding Values (EBVs) or Genomic EBVs (GEBVs)</p>
                </div>

                <div class="table-container">
                    <h3>Complete Accuracy Results Across Methods and Iterations</h3>
                    <table class="performance-table">
                        <thead>
                            <tr>
                                <th>Method</th>
                                <th>Iteration 1</th>
                                <th>Iteration 2</th>
                                <th>Iteration 3</th>
                                <th>Iteration 4</th>
                                <th>Iteration 5</th>
                                <th>Iteration 6</th>
                                <th>Iteration 7</th>
                                <th>Iteration 8</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="published-group">
                                <td><strong>Regular BLUP</strong></td>
                                <td>0.81 (0.01)</td>
                                <td colspan="7">No iteration (pedigree-based)</td>
                            </tr>
                            <tr class="alternative-group">
                                <td><strong>ssGBLUP (S1)</strong></td>
                                <td>0.87 (0.01)</td>
                                <td>0.87 (0.01)</td>
                                <td>0.87 (0.01)</td>
                                <td>0.87 (0.02)</td>
                                <td>0.87 (0.02)</td>
                                <td>0.87 (0.02)</td>
                                <td>0.87 (0.02)</td>
                                <td>0.87 (0.02)</td>
                            </tr>
                            <tr class="new-group">
                                <td><strong>ssGBLUP (S2)</strong></td>
                                <td>0.87 (0.01)</td>
                                <td><strong>0.89 (0.01)</strong></td>
                                <td>0.88 (0.01)</td>
                                <td>0.88 (0.02)</td>
                                <td>0.88 (0.02)</td>
                                <td>0.88 (0.02)</td>
                                <td>0.87 (0.02)</td>
                                <td>0.87 (0.02)</td>
                            </tr>
                            <tr class="high-pev-group">
                                <td><strong>BayesB (Non-weighted DP)</strong></td>
                                <td colspan="8">0.88 (0.02)</td>
                            </tr>
                            <tr class="low-pev-group">
                                <td><strong>BayesB (Weighted DP, c=0.1)</strong></td>
                                <td colspan="8">0.88 (0.02)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="analysis-grid">
                    <div class="analysis-card detection-card">
                        <h3 class="analysis-title">Key Accuracy Observations</h3>
                        <div class="analysis-content">
                            <p><strong>ssGBLUP Performance:</strong></p>
                            <ul>
                                <li>Scenario S1: Stable accuracy (0.87) across iterations</li>
                                <li>Scenario S2: Peak accuracy (0.89) at iteration 2</li>
                                <li>Slight decrease in later iterations due to over-weighting</li>
                                <li>Consistently outperforms regular BLUP by 0.06-0.08</li>
                            </ul>
                            
                            <p><strong>Comparative Performance:</strong></p>
                            <ul>
                                <li>ssGBLUP (best): 0.89 vs BayesB: 0.88</li>
                                <li>Lower standard deviations in ssGBLUP (more stable)</li>
                                <li>Similar performance between weighted/non-weighted DP in BayesB</li>
                                <li>Information from ungenotyped relatives provides modest gain</li>
                            </ul>
                        </div>
                    </div>

                    <div class="analysis-card evolution-card">
                        <h3 class="analysis-title">Iteration Effects Analysis</h3>
                        <div class="analysis-content">
                            <p><strong>S1 vs S2 Comparison:</strong></p>
                            <ul>
                                <li>S1: Fixed animal effects, SNP effects only updated</li>
                                <li>S2: Both animal and SNP effects recomputed</li>
                                <li>S2 allows correction of small-effect SNPs</li>
                                <li>Optimal iteration number appears to be 2-3</li>
                            </ul>
                            
                            <p><strong>Convergence Patterns:</strong></p>
                            <ul>
                                <li>Rapid improvement in first 2 iterations</li>
                                <li>Stabilization or slight decline thereafter</li>
                                <li>Over-weighting of large effects in later rounds</li>
                                <li>Suggests need for convergence criteria</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- GWAS Power Analysis -->
            <div class="section">
                <h2 class="section-title">Detailed GWAS Power and Precision Analysis</h2>
                
                <div class="significance-box">
                    <h3 class="significance-title">Evaluation Methodology</h3>
                    <div class="significance-content">
                        <p><strong>Power Assessment:</strong> Correlation between true QTL effects and sum of m adjacent SNP effects, where m represents the window size around each QTL (m = 1, 2, 4, 8, 16, 40 SNPs).</p>
                        
                        <p><strong>Precision Assessment:</strong> Standard deviations of correlations across 10 replicates, indicating method stability and robustness.</p>
                        
                        <p><strong>Rationale for Window Approach:</strong> Single SNPs rarely capture full QTL effects due to recombination and linkage disequilibrium patterns. Optimal window size reflects balance between signal capture and noise inclusion.</p>
                    </div>
                </div>

                <div class="table-container">
                    <h3>Complete GWAS Power Results: ssGBLUP Scenarios</h3>
                    <table class="formulation-table">
                        <thead>
                            <tr>
                                <th>Scenario/Iteration</th>
                                <th>m=1</th>
                                <th>m=2</th>
                                <th>m=4</th>
                                <th>m=8</th>
                                <th>m=16</th>
                                <th>m=40</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="published-group">
                                <td><strong>S1 - Iteration 1</strong></td>
                                <td>0.53 (0.07)</td>
                                <td>0.68 (0.05)</td>
                                <td>0.79 (0.03)</td>
                                <td><strong>0.81 (0.02)</strong></td>
                                <td>0.80 (0.03)</td>
                                <td>0.62 (0.08)</td>
                            </tr>
                            <tr class="published-group">
                                <td><strong>S1 - Iteration 2</strong></td>
                                <td>0.46 (0.07)</td>
                                <td>0.66 (0.05)</td>
                                <td>0.78 (0.02)</td>
                                <td><strong>0.82 (0.02)</strong></td>
                                <td>0.81 (0.02)</td>
                                <td>0.63 (0.08)</td>
                            </tr>
                            <tr class="published-group">
                                <td><strong>S1 - Iteration 3</strong></td>
                                <td>0.43 (0.07)</td>
                                <td>0.64 (0.05)</td>
                                <td>0.77 (0.02)</td>
                                <td>0.81 (0.02)</td>
                                <td>0.80 (0.02)</td>
                                <td>0.62 (0.08)</td>
                            </tr>
                            <tr class="published-group">
                                <td><strong>S1 - Iteration 8</strong></td>
                                <td>0.41 (0.07)</td>
                                <td>0.62 (0.05)</td>
                                <td>0.75 (0.02)</td>
                                <td>0.80 (0.02)</td>
                                <td>0.79 (0.02)</td>
                                <td>0.60 (0.07)</td>
                            </tr>
                            <tr class="alternative-group">
                                <td><strong>S2 - Iteration 1</strong></td>
                                <td>0.53 (0.07)</td>
                                <td>0.68 (0.05)</td>
                                <td>0.79 (0.03)</td>
                                <td>0.81 (0.02)</td>
                                <td>0.80 (0.03)</td>
                                <td>0.62 (0.08)</td>
                            </tr>
                            <tr class="alternative-group">
                                <td><strong>S2 - Iteration 2</strong></td>
                                <td>0.44 (0.09)</td>
                                <td>0.65 (0.06)</td>
                                <td>0.77 (0.03)</td>
                                <td><strong>0.82 (0.03)</strong></td>
                                <td>0.81 (0.02)</td>
                                <td>0.63 (0.06)</td>
                            </tr>
                            <tr class="alternative-group">
                                <td><strong>S2 - Iteration 8</strong></td>
                                <td>0.40 (0.07)</td>
                                <td>0.60 (0.05)</td>
                                <td>0.71 (0.04)</td>
                                <td>0.75 (0.04)</td>
                                <td>0.76 (0.04)</td>
                                <td>0.63 (0.06)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="table-container">
                    <h3>Comparative GWAS Power: All Methods</h3>
                    <table class="performance-table">
                        <thead>
                            <tr>
                                <th>Method</th>
                                <th>m=1</th>
                                <th>m=2</th>
                                <th>m=4</th>
                                <th>m=8</th>
                                <th>m=16</th>
                                <th>m=40</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="high-pev-group">
                                <td><strong>ssGBLUP (S1, best)</strong></td>
                                <td>0.53 (0.07)</td>
                                <td>0.68 (0.05)</td>
                                <td>0.79 (0.03)</td>
                                <td><strong>0.82 (0.02)</strong></td>
                                <td>0.81 (0.02)</td>
                                <td>0.63 (0.08)</td>
                            </tr>
                            <tr class="low-pev-group">
                                <td><strong>BayesB (Non-weighted)</strong></td>
                                <td>0.48 (0.27)</td>
                                <td>0.65 (0.16)</td>
                                <td>0.78 (0.11)</td>
                                <td>0.82 (0.08)</td>
                                <td><strong>0.82 (0.07)</strong></td>
                                <td>0.66 (0.21)</td>
                            </tr>
                            <tr class="low-pev-group">
                                <td><strong>BayesB (Weighted, c=0.1)</strong></td>
                                <td>0.47 (0.25)</td>
                                <td>0.64 (0.16)</td>
                                <td>0.78 (0.10)</td>
                                <td>0.82 (0.08)</td>
                                <td><strong>0.83 (0.07)</strong></td>
                                <td>0.67 (0.21)</td>
                            </tr>
                            <tr class="new-group">
                                <td><strong>CGWAS (WOMBAT)</strong></td>
                                <td><strong>0.57 (0.14)</strong></td>
                                <td>0.68 (0.11)</td>
                                <td>0.73 (0.08)</td>
                                <td>0.74 (0.07)</td>
                                <td>0.73 (0.05)</td>
                                <td>0.63 (0.09)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="analysis-grid">
                    <div class="analysis-card theory-card">
                        <h3 class="analysis-title">Optimal Window Size Analysis</h3>
                        <div class="analysis-content">
                            <p><strong>ssGBLUP Patterns:</strong></p>
                            <ul>
                                <li>Peak performance at m=8 (correlation ~0.82)</li>
                                <li>Steady increase from m=1 to m=8</li>
                                <li>Decline for m=40 due to noise inclusion</li>
                                <li>Consistent pattern across scenarios and iterations</li>
                            </ul>
                            
                            <p><strong>Theoretical Basis:</strong></p>
                            <ul>
                                <li>Average SNP density: 0.067 cM (15 SNPs/cM)</li>
                                <li>Average QTL spacing: ~6.06 cM</li>
                                <li>8 SNPs ≈ 0.53 cM window optimal</li>
                                <li>Reflects linkage disequilibrium extent after 1000 generations</li>
                            </ul>
                        </div>
                    </div>

                    <div class="analysis-card detection-card">
                        <h3 class="analysis-title">Method Stability Comparison</h3>
                        <div class="analysis-content">
                            <p><strong>Standard Deviation Patterns:</strong></p>
                            <ul>
                                <li>ssGBLUP: 0.02-0.09 (very consistent)</li>
                                <li>BayesB: 0.07-0.27 (high variability)</li>
                                <li>CGWAS: 0.05-0.14 (intermediate stability)</li>
                                <li>BayesB sampling creates larger variance</li>
                            </ul>
                            
                            <p><strong>Practical Implications:</strong></p>
                            <ul>
                                <li>ssGBLUP provides more predictable results</li>
                                <li>Lower risk of extreme outcomes</li>
                                <li>Better suited for operational breeding programs</li>
                                <li>Reduced need for multiple analyses</li>
                            </ul>
                        </div>
                    </div>

                    <div class="analysis-card evolution-card">
                        <h3 class="analysis-title">Method-Specific Strengths</h3>
                        <div class="analysis-content">
                            <p><strong>CGWAS Advantages:</strong></p>
                            <ul>
                                <li>Best single-SNP detection (m=1: 0.57)</li>
                                <li>Suitable for identifying individual causative variants</li>
                                <li>Clear significance testing framework</li>
                                <li>Extremely fast computation</li>
                            </ul>
                            
                            <p><strong>BayesB Benefits:</strong></p>
                            <ul>
                                <li>Slightly higher peak correlations (0.83 at m=16)</li>
                                <li>Variable selection through π parameter</li>
                                <li>Accounts for unequal SNP variances</li>
                                <li>Established in genomic selection</li>
                            </ul>
                            
                            <p><strong>ssGBLUP Advantages:</strong></p>
                            <ul>
                                <li>Most stable and consistent results</li>
                                <li>Direct phenotype utilization</li>
                                <li>Computational efficiency</li>
                                <li>Flexibility for complex models</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Computational Performance Analysis -->
            <div class="section">
                <h2 class="section-title">Detailed Computational Performance</h2>
                
                <div class="coverage-stats">
                    <div class="stat-box">
                        <div class="stat-number">2</div>
                        <div class="stat-label">Minutes per<br>ssGBLUP iteration</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number">5</div>
                        <div class="stat-label">Hours for complete<br>BayesB analysis</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number">13</div>
                        <div class="stat-label">Seconds for<br>WOMBAT CGWAS</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number">150×</div>
                        <div class="stat-label">Speed advantage<br>vs BayesB</div>
                    </div>
                </div>

                <div class="comparison-grid">
                    <div class="comparison-box census-box">
                        <h3 class="comparison-title">Algorithmic Complexity Analysis</h3>
                        <div class="analysis-content">
                            <p><strong>ssGBLUP Complexity:</strong></p>
                            <ul>
                                <li>Linear with number of SNPs (M)</li>
                                <li>Cubic with number of genotyped animals (n³)</li>
                                <li>G⁻¹ computation dominates cost</li>
                                <li>Potential for sub-cubic with PCG methods</li>
                            </ul>
                            
                            <p><strong>Optimization Strategies:</strong></p>
                            <ul>
                                <li>Sparse matrix operations</li>
                                <li>Cholesky decomposition when applicable</li>
                                <li>Iterative solvers for large problems</li>
                                <li>Memory-efficient implementations</li>
                            </ul>
                        </div>
                    </div>

                    <div class="comparison-box dna-box">
                        <h3 class="comparison-title">Scalability Projections</h3>
                        <div class="analysis-content">
                            <p><strong>Current Implementation:</strong></p>
                            <ul>
                                <li>~1 minute for 7K genotypes</li>
                                <li>~1 hour for 30K genotypes</li>
                                <li>Scales approximately as n²·⁵</li>
                                <li>Memory requirements: O(n²)</li>
                            </ul>
                            
                            <p><strong>BayesB Scaling: