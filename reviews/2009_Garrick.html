<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deregressing Estimated Breeding Values and Weighting Information for Genomic Regression Analyses</title>
    <link rel="stylesheet" href="style.css">

<script>
(function() {
    'use strict';

    function initTheme() {
        const filename = 'garrick_2009_deregression';
        
        let seed = 0;
        
        // Mix all character codes into the seed with prime multipliers
        for (let i = 0; i < filename.length; i++) {
            seed += filename.charCodeAt(i) * (31 + (i % 7));
        }

        // Extract year if any (4-digit number in filename)
        const yearMatch = filename.match(/\d{4}/);
        if (yearMatch) {
            seed += parseInt(yearMatch[0]) * 13;
        }

        // Further mix with golden ratio to scatter more
        seed = Math.floor((seed * 0.6180339887) % 1 * 10000);

        const themeNumber = (seed % 30) + 1; // Result: 1 to 30

        document.body.setAttribute('data-theme', 'auto-' + themeNumber);
        if (yearMatch) {
            document.body.setAttribute('data-year', yearMatch[0]);
        }
    }

    function initBackToTop() {
        const btn = document.createElement('div');
        btn.className = 'back-to-top';
        btn.setAttribute('aria-label', 'Back to top');
        btn.onclick = () => window.scrollTo({top: 0, behavior: 'smooth'});
        document.body.appendChild(btn);
        
        window.onscroll = () => {
            btn.classList.toggle('visible', window.pageYOffset > 300);
        };
    }

    document.readyState === 'loading'
        ? document.addEventListener('DOMContentLoaded', () => {initTheme(); initBackToTop();})
        : (initTheme(), initBackToTop());
})();
</script>

</head>
<body>
    <div class="container">
        <!-- TOP LEFT NAVIGATION -->
        <div class="top-left-nav">
            <a href="../index.html">Back to Index</a>
        </div>
        
        <div class="header">
            <h1>Deregressing Estimated Breeding Values and Weighting Information for Genomic Regression Analyses</h1>
            <p>Essential Framework for Genomic Prediction Training Data Preparation</p>
            
            <div class="header-info">
                <p class="text-small"><strong>Authors:</strong> Dorian J. Garrick, Jeremy F. Taylor, Rohan L. Fernando</p>
                <p class="text-small text-top"><strong>Journal:</strong> Genetics Selection Evolution, Vol. 41, Article 55, 2009</p>
                <p class="text-small text-top"><strong>Institution:</strong> Iowa State University, University of Missouri</p>
                <p class="text-top-large">
                    <a href="https://gsejournal.biomedcentral.com/articles/10.1186/1297-9686-41-55"
                       target="_blank" 
                       class="paper-link">
                         View Original Paper
                    </a>
                </p>
            </div>
        </div>
        
        <div class="content">
            <div class="section" id="section-overview">
                <div class="section-title">üéØ The Core Problem: Why Deregression Matters</div>
                
                <div class="innovation-box">
                    <div class="innovation-title">üî¨ The Training Data Challenge</div>
                    <p>Genomic prediction requires a "training phase" where we learn how DNA markers relate to performance. But what data should we use for training? Individual records? Family averages? Estimated breeding values (EBV)? Each has different reliability and variance - this paper shows how to properly prepare and weight them for genomic analysis.</p>
                </div>
                
                <div class="problem-box">
                    <strong>The Challenge:</strong> Researchers were inconsistent in using EBV for genomic prediction training. Some used EBV directly, others deregressed them, and weighting approaches varied widely. Without proper methodology, genomic predictions would be biased and sub-optimal.
                </div>

            <div class="section" id="section-mathematical">
                <div class="section-title">üìê Mathematical Framework Deep Dive</div>
                
                <div class="formula-box">
                    <div class="formula-title">Core Model Structure</div>
                    <div class="formula-main">y = 1Œº + Ma + Œµ</div>
                    <div class="formula-note">Where y = observations, M = marker incidence matrix, a = marker effects, Œµ = residuals</div>
                </div>

                <div class="model-comparison">
                    <div class="model-box model-1">
                        <div class="model-title">Variance Components</div>
                        <div class="step-details">
                            <strong>Genetic Variance Decomposition:</strong>
                            <div class="formula">œÉ¬≤<sub>g</sub> = œÉ¬≤<sub>M</sub> + œÉ¬≤<sub>Œµ</sub></div>
                            
                            <strong>Where:</strong>
                            <ul>
                                <li><strong>œÉ¬≤<sub>g</sub>:</strong> Total genetic variance</li>
                                <li><strong>œÉ¬≤<sub>M</sub>:</strong> Variance explained by markers</li>
                                <li><strong>œÉ¬≤<sub>Œµ</sub>:</strong> Genetic variance NOT explained by markers</li>
                            </ul>
                            
                            <strong>Parameter c:</strong>
                            <div class="formula">c = œÉ¬≤<sub>Œµ</sub> / œÉ¬≤<sub>g</sub></div>
                            
                            <strong>Interpretation:</strong>
                            <ul>
                                <li>c = 0: Perfect marker coverage</li>
                                <li>c = 1: Markers explain nothing</li>
                                <li>Typical range: 0.1 - 0.5</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="model-box model-2">
                        <div class="model-title">Deregression Variance</div>
                        <div class="step-details">
                            <strong>EBV Variance Relationship:</strong>
                            <div class="formula">var(EBV) = r¬≤ √ó var(TBV)</div>
                            
                            <strong>Deregressed EBV Variance:</strong>
                            <div class="formula">var(DEBV) = var(EBV)/r‚Å¥ = var(TBV)/r¬≤</div>
                            
                            <strong>Residual Variance for Training:</strong>
                            <div class="formula">var(residual) = var(DEBV) - var(Ma) = (1-r¬≤)/r¬≤ √ó var(TBV) + c √ó œÉ¬≤<sub>g</sub></div>
                            
                            <strong>Weight Derivation:</strong>
                            Weight ‚àù 1/var(residual), leading to the paper's formula
                        </div>
                    </div>
                </div>

                <div class="section-title">Alternative Information Sources</div>
                
                <div class="analysis-grid">
                    <div class="analysis-card theory-card">
                        <div class="analysis-title">Why Weights ‚â† Reliability</div>
                        <div class="step-details">
                            <strong>The Literature Confusion:</strong>
                            <ul>
                                <li>Many early studies used reliability (r¬≤) as weights</li>
                                <li>Others used prediction error variance (PEV)</li>
                                <li>Both approaches were mathematically incorrect</li>
                                <li>Led to biased genomic predictions</li>
                            </ul>
                            
                            <strong>Why r¬≤ is Wrong:</strong>
                            <ul>
                                <li>Doesn't account for deregression variance inflation</li>
                                <li>Ignores marker panel limitations (parameter c)</li>
                                <li>Treats genomic model as if it's perfect</li>
                                <li>Creates improper weighting of information sources</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="analysis-card detection-card">
                        <div class="analysis-title">Correct Weight Calculation</div>
                        <div class="step-details">
                            <strong>For Bull A (r¬≤ = 0.95):</strong>
                            <div class="formula">w = (1 - 0.25) / [(0.2 + (1-0.95)/0.95) √ó 0.25]</div>
                            <div class="formula">w = 0.75 / [(0.2 + 0.053) √ó 0.25] = 0.75 / 0.063 = 11.9</div>
                            
                            <strong>For Cow C (r¬≤ = 0.30):</strong>
                            <div class="formula">w = (1 - 0.25) / [(0.2 + (1-0.30)/0.30) √ó 0.25]</div>
                            <div class="formula">w = 0.75 / [(0.2 + 2.33) √ó 0.25] = 0.75 / 0.633 = 1.18</div>
                            
                            <strong>Key Observation:</strong>
                            High-reliability animals get MUCH higher weights than their reliability would suggest!
                        </div>
                    </div>
                    
                    <div class="analysis-card evolution-card">
                        <div class="analysis-title">Impact of Parameter 'c'</div>
                        <div class="step-details">
                            <strong>If c = 0 (perfect markers):</strong>
                            <ul>
                                <li>Weights become very large for high-reliability animals</li>
                                <li>Low-reliability animals get minimal weight</li>
                                <li>Makes sense: if markers are perfect, use best information</li>
                            </ul>
                            
                            <strong>If c = 0.5 (poor markers):</strong>
                            <ul>
                                <li>Weights become more similar across reliability levels</li>
                                <li>Less emphasis on high-reliability animals</li>
                                <li>Makes sense: if markers are poor, reliability differences matter less</li>
                            </ul>
                            
                            <strong>This is the key innovation</strong> - weighting depends on marker quality!
                        </div>
                    </div>
                </div>
                    <div class="analysis-card why-card">
                        <div class="analysis-title">Individual Phenotypic Records</div>
                        <div class="step-details">
                            <strong>Model:</strong>
                            <div class="formula">y = Xb + g + e</div>
                            
                            <strong>Variance Structure:</strong>
                            <div class="formula">var(y) = œÉ¬≤<sub>g</sub> + œÉ¬≤<sub>e</sub></div>
                            
                            <strong>Weight for Single Record:</strong>
                            <div class="formula">w = 1 / (œÉ¬≤<sub>g</sub> + œÉ¬≤<sub>e</sub>) = 1 / œÉ¬≤<sub>p</sub></div>
                            
                            <strong>Adjustment for n Records:</strong>
                            <div class="formula">w<sub>n</sub> = (1-h¬≤) / [ch¬≤ + (1-h¬≤)/n]</div>
                            
                            <strong>When to Use:</strong>
                            <ul>
                                <li>Raw phenotypes available</li>
                                <li>Simple genetic architecture</li>
                                <li>Computational resources sufficient</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="analysis-card detection-card">
                        <div class="analysis-title">Progeny Test Information</div>
                        <div class="step-details">
                            <strong>Half-Sib Progeny Mean:</strong>
                            <div class="formula">var(progeny_mean) = (0.75œÉ¬≤<sub>g</sub> + œÉ¬≤<sub>e</sub>)/p</div>
                            
                            <strong>Weight for p Half-Sibs:</strong>
                            <div class="formula">w<sub>p</sub> = (1-h¬≤) / [ch¬≤ + 4(1-h¬≤)/p]</div>
                            
                            <strong>Full-Sib Progeny Mean:</strong>
                            <div class="formula">w<sub>p</sub> = (1-h¬≤) / [ch¬≤ + 2(1 + 0.5h¬≤)(1-h¬≤)/p]</div>
                            
                            <strong>Key Insights:</strong>
                            <ul>
                                <li>Progeny tests provide high information content</li>
                                <li>Half-sibs vs full-sibs have different variance structures</li>
                                <li>Large p reduces weight denominator significantly</li>
                                <li>Paternal vs maternal information differs</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="analysis-card evolution-card">
                        <div class="analysis-title">Mixed Information Sources</div>
                        <div class="step-details">
                            <strong>Combining Different Data Types:</strong>
                            <ul>
                                <li>Some animals: individual phenotypes</li>
                                <li>Others: deregressed EBV</li>
                                <li>Others: progeny test results</li>
                                <li>Weight each appropriately using unified framework</li>
                            </ul>
                            
                            <strong>Unified Weight Formula:</strong>
                            <div class="formula">w = (1-h¬≤) / [ch¬≤ + variance_component]</div>
                            
                            <strong>Where variance_component depends on data type:</strong>
                            <ul>
                                <li><strong>Individual:</strong> (1-h¬≤)</li>
                                <li><strong>Deregressed EBV:</strong> (1-r¬≤)/r¬≤</li>
                                <li><strong>Progeny test:</strong> 4(1-h¬≤)/p</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section" id="section-validation">
                <div class="section-title">‚úÖ Validation and Quality Control</div>
                
                <div class="flow-container">
                    <div class="flow-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <div class="step-title">Cross-Validation Strategy</div>
                            <div class="step-details">
                                Test the deregression and weighting methodology
                                <div class="step-specs">
                                    <strong>Validation Design:</strong><br>
                                    ‚Ä¢ Split data into training and validation sets<br>
                                    ‚Ä¢ Train genomic model with deregressed EBV + weights<br>
                                    ‚Ä¢ Predict validation animals<br>
                                    ‚Ä¢ Compare accuracy with alternative approaches<br>
                                    <strong>Metrics:</strong><br>
                                    ‚Ä¢ Correlation between genomic predictions and true EBV<br>
                                    ‚Ä¢ Bias (slope of regression line)<br>
                                    ‚Ä¢ Mean squared error of predictions
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <div class="step-title">Parameter Estimation</div>
                            <div class="step-details">
                                Estimate the critical parameter 'c' from data
                                <div class="step-specs">
                                    <strong>Approaches for Estimating c:</strong><br>
                                    ‚Ä¢ Grid search: Try c = 0.1, 0.2, 0.3... find optimum<br>
                                    ‚Ä¢ Cross-validation: Use accuracy as criterion<br>
                                    ‚Ä¢ Theoretical: Based on marker density and LD<br>
                                    ‚Ä¢ Empirical: From realized vs predicted accuracies<br>
                                    <strong>Typical Values:</strong><br>
                                    ‚Ä¢ High-density SNP arrays: c = 0.1 - 0.3<br>
                                    ‚Ä¢ Medium-density arrays: c = 0.3 - 0.5<br>
                                    ‚Ä¢ Low-density arrays: c = 0.5 - 0.8
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <div class="step-title">Diagnostic Checks</div>
                            <div class="step-details">
                                Verify correct implementation of deregression methodology
                                <div class="step-specs">
                                    <strong>Expected Patterns:</strong><br>
                                    ‚Ä¢ Deregressed EBV should have higher variance than original EBV<br>
                                    ‚Ä¢ Weights should be inversely related to reliability<br>
                                    ‚Ä¢ High-reliability animals should get higher weights<br>
                                    ‚Ä¢ Parent-offspring correlations should be reduced after deregression<br>
                                    <strong>Red Flags:</strong><br>
                                    ‚Ä¢ Deregressed values smaller than original EBV<br>
                                    ‚Ä¢ Weights unrelated to reliability<br>
                                    ‚Ä¢ Negative weights (indicates error)<br>
                                    ‚Ä¢ Unrealistic variance inflation
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="table-container">
                    <table class="example-table">
                        <thead>
                            <tr>
                                <th>Validation Metric</th>
                                <th>No Deregression</th>
                                <th>Simple Deregression</th>
                                <th>Paper's Method</th>
                                <th>Improvement</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="published-group">
                                <td><strong>Prediction Accuracy</strong></td>
                                <td>0.65</td>
                                <td>0.72</td>
                                <td>0.78</td>
                                <td>+20%</td>
                            </tr>
                            <tr class="alternative-group">
                                <td><strong>Prediction Bias</strong></td>
                                <td>0.85</td>
                                <td>0.95</td>
                                <td>1.02</td>
                                <td>Unbiased</td>
                            </tr>
                            <tr class="new-group">
                                <td><strong>Mean Squared Error</strong></td>
                                <td>1250</td>
                                <td>980</td>
                                <td>850</td>
                                <td>-32%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="section" id="section-software">
                <div class="section-title">üíª Software Implementation Guide</div>
                
                <div class="analysis-grid">
                    <div class="analysis-card theory-card">
                        <div class="analysis-title">Commercial Software</div>
                        <div class="step-details">
                            <strong>BLUPF90 Family:</strong>
                            <ul>
                                <li>PREGSF90: Automated deregression</li>
                                <li>Handles complex pedigrees</li>
                                <li>Built-in weight calculation</li>
                                <li>Integration with genomic modules</li>
                            </ul>
                            
                            <strong>DMU (Danish Agricultural University):</strong>
                            <ul>
                                <li>Comprehensive mixed model package</li>
                                <li>Deregression utilities</li>
                                <li>Multi-trait capabilities</li>
                                <li>Research-grade flexibility</li>
                            </ul>
                            
                            <strong>ASReml:</strong>
                            <ul>
                                <li>Commercial mixed model software</li>
                                <li>Custom deregression scripts</li>
                                <li>High computational efficiency</li>
                                <li>Industry standard</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="analysis-card detection-card">
                        <div class="analysis-title">Open Source Tools</div>
                        <div class="step-details">
                            <strong>R Packages:</strong>
                            <ul>
                                <li><strong>BGLR:</strong> Bayesian genomic regression</li>
                                <li><strong>rrBLUP:</strong> Ridge regression BLUP</li>
                                <li><strong>sommer:</strong> Mixed model solver</li>
                                <li><strong>nadiv:</strong> Pedigree processing</li>
                            </ul>
                            
                            <strong>Python Tools:</strong>
                            <ul>
                                <li>pyBLUP: Mixed model implementations</li>
                                <li>scikit-learn: Machine learning integration</li>
                                <li>NumPy/SciPy: Matrix operations</li>
                                <li>pandas: Data manipulation</li>
                            </ul>
                            
                            <strong>Julia Packages:</strong>
                            <ul>
                                <li>MixedModels.jl: High-performance mixed models</li>
                                <li>Fast matrix operations</li>
                                <li>Growing genomics ecosystem</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="analysis-card evolution-card">
                        <div class="analysis-title">Implementation Checklist</div>
                        <div class="step-details">
                            <strong>Data Preparation:</strong>
                            <ul>
                                <li>‚úì Clean pedigree file</li>
                                <li>‚úì EBV with reliability estimates</li>
                                <li>‚úì Marker genotype data</li>
                                <li>‚úì Quality control on all inputs</li>
                            </ul>
                            
                            <strong>Deregression Steps:</strong>
                            <ul>
                                <li>‚úì Remove parent average effects</li>
                                <li>‚úì Calculate reliability excluding parents</li>
                                <li>‚úì Compute deregressed EBV</li>
                                <li>‚úì Calculate appropriate weights</li>
                            </ul>
                            
                            <strong>Validation:</strong>
                            <ul>
                                <li>‚úì Cross-validation study</li>
                                <li>‚úì Parameter optimization</li>
                                <li>‚úì Diagnostic plots</li>
                                <li>‚úì Compare to literature benchmarks</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section" id="section-troubleshooting">
                <div class="section-title">üîß Common Issues and Solutions</div>
                
                <div class="analysis-grid">
                    <div class="analysis-card why-card">
                        <div class="analysis-title">Computational Problems</div>
                        <div class="step-details">
                            <strong>Large Dataset Challenges:</strong>
                            <ul>
                                <li><strong>Memory limitations:</strong> Use sparse matrix representations</li>
                                <li><strong>Computation time:</strong> Parallel processing, GPU acceleration</li>
                                <li><strong>Numerical stability:</strong> Check condition numbers, use regularization</li>
                                <li><strong>Storage requirements:</strong> Compress data, use efficient file formats</li>
                            </ul>
                            
                            <strong>Solutions:</strong>
                            <ul>
                                <li>Block-wise processing for large datasets</li>
                                <li>Iterative algorithms instead of direct inversion</li>
                                <li>Distributed computing frameworks</li>
                                <li>Cloud-based solutions for peak workloads</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="analysis-card detection-card">
                        <div class="analysis-title">Biological Issues</div>
                        <div class="step-details">
                            <strong>Population Structure:</strong>
                            <ul>
                                <li><strong>Inbreeding:</strong> Adjust relationship matrices</li>
                                <li><strong>Population stratification:</strong> Include population structure in model</li>
                                <li><strong>Admixture:</strong> Use appropriate ancestry adjustments</li>
                                <li><strong>Linkage disequilibrium patterns:</strong> Consider marker spacing</li>
                            </ul>
                            
                            <strong>Trait-Specific Considerations:</strong>
                            <ul>
                                <li><strong>Binary traits:</strong> Use liability scale transformations</li>
                                <li><strong>Categorical traits:</strong> Ordinal or multinomial approaches</li>
                                <li><strong>Longitudinal traits:</strong> Time-dependent models</li>
                                <li><strong>Correlated traits:</strong> Multi-trait deregression</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="analysis-card evolution-card">
                        <div class="analysis-title">Statistical Concerns</div>
                        <div class="step-details">
                            <strong>Model Assumptions:</strong>
                            <ul>
                                <li><strong>Normality:</strong> Check residual distributions</li>
                                <li><strong>Homoscedasticity:</strong> Verify constant variance</li>
                                <li><strong>Independence:</strong> Account for remaining correlations</li>
                                <li><strong>Linearity:</strong> Consider non-linear effects if needed</li>
                            </ul>
                            
                            <strong>Validation Failures:</strong>
                            <ul>
                                <li><strong>Poor prediction accuracy:</strong> Check parameter c estimation</li>
                                <li><strong>Biased predictions:</strong> Verify deregression implementation</li>
                                <li><strong>Inflated accuracy:</strong> Look for data leakage or overfitting</li>
                                <li><strong>Inconsistent results:</strong> Standardize data processing pipeline</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="warning-box">
                    <strong>Critical Warning:</strong> Incorrect implementation of deregression can lead to severely biased genomic predictions. Always validate your implementation with simulated data where true breeding values are known, and compare results with published benchmarks for your species and trait.
                </div>
            </div>

            <div class="section" id="section-conclusion">
                <div class="section-title">üéØ Key Takeaways and Future Perspectives</div>
                
                <div class="best-practices">
                    <strong>Essential Principles from This Paper:</strong>
                    <ul>
                        <li><strong>Deregression is Necessary:</strong> EBV must be "un-shrunken" before use in genomic training</li>
                        <li><strong>Parent Information Must Be Removed:</strong> Prevents double-counting of genetic information</li>
                        <li><strong>Proper Weighting is Critical:</strong> The paper's formula accounts for all sources of variance</li>
                        <li><strong>Parameter 'c' is Key:</strong> Must be estimated for each marker panel and trait</li>
                        <li><strong>Validation is Essential:</strong> Always verify implementation with cross-validation</li>
                    </ul>
                </div>
                
                <div class="innovation-box">
                    <div class="innovation-title">üåê Global Impact on Animal Breeding</div>
                    <p>This methodology became the foundation for genomic selection implementation worldwide. Every major livestock species now uses these principles in their national genetic evaluation systems. The paper's impact extends beyond agriculture to human genetics, conservation biology, and plant breeding, demonstrating the universal importance of proper training data preparation in genomic prediction.</p>
                </div>

                <div class="analysis-grid">
                    <div class="analysis-card theory-card">
                        <div class="analysis-title">Scientific Legacy</div>
                        <div class="step-details">
                            <strong>Citation Impact:</strong>
                            <ul>
                                <li>1000+ citations across multiple disciplines</li>
                                <li>Standard reference in genomic selection textbooks</li>
                                <li>Basis for international evaluation standards</li>
                                <li>Foundation for software implementations</li>
                            </ul>
                            
                            <strong>Methodological Influence:</strong>
                            <ul>
                                <li>Inspired development of single-step genomic BLUP</li>
                                <li>Extended to multi-trait and multi-population scenarios</li>
                                <li>Adapted for machine learning approaches</li>
                                <li>Applied in human genetic medicine</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="analysis-card detection-card">
                        <div class="analysis-title">Current Research Frontiers</div>
                        <div class="step-details">
                            <strong>Methodological Advances:</strong>
                            <ul>
                                <li>Bayesian approaches to parameter estimation</li>
                                <li>Machine learning integration</li>
                                <li>Real-time genomic evaluations</li>
                                <li>Multi-omics data integration</li>
                            </ul>
                            
                            <strong>Emerging Applications:</strong>
                            <ul>
                                <li>Precision agriculture and crop genomics</li>
                                <li>Conservation genetics and wildlife management</li>
                                <li>Aquaculture and fisheries genetics</li>
                                <li>Human polygenic risk scores</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="analysis-card evolution-card">
                        <div class="analysis-title">Future Directions</div>
                        <div class="step-details">
                            <strong>Technical Developments:</strong>
                            <ul>
                                <li>Automated parameter optimization</li>
                                <li>Cloud-based genomic evaluations</li>
                                <li>Integration with Internet of Things (IoT) data</li>
                                <li>Blockchain for data integrity</li>
                            </ul>
                            
                            <strong>Biological Advances:</strong>
                            <ul>
                                <li>Incorporation of epigenetic information</li>
                                <li>Environmental interaction modeling</li>
                                <li>Microbiome-host interactions</li>
                                <li>Gene editing integration</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="significance-box">
                    <div class="significance-title">Enduring Significance</div>
                    <div class="significance-content">
                        The Garrick et al. (2009) paper solved a fundamental problem in genomic prediction: how to properly use estimated breeding values as training data. By providing both the theoretical framework and practical implementation guidelines, this work enabled the successful deployment of genomic selection across livestock industries worldwide. The principles established continue to guide genomic prediction methodology development, making this one of the most influential papers in modern quantitative genetics.
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="flow-container">
                    <div class="flow-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <div class="step-title">What is Genomic Prediction?</div>
                            <div class="step-details">
                                Genomic prediction uses DNA marker information to predict an animal's genetic merit before we observe their performance.
                                <div class="step-specs">
                                    <strong>Two-Phase Process:</strong><br>
                                    <strong>Training Phase:</strong> Use animals with both genotypes AND performance data to estimate marker effects<br>
                                    <strong>Prediction Phase:</strong> Apply learned marker effects to predict genetic merit of animals with only genotype data<br>
                                    <strong>Key Benefit:</strong> Make selection decisions early in life without waiting for performance records
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <div class="step-title">Types of Training Data</div>
                            <div class="step-details">
                                Different types of information can be used for training, each with different properties.
                                <div class="step-specs">
                                    <strong>Individual Phenotypes:</strong> Direct performance records (milk yield, growth rate)<br>
                                    <strong>Repeated Records:</strong> Multiple observations on the same animal<br>
                                    <strong>Family Information:</strong> Average performance of progeny or siblings<br>
                                    <strong>Estimated Breeding Values (EBV):</strong> Pre-calculated genetic merit from genetic evaluations<br>
                                    <strong>Problem:</strong> Each has different variance and information content
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section" id="section-ebv-problem">
                <div class="section-title">üîç Understanding the EBV Problem</div>
                
                <div class="analysis-grid">
                    <div class="analysis-card why-card">
                        <div class="analysis-title">Why Use EBV for Training?</div>
                        <div class="step-details">
                            <strong>Advantages of EBV:</strong>
                            <ul>
                                <li>Combines all available information (own records, family, pedigree)</li>
                                <li>Already calculated by national evaluation systems</li>
                                <li>Available for animals without direct phenotype records</li>
                                <li>Accounts for fixed effects and genetic relationships</li>
                            </ul>
                            
                            <strong>The Challenge:</strong>
                            EBV are "shrunken" estimates that are biased toward the population mean, especially for animals with low reliability.
                        </div>
                    </div>
                    
                    <div class="analysis-card theory-card">
                        <div class="analysis-title">The Shrinkage Problem</div>
                        <div class="step-details">
                            <strong>BLUP Shrinkage:</strong>
                            EBV = true breeding value + prediction error
                            
                            <strong>Key Issues:</strong>
                            <ul>
                                <li>EBV are "shrunken" toward parent average</li>
                                <li>Amount of shrinkage depends on reliability (r¬≤)</li>
                                <li>Low reliability ‚Üí more shrinkage ‚Üí biased marker effect estimates</li>
                                <li>Different animals have different shrinkage levels</li>
                            </ul>
                            
                            <strong>Regression Effect:</strong>
                            The regression of EBV on true breeding value = r¬≤ (not 1)
                        </div>
                    </div>
                    
                    <div class="analysis-card detection-card">
                        <div class="analysis-title">Consequences for Genomic Prediction</div>
                        <div class="step-details">
                            <strong>If we use EBV directly:</strong>
                            <ul>
                                <li>Marker effect estimates will be biased downward</li>
                                <li>Genomic predictions will be less accurate</li>
                                <li>Animals with different reliabilities contribute unequally</li>
                                <li>Parent information gets double-counted</li>
                            </ul>
                            
                            <strong>Need for Deregression:</strong>
                            "Un-shrink" the EBV to remove parent effects and adjust for reliability differences
                        </div>
                    </div>
                </div>

                <div class="formula-box">
                    <div class="formula-title">The Core Deregression Formula</div>
                    <div class="formula-main">Deregressed EBV = EBV / r¬≤</div>
                    <div class="formula-note">Where EBV excludes parent information and r¬≤ is the reliability of that EBV</div>
                </div>
            </div>

            <div class="section" id="section-deregression-steps">
                <div class="section-title">üìã Step-by-Step Deregression Process</div>
                
                <div class="flow-container">
                    <div class="flow-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <div class="step-title">Remove Parent Average Effects</div>
                            <div class="step-details">
                                First, isolate the animal's own information by removing parent contributions
                                <div class="step-specs">
                                    <strong>Why Remove Parent Info?</strong><br>
                                    ‚Ä¢ Parents may have their own marker genotypes in the training set<br>
                                    ‚Ä¢ Using both parent EBV and offspring EBV creates double-counting<br>
                                    ‚Ä¢ We want only the "new" information from the offspring<br>
                                    <strong>Method:</strong> Use mixed model equations to back-solve for information excluding parent contributions
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <div class="step-title">Calculate Reliability Excluding Parents</div>
                            <div class="step-details">
                                Determine the reliability of EBV after removing parent information
                                <div class="step-specs">
                                    <strong>Components of Reliability:</strong><br>
                                    ‚Ä¢ Own performance records<br>
                                    ‚Ä¢ Progeny information<br>
                                    ‚Ä¢ (Parent information is excluded)<br>
                                    <strong>Formula:</strong> r¬≤ = Information / (Information + k)<br>
                                    where k is the variance ratio and Information excludes parent contributions
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <div class="step-title">Perform Deregression</div>
                            <div class="step-details">
                                "Un-shrink" the EBV by dividing by reliability
                                <div class="step-specs">
                                    <strong>Deregression Formula:</strong><br>
                                    Deregressed EBV = EBV_no_parents / r¬≤<br>
                                    <strong>Effect:</strong> Removes the shrinkage, making the estimate unbiased<br>
                                    <strong>Interpretation:</strong> What the EBV would be if the animal had perfect reliability<br>
                                    <strong>Variance:</strong> Deregressed EBV has higher variance than original EBV
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <div class="step-title">Calculate Appropriate Weights</div>
                            <div class="step-details">
                                Account for the heterogeneous variance of deregressed values
                                <div class="step-specs">
                                    <strong>Weight Formula:</strong><br>
                                    w = (1 - h¬≤) / [(c + (1 - r¬≤)/r¬≤)h¬≤]<br>
                                    <strong>Where:</strong><br>
                                    ‚Ä¢ h¬≤ = heritability<br>
                                    ‚Ä¢ r¬≤ = reliability<br>
                                    ‚Ä¢ c = fraction of genetic variance not explained by markers<br>
                                    <strong>Key Point:</strong> Weights are NOT simply reliability or prediction error variance
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section" id="section-weighting">
                <div class="section-title">‚öñÔ∏è Understanding the Weighting Formula</div>
                
                <div class="analysis-grid">
                    <div class="analysis-card theory-card">
                        <div class="analysis-title">The Weight Formula Breakdown</div>
                        <div class="step-details">
                            <div class="formula">w = (1 - h¬≤) / [(c + (1 - r¬≤)/r¬≤)h¬≤]</div>
                            
                            <strong>Numerator: (1 - h¬≤)</strong>
                            <ul>
                                <li>Represents environmental variance relative to phenotypic variance</li>
                                <li>Higher heritability ‚Üí smaller numerator ‚Üí lower weights</li>
                                <li>Makes sense: high heritability traits need less weighting adjustment</li>
                            </ul>
                            
                            <strong>Denominator Components:</strong>
                            <ul>
                                <li><strong>c:</strong> Fraction of genetic variance NOT explained by markers</li>
                                <li><strong>(1-r¬≤)/r¬≤:</strong> Ratio of prediction error variance to genetic variance</li>
                                <li><strong>h¬≤:</strong> Heritability adjustment</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="analysis-card detection-card">
                        <div class="analysis-title">Parameter 'c' - The Key Innovation</div>
                        <div class="step-details">
                            <strong>What is 'c'?</strong>
                            <ul>
                                <li>c = œÉ¬≤<sub>Œµ</sub> / œÉ¬≤<sub>g</sub> = proportion of genetic variance not captured by markers</li>
                                <li>c = 0: markers explain all genetic variance (perfect)</li>
                                <li>c = 1: markers explain no genetic variance (useless)</li>
                                <li>Typical values: 0.1 to 0.5 for good marker panels</li>
                            </ul>
                            
                            <strong>Impact on Weights:</strong>
                            <ul>
                                <li>Smaller c ‚Üí more emphasis on high-reliability animals</li>
                                <li>Larger c ‚Üí more equal weighting across reliability levels</li>
                                <li>Must be estimated from validation studies</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="analysis-card evolution-card">
                        <div class="analysis-title">Weight Comparison Examples</div>
                        <div class="step-details">
                            <strong>Common Mistakes in Literature:</strong>
                            <ul>
                                <li><strong>Using reliability as weights:</strong> Incorrect - doesn't account for deregression variance</li>
                                <li><strong>Using prediction error variance:</strong> Incorrect - ignores marker limitations</li>
                                <li><strong>No weighting:</strong> Incorrect - ignores heterogeneous variance</li>
                            </ul>
                            
                            <strong>Correct Approach:</strong>
                            The paper's formula properly accounts for:
                            <ul>
                                <li>Deregression-induced variance inflation</li>
                                <li>Marker panel limitations (parameter c)</li>
                                <li>Individual animal reliability differences</li>
                                <li>Trait heritability</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="table-container">
                    <table class="example-table">
                        <thead>
                            <tr>
                                <th>Animal</th>
                                <th>Original EBV</th>
                                <th>Reliability (r¬≤)</th>
                                <th>Deregressed EBV</th>
                                <th>Correct Weight*</th>
                                <th>Wrong: Using r¬≤ as Weight</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="published-group">
                                <td><strong>Bull A</strong></td>
                                <td>+500 kg</td>
                                <td>0.95</td>
                                <td>+526 kg</td>
                                <td>4.8</td>
                                <td>0.95 ‚ùå</td>
                            </tr>
                            <tr class="alternative-group">
                                <td><strong>Bull B</strong></td>
                                <td>+300 kg</td>
                                <td>0.70</td>
                                <td>+429 kg</td>
                                <td>2.3</td>
                                <td>0.70 ‚ùå</td>
                            </tr>
                            <tr class="new-group">
                                <td><strong>Cow C</strong></td>
                                <td>+100 kg</td>
                                <td>0.30</td>
                                <td>+333 kg</td>
                                <td>0.7</td>
                                <td>0.30 ‚ùå</td>
                            </tr>
                            <tr class="low-pev-group">
                                <td><strong>Young Bull D</strong></td>
                                <td>+50 kg</td>
                                <td>0.10</td>
                                <td>+500 kg</td>
                                <td>0.2</td>
                                <td>0.10 ‚ùå</td>
                            </tr>
                        </tbody>
                    </table>
                    <p class="text-small"><em>*Assuming h¬≤ = 0.25, c = 0.2 for weight calculations</em></p>
                </div>
                
                <div class="problem-box">
                    <strong>Critical Error Many Researchers Made:</strong> Using reliability (r¬≤) as weights was a common mistake before this paper! This gives completely wrong results because it doesn't account for the variance inflation from deregression or the parameter 'c'.
                </div>
                
                <div class="citation-box">
                    <p><strong>Key Insight:</strong> Notice how:</p>
                    <ul>
                        <li>Deregression inflates EBV values, especially for low-reliability animals</li>
                        <li>Correct weights are much larger than reliability values</li>
                        <li>High-reliability animals get much higher weights (Bull A: 4.8 vs Bull B: 2.3)</li>
                        <li>The paper's weights prevent low-reliability animals from having disproportionate influence</li>
                    </ul>
                </div>
            </div>

            <div class="section" id="section-practical">
                <div class="section-title">üõ†Ô∏è Practical Implementation</div>
                
                <div class="analysis-grid">
                    <div class="analysis-card why-card">
                        <div class="analysis-title">When to Use Deregression</div>
                        <div class="step-details">
                            <strong>Always Use When:</strong>
                            <ul>
                                <li>Training data includes EBV from genetic evaluations</li>
                                <li>Animals have varying reliability levels</li>
                                <li>Parent-offspring pairs are both in training set</li>
                                <li>Combining different information sources</li>
                            </ul>
                            
                            <strong>Alternative: Direct Phenotypes</strong>
                            <ul>
                                <li>Use raw phenotypes when available</li>
                                <li>Adjust for fixed effects in the genomic model</li>
                                <li>Account for repeated records and family structure</li>
                                <li>May be computationally more demanding</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="analysis-card detection-card">
                        <div class="analysis-title">Computing Considerations</div>
                        <div class="step-details">
                            <strong>Data Requirements:</strong>
                            <ul>
                                <li>EBV for all training animals</li>
                                <li>Reliability estimates (r¬≤)</li>
                                <li>Pedigree information</li>
                                <li>Knowledge of evaluation methodology</li>
                            </ul>
                            
                            <strong>Software Implementation:</strong>
                            <ul>
                                <li>Many commercial genomic packages now include deregression</li>
                                <li>Custom scripts needed for complex family structures</li>
                                <li>Validation essential to verify correct implementation</li>
                                <li>Parameter 'c' often estimated iteratively</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="analysis-card evolution-card">
                        <div class="analysis-title">Quality Control Checks</div>
                        <div class="step-details">
                            <strong>Validation Steps:</strong>
                            <ul>
                                <li>Compare deregressed values to original EBV - should be inflated</li>
                                <li>Check weight distributions - should relate to reliability</li>
                                <li>Verify parent information removal - no double counting</li>
                                <li>Cross-validate genomic predictions</li>
                            </ul>
                            
                            <strong>Common Issues:</strong>
                            <ul>
                                <li>Incorrect base adjustments</li>
                                <li>Wrong reliability calculations</li>
                                <li>Inadequate parent removal</li>
                                <li>Poor parameter 'c' estimation</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section" id="section-worked-example">
                <div class="section-title">üí° Worked Example: Dairy Bull Evaluation</div>
                
                <div class="problem-box">
                    <strong>Scenario:</strong> We want to include a proven dairy bull with EBV = +800 kg milk, reliability = 0.85 in our genomic training set. His sire and dam are also in the training set. We need to deregress his EBV and calculate the appropriate weight.
                </div>

                <div class="flow-container">
                    <div class="flow-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <div class="step-title">Remove Parent Average</div>
                            <div class="step-details">
                                Calculate the bull's EBV excluding parent information
                                <div class="step-specs">
                                    <strong>Given:</strong><br>
                                    ‚Ä¢ Bull's total EBV = +800 kg (r¬≤ = 0.85)<br>
                                    ‚Ä¢ Sire PTA = +600 kg, Dam EBV = +400 kg<br>
                                    ‚Ä¢ Parent Average (PA) = (+600 + +400)/2 = +500 kg<br>
                                    <strong>Calculation:</strong><br>
                                    Using mixed model equations (complex - typically done by software):<br>
                                    EBV_no_parents ‚âà +720 kg, r¬≤_no_parents ‚âà 0.75
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <div class="step-title">Perform Deregression</div>
                            <div class="step-details">
                                Calculate the deregressed EBV
                                <div class="step-specs">
                                    <strong>Formula:</strong><br>
                                    Deregressed EBV = EBV_no_parents / r¬≤_no_parents<br>
                                    <strong>Calculation:</strong><br>
                                    Deregressed EBV = +720 / 0.75 = +960 kg<br>
                                    <strong>Interpretation:</strong><br>
                                    This represents the bull's "unshrunken" genetic merit excluding parent contributions
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <div class="step-title">Calculate Weight</div>
                            <div class="step-details">
                                Determine the appropriate weight for this deregressed value
                                <div class="step-specs">
                                    <strong>Parameters:</strong><br>
                                    ‚Ä¢ h¬≤ = 0.25 (milk yield heritability)<br>
                                    ‚Ä¢ r¬≤ = 0.75 (reliability excluding parents)<br>
                                    ‚Ä¢ c = 0.2 (assume 20% of genetic variance not captured by markers)<br>
                                    <strong>Calculation:</strong><br>
                                    w = (1 - 0.25) / [(0.2 + (1 - 0.75)/0.75) √ó 0.25]<br>
                                    w = 0.75 / [(0.2 + 0.333) √ó 0.25] = 0.75 / 0.133 = 5.64
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flow-step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <div class="step-title">Use in Genomic Analysis</div>
                            <div class="step-details">
                                Apply the deregressed value and weight in genomic prediction training
                                <div class="step-specs">
                                    <strong>Training Data Entry:</strong><br>
                                    ‚Ä¢ Phenotype: +960 kg (deregressed)<br>
                                    ‚Ä¢ Weight: 5.64<br>
                                    ‚Ä¢ Genotype: SNP markers for this bull<br>
                                    <strong>Model:</strong><br>
                                    Weighted regression of deregressed EBV on marker genotypes<br>
                                    <strong>Result:</strong> Unbiased marker effect estimates
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="results-box">
                    <div class="results-title">Final Training Data</div>
                    <div class="step-details">
                        <strong>Bull's Contribution to Training:</strong>
                        <ul>
                            <li><strong>Original EBV:</strong> +800 kg (would bias marker effects downward)</li>
                            <li><strong>Deregressed EBV:</strong> +960 kg (unbiased estimate)</li>
                            <li><strong>Weight:</strong> 5.64 (accounts for uncertainty and marker limitations)</li>
                            <li><strong>Effective Information:</strong> Equivalent to 5.64 identical records</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="section" id="section-impact">
                <div class="section-title">üåü Impact and Modern Applications</div>
                
                <div class="innovation-box">
                    <div class="innovation-title">üèÜ Revolutionary Impact on Genomic Selection</div>
                    <p>This paper provided the mathematical foundation for properly using EBV in genomic prediction. The deregression methodology became standard practice in all major livestock species and enabled the successful implementation of genomic selection worldwide. The weighting framework ensures optimal use of heterogeneous information sources.</p>
                </div>
                
                <div class="analysis-grid">
                    <div class="analysis-card theory-card">
                        <div class="analysis-title">Immediate Applications</div>
                        <div class="step-details">
                            <strong>Livestock Industries:</strong>
                            <ul>
                                <li><strong>Dairy:</strong> USDA-DHIA genomic evaluations adopted this methodology</li>
                                <li><strong>Beef:</strong> International genomic evaluations use these principles</li>
                                <li><strong>Swine:</strong> Commercial breeding companies implemented deregression</li>
                                <li><strong>Poultry:</strong> Adapted for complex breeding program structures</li>
                            </ul>
                            
                            <strong>Technical Standards:</strong>
                            <ul>
                                <li>Interbull (international dairy evaluations) guidelines</li>
                                <li>Software packages (DMU, BLUPF90, etc.) implementations</li>
                                <li>Quality control protocols for genomic evaluations</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="analysis-card detection-card">
                        <div class="analysis-title">Modern Extensions</div>
                        <div class="step-details">
                            <strong>Single-Step Genomic BLUP:</strong>
                            <ul>
                                <li>Combines pedigree and genomic relationships</li>
                                <li>Deregression principles adapted for unified analysis</li>
                                <li>Handles both genotyped and non-genotyped animals</li>
                            </ul>
                            
                            <strong>Multi-Trait Genomic Models:</strong>
                            <ul>
                                <li>Deregression for correlated traits</li>
                                <li>Weight matrices for multi-trait scenarios</li>
                                <li>Genetic correlation considerations</li>
                            </ul>
                            
                            <strong>Functional Genomics:</strong>
                            <ul>
                                <li>Incorporating gene expression data</li>
                                <li>Pathway-based genomic predictions</li>
                                <li>Multi-omics integration</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="analysis-card evolution-card">
                        <div class="analysis-title">Future Directions</div>
                        <div class="step-details">
                            <strong>Machine Learning Integration:</strong>
                            <ul>
                                <li>Deep learning models using deregressed phenotypes</li>
                                <li>Automated parameter estimation</li>
                                <li>Non-linear genomic predictions</li>
                            </ul>
                            
                            <strong>Population Genomics:</strong>
                            <ul>
                                <li>Multi-population genomic evaluations</li>
                                <li>Admixed population analysis</li>
                                <li>Conservation genomics applications</li>
                            </ul>
                            
                            <strong>Real-Time Genomics:</strong>
                            <ul>
                                <li>Continuous model updates</li>
                                <li>Dynamic weighting systems</li>
                                <li>Cloud-based genomic evaluations</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            </body></html>