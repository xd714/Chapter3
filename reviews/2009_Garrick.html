<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Literature Review - Garrick et al. 2009</title>
        <link rel="stylesheet" href="style.css">

<script>
(function() {
    'use strict';
    
    function initAutoTheme() {
        try {
            const filename = window.location.pathname.split('/').pop().replace('.html', '') || 'default';
            const pageTitle = document.title || '';
            
            function generateHash(str) {
                let hash = 5381;
                for (let i = 0; i < str.length; i++) {
                    hash = ((hash << 5) + hash) + str.charCodeAt(i);
                    hash = hash & hash;
                }
                return Math.abs(hash);
            }
            
            const hashValue = generateHash(filename + pageTitle);
            const themeNumber = (hashValue % 20) + 1;
            
            document.body.setAttribute('data-theme', 'auto-' + themeNumber);
            document.body.setAttribute('data-file', filename);
            
            // FIXED: Added backslash before d to make d{4}
            const year = filename.match(/\d{4}/)?.[0] || pageTitle.match(/\d{4}/)?.[0] || '';
            if (year) {
                document.body.setAttribute('data-year', year);
            }
            
            console.log('ðŸŽ¨ Theme:', 'auto-' + themeNumber, '| File:', filename);
            
        } catch (error) {
            console.warn('Theme initialization failed:', error);
            document.body.setAttribute('data-theme', 'auto-1');
        }
    }
    
    function initBackToTop() {
        try {
            let backToTopButton = document.getElementById('backToTop') || 
                                 document.querySelector('.back-to-top');
            
            if (!backToTopButton) {
                backToTopButton = document.createElement('div');
                backToTopButton.className = 'back-to-top';
                backToTopButton.id = 'backToTop';
                backToTopButton.setAttribute('aria-label', 'Back to top');
                backToTopButton.setAttribute('role', 'button');
                backToTopButton.setAttribute('tabindex', '0');
                document.body.appendChild(backToTopButton);
            }
            
            function toggleVisibility() {
                if (window.pageYOffset > 300) {
                    backToTopButton.classList.add('visible');
                } else {
                    backToTopButton.classList.remove('visible');
                }
            }
            
            function scrollToTop() {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            }
            
            window.addEventListener('scroll', toggleVisibility, { passive: true });
            backToTopButton.addEventListener('click', scrollToTop);
            
            backToTopButton.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    scrollToTop();
                }
            });
            
            toggleVisibility();
            
        } catch (error) {
            console.warn('Back to top initialization failed:', error);
        }
    }
    
    function init() {
        initAutoTheme();
        initBackToTop();
    }
    
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
    } else {
        init();
    }
})();
</script>
</head>
<body>
    <div class="container">
                        <!-- TOP LEFT NAVIGATION -->
        <div class="top-left-nav">
            <a href="../index.html">  Back to Index</a>
        </div>
        
        <div class="header">
            <h1>Deregressing Estimated Breeding Values and Weighting Information for Genomic Regression Analyses</h1>
            <p>Literature Review - Garrick, Taylor & Fernando (2009)</p>

        </div>
        
        <div class="citation-box">
            <strong>Citation:</strong> Garrick, D.J., Taylor, J.F., & Fernando, R.L. (2009). Deregressing estimated breeding values and weighting information for genomic regression analyses. Genetics Selection Evolution, 41:55.
            <br><br>
            <strong>Find Original Paper:</strong>
            <a href="https://scholar.google.com/scholar?q=%22Deregressing+estimated+breeding+values+and+weighting+information%22+Garrick+Taylor+Fernando" 
               target="_blank" 
               style="color: #3498db; text-decoration: none; font-weight: bold;">
                Google Scholar Search
            </a>
        </div>
        <div class="section" id="section-5">
            <div class="section-title">Overview & Problem Statement</div>
            
            <div class="problem-box">
                <strong>Core Problem:</strong> Genomic prediction training requires appropriate use of different information sources (phenotypes, EBV, progeny records), but researchers were inconsistent in how to handle and weight these diverse data types.
                
                <p><strong>Specific Issues:</strong></p>
                <ul>
                    <li>Should EBV be used directly or deregressed?</li>
                    <li>How to properly weight heterogeneous information sources?</li>
                    <li>EBV from BLUP have shrinkage properties that complicate genomic training</li>
                    <li>Different reliabilities among individuals create weighting challenges</li>
                </ul>
            </div>
        </div>
        <div class="section" id="section-4">
            <div class="section-title">Detailed Methodology Flow</div>
            
            <div class="flow-step">
            <div class="step-title">Step 1: Theoretical Foundation</div>
                <p>Establish ideal model for genomic prediction using true breeding values:</p>
                <div class="formula short"><div class="formula short">g = 1Î¼ + Ma + Îµ</div></div>
                <p>Where g = true genetic merit, M = marker incidence matrix, a = marker effects, Îµ = lack of fit</p>
            </div>
            
            <div class="flow-step">
            <div class="step-title">Step 2: Individual Phenotype Model</div>
                <p>Extend to realistic scenario with phenotypic observations:</p>
                <div class="formula short"><div class="formula short">y = Xb + g + e</div></div>
                <p>Derive appropriate weights for different information sources based on variance structure</p>
            </div>
            
            <div class="flow-step">
            <div class="step-title">Step 3: Repeated Records & Progeny Information</div>
                <p>Develop weights for:</p>
                <ul>
                    <li><strong>Repeated records:</strong> w = (1-hÂ²)/[chÂ² + ((1-hÂ²)(1-t))/nhÂ²]</li>
                    <li><strong>Half-sib progeny:</strong> w = (1-hÂ²)/[chÂ² + (4-hÂ²)/phÂ²]</li>
                    <li><strong>Full-sib progeny:</strong> w = (1-hÂ²)/[chÂ² + (2+2lÂ²hÂ² + (1-0.5hÂ²))/phÂ²]</li>
                </ul>
            </div>
            
            <div class="flow-step">
            <div class="step-title">Step 4: EBV Deregression Theory</div>
                <p>Address problems with using EBV directly:</p>
                <div class="problem-box">
                    <strong>Problem 1:</strong> EBV have reduced variance due to shrinkage<br>
                    <strong>Problem 2:</strong> Regression of EBV on genotype varies by reliability (rÂ²)
                </div>
                
                <div class="solution-box">
                    <strong>Solution:</strong> Deregress EBV by dividing by reliability<br>
                    <strong><div class="formula short">Deregressed EBV = EBV/rÂ²</div></strong>
                </div>
            </div>
            
            <div class="flow-step">
            <div class="step-title">Step 5: Parent Average Removal</div>
                <p>Remove parent average effects from EBV before deregression:</p>
                <ul>
                    <li>Calculate parent average: g_PA = (g_sire + g_dam)/2</li>
                    <li>Solve mixed model equations to extract individual information</li>
                    <li>Use iterative approach to backsolve for deregressed information</li>
                </ul>
            </div>
            
            <div class="flow-step">
            <div class="step-title">Step 6: Final Weighting Formula</div>
                <p>Weight for deregressed EBV:</p>
                <div class="formula short"><div class="formula medium">w = (1-hÂ²)/[c + (1-rÂ²)/rÂ²]hÂ²</div></div>
                <p>Where c = proportion of genetic variance not explained by markers</p>
            </div>
        </div>
        <div class="section" id="section-3">
            <div class="section-title">Key Results & Validation</div>
            
            <div class="table-container">
                <strong>Relative Weights for Different Information Sources (c = 0.5, hÂ² = 0.25)</strong>
                <table>
                    <tr>
                        <th>Information Source</th>
                        <th>Parameter</th>
                        <th>Weight</th>
                    </tr>
                    <tr>
                        <td>Single phenotype</td>
                        <td>n = 1</td>
                        <td>1.11</td>
                    </tr>
                    <tr>
                        <td>5 repeated records</td>
                        <td>n = 5</td>
                        <td>1.35</td>
                    </tr>
                    <tr>
                        <td>20 half-sib progeny</td>
                        <td>p = 20</td>
                        <td>2.40</td>
                    </tr>
                    <tr>
                        <td>Deregressed EBV</td>
                        <td>rÂ² = 0.5</td>
                        <td>2.00</td>
                    </tr>
                    <tr>
                        <td>Deregressed EBV</td>
                        <td>rÂ² = 0.9</td>
                        <td>4.91</td>
                    </tr>
                </table>
            </div>
            
            <p><strong>Worked Example:</strong> Bull with EBV = 15, rÂ² = 0.68, sire EBV = 10 (rÂ² = 0.97), dam EBV = 2 (rÂ² = 0.36)</p>
            <ul>
                <li>Parent average: (10 + 2)/2 = 6</li>
                <li>After removing PA effects: deregressed value = 25.6</li>
                <li>Reliability of PA-free information: rÂ²* = 0.63</li>
                <li>Weight = 2.76 (equivalent to 2.76 individual phenotypes)</li>
            </ul>
        </div>
        <div class="section" id="section-2">
            <div class="section-title">Why, How, What Analysis</div>
            
            <div class="analysis-grid">
            <div class="analysis-card why-card">
                    <div class="analysis-title">WHY - Problem & Motivation</div>
                    <div class="analysis-content">
                        <strong>Inconsistent Practices:</strong> Researchers used different approaches for genomic training data without theoretical justification.
                        
                        <ul>
                            <li>Some used EBV directly, others deregressed</li>
                            <li>Various weighting schemes (reliability, PEV, no weights)</li>
                            <li>Unclear how to combine different information types</li>
                            <li>BLUP shrinkage properties create bias in genomic training</li>
                        </ul>
                        
                        <strong>Need:</strong> Unified theoretical framework for properly using diverse information sources in genomic prediction.
                    </div>
                </div>
                
                <div class="analysis-card how-card">
            <div class="analysis-title">HOW - Methodology</div>
                    <div class="analysis-content">
                        <strong>Theoretical Approach:</strong> Start with ideal model and systematically extend to realistic scenarios.
                        
                        <ul>
                            <li><strong>Model Extension:</strong> From true BV â†’ phenotypes â†’ repeated records â†’ progeny â†’ EBV</li>
                            <li><strong>Variance Derivation:</strong> Calculate residual variances for each information type</li>
                            <li><strong>Weight Calculation:</strong> Weights = inverse of scaled residual variances</li>
                            <li><strong>Deregression:</strong> Remove shrinkage by dividing EBV by reliability</li>
                            <li><strong>PA Removal:</strong> Solve mixed model equations to extract individual information</li>
                        </ul>
                        
                        <strong>Key Innovation:</strong> Unified weighting formula accounting for marker explanatory power (parameter c).
                    </div>
                </div>
                
                <div class="analysis-card what-card">
            <div class="analysis-title">WHAT - Findings & Impact</div>
                    <div class="analysis-content">
                        <strong>Key Contributions:</strong>
                        
                        <ul>
                            <li><span class="highlight">Proper deregression formula:</span> EBV/rÂ² (not EBV/âˆšrÂ²)</li>
                            <li><span class="highlight">Correct weights:</span> Function of hÂ², rÂ², and c (marker explanatory power)</li>
                            <li><span class="highlight">Parent average removal:</span> Essential for avoiding bias</li>
                            <li><span class="highlight">Unified framework:</span> Handles all information types consistently</li>
                        </ul>
                        
                        <strong>Practical Impact:</strong>
                        <ul>
                            <li>Standardized approach for genomic training data preparation</li>
                            <li>Proper utilization of high-reliability animals vs. individual records</li>
                            <li>Framework scales with marker density and explanatory power</li>
                            <li>Enables optimal combination of heterogeneous information sources</li>
                        </ul>
                        
                        <strong>Legacy:</strong> Became standard practice in genomic evaluation systems worldwide.
                    </div>
                </div>
            </div>
        </div>
        <div class="section" id="section-1">
            <div class="section-title">Significance & Applications</div>
            
            <div class="flow-step">
            <div class="step-title">Theoretical Significance</div>
                <p>This paper provided the missing theoretical foundation for data preparation in genomic prediction. It resolved inconsistencies in the literature and established principles that remain relevant as genomic prediction evolves.</p>
            </div>
            
            <div class="flow-step">
            <div class="step-title">Practical Applications</div>
                <ul>
                    <li><strong>National Evaluations:</strong> Used in dairy and beef cattle genomic evaluations globally</li>
                    <li><strong>Research:</strong> Standard method for preparing training data in genomic studies</li>
                    <li><strong>Multi-trait Analysis:</strong> Framework extends to multiple correlated traits</li>
                    <li><strong>Cross-validation:</strong> Proper weighting improves prediction accuracy assessment</li>
                </ul>
            </div>
            
            <div class="flow-step">
            <div class="step-title">Contemporary Relevance</div>
                <p>While sequence data and machine learning methods have advanced, the fundamental principles of proper data weighting and deregression remain essential for:</p>
                <ul>
                    <li>Training modern genomic prediction models</li>
                    <li>Combining traditional and genomic information</li>
                    <li>Handling heterogeneous information sources</li>
                    <li>Ensuring unbiased parameter estimation</li>
                </ul>
            </div>
        </div>

    </div>
</body></html>
