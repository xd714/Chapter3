# DU6 Mouse Population Genetic Analysis Workflow Guide

## Overview

This comprehensive workflow guide replicates the methodology described in "Evaluating Genetic and Phenotypic Variation in the DU6 Mouse Line Following 150 Generations of Intensive Selection for Increased Body Weight" for analyzing genetic variance persistence in highly selected, inbred populations.

**Central Research Question:** How does additive genetic variance persist in the DU6 mouse population after 200+ generations of intense selection and extreme inbreeding (F > 0.85)?

---

## Study Design and Data Structure

### Population Characteristics
- **Origin:** FZTDU population from 4 inbred + 4 outbred mouse lines
- **Selection Period:** 200+ generations (since 1976)
- **Analysis Focus:** Generations 154-200 (SPF conditions post-2012)
- **Selection Target:** Male body weight at 42 days (BW42m)
- **Selection Method:** Family-based → BLUP + Optimal Contribution Selection

### Dataset Structure
- **Total Animals:** 16,539 (complete pedigree)
- **Phenotypic Records:** 16,318 observations
- **Genotyped Animals:** 552 (generations 189-191)
- **Genomic Platform:** Illumina GigaMUGA array
- **Quality-Controlled SNPs:** 12,384 (autosomal)

### Key Traits Analyzed
1. **BW42m** - Male body weight at 42 days
2. **BW42f** - Female body weight at 42 days  
3. **LS** - Litter size
4. **CR** - Conception rate (binomial)
5. **LW** - Litter weight at birth

---

## Phase 1: Data Preparation and Quality Control

### 1.1 Phenotypic Data Processing

**Data Validation Steps:**
- Apply biological limits (e.g., LS between 1-22 pups)
- Focus on SPF period only (generations 154-200)
- Verify data completeness across traits and generations

**Key Quality Checks:**
- Distribution normality assessment
- Generation-specific trait means and variances
- Missing data patterns analysis
- Environmental consistency validation

### 1.2 Pedigree Processing

**Pedigree Validation:**
- Verify parent-offspring relationships
- Calculate inbreeding coefficients for all animals
- Assess pedigree completeness by generation
- Identify founding animals and genetic bottlenecks

**Critical Metrics:**
- Average inbreeding coefficient (F ≈ 0.79 in recent generations, if count all mouse houses)
- Pedigree depth and completeness
- Number of effective founders
- Relationship matrix properties

### 1.3 Genomic Data Quality Control

**Individual-Level Filtering:**
- Call rate threshold: >80% (--mind 0.2)
- Remove individuals with excessive missing data
- Verify sample identity and relationships

**SNP-Level Filtering:**
- Call rate threshold: >90% (--geno 0.1)
- Minor allele frequency: >1% (relaxed for inbred populations)
- Autosomal chromosomes only (1-19)
- Hardy-Weinberg equilibrium (very relaxed due to inbreeding)

**Family-Based Quality Control:**
- Mendelian error detection and removal
- Parent-offspring trio validation
- Relationship verification using genomic data

**Final Dataset Characteristics:**
- 12,384 high-quality SNPs retained
- 466 individuals with complete genomic data
- Average call rate >95%
- Genomic relationship matrix construction ready

---

## Phase 2: Genetic Parameter Estimation

### 2.1 Multi-trait Animal Model Framework

**Model Structure:**
Three-trait multivariate animal model implemented in ASReml for simultaneous analysis of BW42m, BW42f, and LS.

**Fixed Effects:**
- Generation (systematic environmental effects)
- Maternal age at parturition (linear and quadratic terms)
- Maternal litter size (for body weight traits)
- Individual age at parturition (for litter size)

**Random Effects:**
- **Additive genetic effects:** Multivariate normal distribution with genetic covariance matrix G and relationship matrix A
- **Cage effects:** Pre-weaning environmental effects (body weight traits only)
- **Litter effects:** Post-weaning environmental effects (body weight traits only)
- **Residual effects:** Trait-specific error terms

**Variance Structure:**
- Genetic covariance matrix (G): 3×3 matrix for trait correlations
- Environmental covariance matrices: Trait-specific
- Residual covariance matrix: Diagonal (traits measured on different individuals)

### 2.2 Parameter Estimation Process

**Estimation Method:**
- Restricted Maximum Likelihood (REML) in ASReml 4.2
- Convergence criteria: Change in log-likelihood <0.002
- Multiple starting values to ensure global optimum
- Standard errors from average information matrix

**Derived Parameters:**
- **Heritabilities:** h² = σ²ₐ/(σ²ₐ + σ²ₑ + σ²c + σ²l)
- **Genetic correlations:** rG = σₐ₁ₐ₂/√(σ²ₐ₁ × σ²ₐ₂)
- **Environmental correlations:** Similar structure for non-genetic effects

### 2.3 Additional Trait Analysis

**Conception Rate (Binomial Trait):**
- Logistic mixed model with animal genetic effects
- Liability scale heritability calculation
- Threshold model implementation

**Litter Weight at Birth:**
- Separate sire and dam genetic effects
- Maternal genetic and environmental effects
- Fixed effects: generation, dam age, litter size

**Model Validation:**
- Residual analysis and normality checks
- Comparison of alternative model specifications
- Cross-validation for prediction accuracy assessment

---

## Phase 3: Deregressed Breeding Values Analysis

### 3.1 Standard Garrick Method (GTF)

**Traditional Approach Characteristics:**
- Assumes parents are unrelated and non-inbred
- Uses standard mixed model theory for reliability estimation
- Simple parent average correction
- Widely used benchmark method

**Reliability Calculation:**
- Based on prediction error variance from mixed model equations
- Assumes independence of parental information
- Does not account for complex relationship structures

**Deregression Process:**
- Extract estimated breeding values (EBVs) from multi-trait analysis
- Calculate parent averages for each individual
- Apply deregression formula to remove parent information
- Generate weights based on reliability estimates

### 3.2 Enhanced FBN Method

**Methodological Improvements:**
- Separates parent average and Mendelian sampling effects
- Uses actual prediction error variance from ASReml
- Accounts for parental relationships and inbreeding
- Provides more accurate reliability estimates

**Key Innovations:**
- **Parent Average PEV:** Calculated from actual relationship matrix
- **Mendelian Sampling PEV:** Derived as residual from total PEV
- **Refined Reliability:** Incorporates complex family structures
- **Enhanced Weights:** Based on improved reliability estimates

**Theoretical Foundation:**
- Recognizes that breeding values = parent average + Mendelian sampling
- Uses mixed model equations to properly separate these components
- Accounts for information flow through pedigree relationships
- Provides realistic accuracy estimates for genomic analysis

### 3.3 Method Comparison and Validation

**Performance Metrics:**
- **Reliability Estimates:** FBN method yields 2-fold higher reliabilities
- **Weight Values:** 5-fold increase in weights for body weight traits
- **Pseudo-phenotype Quality:** Improved accuracy for GWAS analysis
- **Theoretical Consistency:** Better alignment with quantitative genetics theory

**Quality Control:**
- Verify that deregressed values have higher variance than EBVs
- Check for reasonable reliability bounds (0 < r² < 1)
- Ensure unbiased deregression (mean dBV ≈ 0)
- Validate against theoretical expectations

---

## Phase 4: Genome-Wide Association Study (GWAS)

### 4.1 Population Structure Assessment

**Genomic Relationship Matrix:**
- Constructed using VanRaden Method 1
- Accounts for allele frequency differences
- Captures realized relationships vs. pedigree expectations

**Principal Component Analysis:**
- Assess population stratification patterns
- Identify family clustering effects
- Determine appropriate covariates for GWAS models

**Effective Population Size:**
- Estimate from linkage disequilibrium decay
- Calculate contemporary and historical effective sizes
- Assess genetic drift effects on association power

### 4.2 Association Testing Framework

**Linear Mixed Model:**
- Deregressed breeding values as pseudo-phenotypes
- Fixed effects: SNP genotype, principal components
- Random effects: polygenic effects with genomic relationship matrix
- Implementation in GCTA mlma module

**Model Specifications:**
- **Single-SNP Testing:** Each marker tested individually
- **Population Structure Control:** Principal components as covariates
- **Relationship Control:** Genomic relationship matrix in random effects
- **Weight Integration:** Use deregression weights in analysis

**Quality Control Measures:**
- Genomic inflation factor (λ) monitoring
- QQ plots for p-value distribution assessment
- Manhattan plots for genome-wide signal visualization
- Linkage disequilibrium pattern verification

### 4.3 Multiple Testing Correction

**Significance Thresholds:**
- **Effective Number of Tests:** Calculated using simpleM method
- **Bonferroni Correction:** Conservative genome-wide significance
- **False Discovery Rate:** Control for multiple discoveries
- **Permutation Testing:** Empirical significance thresholds

**Threshold Calculations:**
- Single SNP significance: P < 0.00014 (based on 356 effective tests)
- Chromosome-wide significance: Adjusted per chromosome
- Effect size significance: Minimum detectable effect thresholds

### 4.4 Results Interpretation

**Effect Size Assessment:**
- Convert SNP effects to phenotypic standard deviation units
- Calculate proportion of genetic variance explained
- Assess practical vs. statistical significance
- Compare effect sizes across traits

**Candidate Gene Analysis:**
- Map significant SNPs to nearby genes
- Extract gene information from MGI mouse database
- Functional annotation and pathway analysis
- Literature review for biological relevance

---

## Phase 5: Mendelian Sampling Variance Analysis

### 5.1 Within-Family Variance Assessment

**Theoretical Framework:**
Mendelian sampling variance represents the genetic variance available within families for continued selection, critical for understanding selection potential in highly inbred populations.

**Family-Based Calculations:**
- Identify full-sib families with ≥3 offspring
- Calculate variance of EBVs within each family
- Apply finite sample size corrections
- Weight families by size and reliability

**Population-Level Estimation:**
- Combine family estimates using appropriate weights
- Account for family size effects on variance estimates
- Correct for selection within families
- Compare to theoretical expectations

**Theoretical Expectations:**
- Expected MS variance = 0.5 × σ²ₐ × (1 - F̄parents)
- Where F̄parents = average inbreeding of parents
- Efficiency ratio = observed/expected MS variance

### 5.2 Selection Response Prediction

**Current Selection Parameters:**
- Selection intensity based on proportion selected (≈50%)
- Accuracy of selection from reliability estimates
- Generation interval and reproductive capacity
- Effective population size constraints

**Response Prediction:**
- Single generation response: ΔG = h² × i × σp
- Enhanced formula using MS variance: ΔG = √(σ²MS) × i × accuracy
- Long-term response considering finite population effects
- Selection limit estimation

**Sustainability Assessment:**
- Genetic drift effects on response
- Inbreeding accumulation rates
- Fertility trait correlations
- Population viability projections

---

## Phase 6: Bottleneck Analysis and Population Genomics

### 6.1 Demographic History Reconstruction

**Bottleneck Characterization:**
The 2012 facility transfer created a severe genetic bottleneck requiring detailed analysis to separate bottleneck effects from selection effects.

**Allele Frequency Analysis:**
- Compare pre-bottleneck vs. post-bottleneck allele frequencies
- Calculate mean frequency changes across all SNPs
- Identify loci with extreme frequency shifts
- Assess consistency with neutral drift expectations

**Genetic Diversity Metrics:**
- Heterozygosity changes over time
- Allelic richness across frequency spectrum
- Linkage disequilibrium patterns pre/post bottleneck
- Founder contribution analysis

### 6.2 Selection vs. Drift Attribution

**Statistical Framework:**
- Test observed frequency changes against neutral expectations
- Identify genomic regions showing selection signatures
- Quantify selection coefficients for trait-associated regions
- Partition variance into selection and drift components

**Genomic Signatures:**
- Extended haplotype homozygosity
- Fixation index (FST) between time periods
- Tajima's D and related neutrality tests
- Composite likelihood ratio tests

---

## Phase 7: Integration and Interpretation

### 7.1 Synthesis of Results

**Variance Persistence Mechanisms:**
- Quantify relative contributions of different sources
- Assess role of Mendelian sampling vs. new mutations
- Evaluate incomplete linkage effects
- Consider epistatic interactions

**Breeding Strategy Implications:**
- Optimal selection methods for current population structure
- Balance between genetic gain and diversity maintenance
- Family vs. individual selection effectiveness
- Genomic selection implementation potential

### 7.2 Model Validation and Robustness

**Cross-Validation:**
- Genomic prediction accuracy assessment
- Consistency across different data subsets
- Sensitivity to model assumptions
- Comparison with independent validation populations

**Uncertainty Quantification:**
- Confidence intervals for all parameter estimates
- Bootstrap resampling for robust inference
- Monte Carlo simulation for complex parameters
- Bayesian approaches for uncertainty propagation

---

## Expected Results and Success Metrics

### Key Findings (Based on Manuscript)

**Genetic Parameters:**
- Heritability estimates: BW42m (0.20 ± 0.03), BW42f (0.21 ± 0.03), LS (0.13 ± 0.04)
- Strong genetic correlation between male and female body weight (0.82 ± 0.089)
- Near-zero correlations between body weight and litter size
- Substantial environmental effects emphasizing management importance

**Methodological Improvements:**
- 2-fold increase in reliability estimates with FBN vs. GTF method
- Enhanced statistical power for genomic association detection
- Improved accuracy of genomic predictions
- Better theoretical consistency in highly inbred populations

**GWAS Discoveries:**
- Significant associations identified on chromosome 19
- Effect sizes and variance explained quantification
- Candidate gene identification and functional annotation
- Validation of associations using independent methods

**Variance Persistence:**
- Substantial genetic variance maintained despite extreme inbreeding
- Mendelian sampling variance as primary source of remaining variation
- Efficiency ratios comparing observed vs. theoretical expectations
- Selection response potential under current breeding strategies

### Implications for Breeding Programs

**Scientific Contributions:**
- Challenges classical quantitative genetics predictions
- Demonstrates variance persistence mechanisms
- Provides enhanced analytical methods for structured populations
- Validates long-term selection sustainability

**Practical Applications:**
- Optimized breeding strategies for closed populations
- Enhanced genomic evaluation methods
- Conservation breeding program guidelines
- Sustainable genetic improvement frameworks

This comprehensive workflow provides the complete analytical framework for investigating genetic variance persistence in highly selected, inbred populations using the DU6 mouse model as described in the JAS manuscript.